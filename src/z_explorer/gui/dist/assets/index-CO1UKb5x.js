const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/event-DUeWsK_d.js","assets/core-CKq3Z5BB.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const Zl="modulepreload",Jl=function(l){return"/"+l},ft={},Ie=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");s=Promise.allSettled(t.map(u=>{if(u=Jl(u),u in ft)return;ft[u]=!0;const m=u.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${v}`))return;const d=document.createElement("link");if(d.rel=m?"stylesheet":Zl,m||(d.as="script"),d.crossOrigin="",d.href=u,c&&d.setAttribute("nonce",c),document.head.appendChild(d),m)return new Promise((h,g)=>{d.addEventListener("load",h),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return s.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function K(){}function Al(l){return l()}function dt(){return Object.create(null)}function ke(l){l.forEach(Al)}function et(l){return typeof l=="function"}function Fe(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let Ke;function ye(l,e){return l===e?!0:(Ke||(Ke=document.createElement("a")),Ke.href=e,l===Ke.href)}function Ql(l){return Object.keys(l).length===0}function Ll(l,...e){if(l==null){for(const n of e)n(void 0);return K}const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ae(l,e,t){l.$$.on_destroy.push(Ll(e,t))}function r(l,e){l.appendChild(e)}function A(l,e,t){l.insertBefore(e,t||null)}function j(l){l.parentNode&&l.parentNode.removeChild(l)}function he(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function f(l){return document.createElement(l)}function O(l){return document.createTextNode(l)}function _(){return O(" ")}function tt(){return O("")}function U(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function Tl(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function a(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Ue(l){return l===""?null:+l}function Kl(l){return Array.from(l.childNodes)}function X(l,e){e=""+e,l.data!==e&&(l.data=e)}function pe(l,e){l.value=e??""}function ie(l,e,t,n){t==null?l.style.removeProperty(e):l.style.setProperty(e,t,"")}function Ne(l,e,t){for(let n=0;n<l.options.length;n+=1){const s=l.options[n];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(l.selectedIndex=-1)}function lt(l){const e=l.querySelector(":checked");return e&&e.__value}function ce(l,e,t){l.classList.toggle(e,!!t)}function Yl(l,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(l,{detail:e,bubbles:t,cancelable:n})}let Je;function Ze(l){Je=l}function ot(){if(!Je)throw new Error("Function called outside component initialization");return Je}function it(l){ot().$$.on_mount.push(l)}function Ml(l){ot().$$.on_destroy.push(l)}function rt(){const l=ot();return(e,t,{cancelable:n=!1}={})=>{const s=l.$$.callbacks[e];if(s){const o=Yl(e,t,{cancelable:n});return s.slice().forEach(i=>{i.call(l,o)}),!o.defaultPrevented}return!0}}function Il(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const Be=[],Qe=[];let Ve=[];const pt=[],Xl=Promise.resolve();let st=!1;function xl(){st||(st=!0,Xl.then(Pl))}function We(l){Ve.push(l)}const nt=new Set;let De=0;function Pl(){if(De!==0)return;const l=Je;do{try{for(;De<Be.length;){const e=Be[De];De++,Ze(e),$l(e.$$)}}catch(e){throw Be.length=0,De=0,e}for(Ze(null),Be.length=0,De=0;Qe.length;)Qe.pop()();for(let e=0;e<Ve.length;e+=1){const t=Ve[e];nt.has(t)||(nt.add(t),t())}Ve.length=0}while(Be.length);for(;pt.length;)pt.pop()();st=!1,nt.clear(),Ze(l)}function $l(l){if(l.fragment!==null){l.update(),ke(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(We)}}function en(l){const e=[],t=[];Ve.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Ve=e}const $e=new Set;let He;function at(){He={r:0,c:[],p:He}}function ct(){He.r||ke(He.c),He=He.p}function ve(l,e){l&&l.i&&($e.delete(l),l.i(e))}function be(l,e,t,n){if(l&&l.o){if($e.has(l))return;$e.add(l),He.c.push(()=>{$e.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function ne(l){return l?.length!==void 0?l:Array.from(l)}function je(l){l&&l.c()}function Ce(l,e,t){const{fragment:n,after_update:s}=l.$$;n&&n.m(e,t),We(()=>{const o=l.$$.on_mount.map(Al).filter(et);l.$$.on_destroy?l.$$.on_destroy.push(...o):ke(o),l.$$.on_mount=[]}),s.forEach(We)}function Se(l,e){const t=l.$$;t.fragment!==null&&(en(t.after_update),ke(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function tn(l,e){l.$$.dirty[0]===-1&&(Be.push(l),xl(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function Le(l,e,t,n,s,o,i=null,c=[-1]){const u=Je;Ze(l);const m=l.$$={fragment:null,ctx:[],props:o,update:K,not_equal:s,bound:dt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:dt(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};i&&i(m.root);let v=!1;if(m.ctx=t?t(l,e.props||{},(d,h,...g)=>{const p=g.length?g[0]:h;return m.ctx&&s(m.ctx[d],m.ctx[d]=p)&&(!m.skip_bound&&m.bound[d]&&m.bound[d](p),v&&tn(l,d)),h}):[],m.update(),v=!0,ke(m.before_update),m.fragment=n?n(m.ctx):!1,e.target){if(e.hydrate){const d=Kl(e.target);m.fragment&&m.fragment.l(d),d.forEach(j)}else m.fragment&&m.fragment.c();e.intro&&ve(l.$$.fragment),Ce(l,e.target,e.anchor),Pl()}Ze(u)}class Te{$$=void 0;$$set=void 0;$destroy(){Se(this,1),this.$destroy=K}$on(e,t){if(!et(t))return K;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!Ql(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ln="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ln);const ze=[];function nn(l,e){return{subscribe:Gl(l,e).subscribe}}function Gl(l,e=K){let t;const n=new Set;function s(c){if(Fe(l,c)&&(l=c,t)){const u=!ze.length;for(const m of n)m[1](),ze.push(m,l);if(u){for(let m=0;m<ze.length;m+=2)ze[m][0](ze[m+1]);ze.length=0}}}function o(c){s(c(l))}function i(c,u=K){const m=[c,u];return n.add(m),n.size===1&&(t=e(s,o)||K),c(l),()=>{n.delete(m),n.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:i}}function sn(l,e,t){const n=!Array.isArray(l),s=n?[l]:l;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return nn(t,(i,c)=>{let u=!1;const m=[];let v=0,d=K;const h=()=>{if(v)return;d();const p=e(n?m[0]:m,i,c);o?i(p):d=et(p)?p:K},g=s.map((p,k)=>Ll(p,w=>{m[k]=w,v&=~(1<<k),u&&h()},()=>{v|=1<<k}));return u=!0,h(),function(){ke(g),d(),u=!1}})}const Hl="z-explorer-settings",Oe={gallery:{layout:"flex-row",thumbnailSize:"medium",thumbnailHeight:180,showPromptOnHover:!0,sortOrder:"newest"},cli:{height:420,showTipsOnStart:!0,showTutorialOnStart:!0,fontSize:"medium"},generation:{defaultWidth:1024,defaultHeight:1024,defaultCount:1,autoEnhance:!1},models:{imageMode:null,imageRepo:null,imagePath:null,llmMode:null,llmRepo:null,llmPath:null}};function on(l,e){if(!e||typeof e!="object")return l;const t=e,n={...l};return t.gallery&&typeof t.gallery=="object"&&(n.gallery={...l.gallery,...t.gallery}),t.cli&&typeof t.cli=="object"&&(n.cli={...l.cli,...t.cli}),t.generation&&typeof t.generation=="object"&&(n.generation={...l.generation,...t.generation}),t.models&&typeof t.models=="object"&&(n.models={...l.models,...t.models}),n}function rn(){try{const l=localStorage.getItem(Hl);if(!l)return Oe;const e=JSON.parse(l);return on(Oe,e)}catch(l){return console.warn("Failed to load settings, using defaults:",l),Oe}}function Ol(l){try{return localStorage.setItem(Hl,JSON.stringify(l)),!0}catch(e){return console.error("Failed to save settings:",e),!1}}function Rl(l){return typeof l=="number"&&isFinite(l)&&l>=80&&l<=500}function an(l,e){switch(l){case"small":return 120;case"medium":return 180;case"large":return 250;case"xlarge":return 350;case"custom":return Rl(e)?e:180;default:return 180}}let qe;function Dl(){const l=rn();qe?qe.set(l):qe=Gl(l)}Dl();const Me={subscribe:(l,e)=>qe.subscribe(l,e)},cn=sn(Me,l=>an(l.gallery.thumbnailSize,l.gallery.thumbnailHeight));function ut(l){qe.update(e=>{const t=l(e);return Ol(t),t})}function un(l){ut(e=>({...e,gallery:{...e.gallery,...l}}))}function zl(l){ut(e=>({...e,cli:{...e.cli,...l}}))}function fn(l){ut(e=>({...e,generation:{...e.generation,...l}}))}function dn(){qe.set(Oe),Ol(Oe)}function mt(l,e,t){const n=l.slice();return n[10]=e[t],n[12]=t,n}function pn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-1tf9jje")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function mn(l){let e,t,n=l[10].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=O(n),a(t,"class","svelte-1tf9jje"),a(e,"class","prompt-preview svelte-1tf9jje")},m(o,i){A(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[10].prompt+"")&&X(s,n)},d(o){o&&j(e)}}}function gt(l){let e,t,n,s,o,i,c,u;function m(...p){return l[6](l[10],...p)}function v(p,k){return p[3].gallery.showPromptOnHover&&p[10].prompt?mn:pn}let d=v(l),h=d(l);function g(){return l[7](l[10])}return{c(){e=f("button"),t=f("img"),s=_(),o=f("div"),h.c(),i=_(),ye(t.src,n=l[10].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[12]+1)),a(t,"loading","lazy"),a(t,"class","svelte-1tf9jje"),a(o,"class","image-overlay svelte-1tf9jje"),a(e,"class","image-card svelte-1tf9jje"),ie(e,"animation-delay",l[12]*50+"ms"),ie(e,"flex-grow",l[5](l[10]))},m(p,k){A(p,e,k),r(e,t),r(e,s),r(e,o),h.m(o,null),r(e,i),c||(u=[U(t,"load",m),U(e,"click",g)],c=!0)},p(p,k){l=p,k&1&&!ye(t.src,n=l[10].url)&&a(t,"src",n),d===(d=v(l))&&h?h.p(l,k):(h.d(1),h=d(l),h&&(h.c(),h.m(o,null))),k&1&&ie(e,"flex-grow",l[5](l[10]))},d(p){p&&j(e),h.d(),c=!1,ke(u)}}}function gn(l){let e,t=ne(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=gt(mt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","flex-row svelte-1tf9jje"),ie(e,"--thumb-height",l[2]+"px")},m(s,o){A(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&59){t=ne(s[0]);let i;for(i=0;i<t.length;i+=1){const c=mt(s,t,i);n[i]?n[i].p(c,o):(n[i]=gt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&ie(e,"--thumb-height",s[2]+"px")},i:K,o:K,d(s){s&&j(e),he(n,s)}}}function hn(l,e,t){let n;Ae(l,Me,g=>t(3,n=g));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e,c=new Map;function u(g,p){const k=g.target;if(k.naturalWidth&&k.naturalHeight){const w=k.naturalWidth/k.naturalHeight;c.set(p.url,w),c=c}}function m(g){return c.get(g.url)||1}function v(g){const p=m(g);return Math.max(.5,Math.min(2,p))}const d=(g,p)=>u(p,g),h=g=>o(g);return l.$$set=g=>{"images"in g&&t(0,s=g.images),"onSelect"in g&&t(1,o=g.onSelect),"thumbnailHeight"in g&&t(2,i=g.thumbnailHeight)},[s,o,i,n,u,v,d,h]}class Bl extends Te{constructor(e){super(),Le(this,e,hn,gn,Fe,{images:0,onSelect:1,thumbnailHeight:2})}}function ht(l,e,t){const n=l.slice();return n[4]=e[t],n[6]=t,n}function vn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-1cd54o6")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function _n(l){let e,t,n=l[4].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=O(n),a(t,"class","svelte-1cd54o6"),a(e,"class","prompt-preview svelte-1cd54o6")},m(o,i){A(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[4].prompt+"")&&X(s,n)},d(o){o&&j(e)}}}function vt(l){let e,t,n,s,o,i,c,u;function m(g,p){return g[2].gallery.showPromptOnHover&&g[4].prompt?_n:vn}let v=m(l),d=v(l);function h(){return l[3](l[4])}return{c(){e=f("button"),t=f("img"),s=_(),o=f("div"),d.c(),i=_(),ye(t.src,n=l[4].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[6]+1)),a(t,"loading","lazy"),a(t,"class","svelte-1cd54o6"),a(o,"class","image-overlay svelte-1cd54o6"),a(e,"class","image-card svelte-1cd54o6"),ie(e,"animation-delay",l[6]*50+"ms")},m(g,p){A(g,e,p),r(e,t),r(e,s),r(e,o),d.m(o,null),r(e,i),c||(u=U(e,"click",h),c=!0)},p(g,p){l=g,p&1&&!ye(t.src,n=l[4].url)&&a(t,"src",n),v===(v=m(l))&&d?d.p(l,p):(d.d(1),d=v(l),d&&(d.c(),d.m(o,null)))},d(g){g&&j(e),d.d(),c=!1,u()}}}function bn(l){let e,t=ne(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=vt(ht(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","masonry-vertical svelte-1cd54o6")},m(s,o){A(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&7){t=ne(s[0]);let i;for(i=0;i<t.length;i+=1){const c=ht(s,t,i);n[i]?n[i].p(c,o):(n[i]=vt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},i:K,o:K,d(s){s&&j(e),he(n,s)}}}function kn(l,e,t){let n;Ae(l,Me,c=>t(2,n=c));let{images:s=[]}=e,{onSelect:o}=e;const i=c=>o(c);return l.$$set=c=>{"images"in c&&t(0,s=c.images),"onSelect"in c&&t(1,o=c.onSelect)},[s,o,n,i]}class wn extends Te{constructor(e){super(),Le(this,e,kn,bn,Fe,{images:0,onSelect:1})}}function _t(l,e,t){const n=l.slice();return n[9]=e[t],n[11]=t,n}function yn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-177e03b")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function Cn(l){let e,t,n=l[9].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=O(n),a(t,"class","svelte-177e03b"),a(e,"class","prompt-preview svelte-177e03b")},m(o,i){A(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[9].prompt+"")&&X(s,n)},d(o){o&&j(e)}}}function bt(l){let e,t,n,s,o,i,c,u;function m(...p){return l[6](l[9],...p)}function v(p,k){return p[3].gallery.showPromptOnHover&&p[9].prompt?Cn:yn}let d=v(l),h=d(l);function g(){return l[7](l[9])}return{c(){e=f("button"),t=f("img"),s=_(),o=f("div"),h.c(),i=_(),ye(t.src,n=l[9].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[11]+1)),a(t,"loading","lazy"),a(t,"class","svelte-177e03b"),a(o,"class","image-overlay svelte-177e03b"),a(e,"class","image-card svelte-177e03b"),ie(e,"animation-delay",l[11]*50+"ms"),ie(e,"width",l[5](l[9])+"px")},m(p,k){A(p,e,k),r(e,t),r(e,s),r(e,o),h.m(o,null),r(e,i),c||(u=[U(t,"load",m),U(e,"click",g)],c=!0)},p(p,k){l=p,k&1&&!ye(t.src,n=l[9].url)&&a(t,"src",n),d===(d=v(l))&&h?h.p(l,k):(h.d(1),h=d(l),h&&(h.c(),h.m(o,null))),k&1&&ie(e,"width",l[5](l[9])+"px")},d(p){p&&j(e),h.d(),c=!1,ke(u)}}}function Sn(l){let e,t=ne(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=bt(_t(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","masonry-horizontal svelte-177e03b"),ie(e,"--thumb-height",l[2]+"px")},m(s,o){A(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&59){t=ne(s[0]);let i;for(i=0;i<t.length;i+=1){const c=_t(s,t,i);n[i]?n[i].p(c,o):(n[i]=bt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&ie(e,"--thumb-height",s[2]+"px")},i:K,o:K,d(s){s&&j(e),he(n,s)}}}function Fn(l,e,t){let n;Ae(l,Me,h=>t(3,n=h));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e,c=new Map;function u(h,g){const p=h.target;if(p.naturalWidth&&p.naturalHeight){const k=p.naturalWidth/p.naturalHeight;c.set(g.url,k),c=c}}function m(h){const g=c.get(h.url)||1;return Math.round(i*g)}const v=(h,g)=>u(g,h),d=h=>o(h);return l.$$set=h=>{"images"in h&&t(0,s=h.images),"onSelect"in h&&t(1,o=h.onSelect),"thumbnailHeight"in h&&t(2,i=h.thumbnailHeight)},[s,o,i,n,u,m,v,d]}class En extends Te{constructor(e){super(),Le(this,e,Fn,Sn,Fe,{images:0,onSelect:1,thumbnailHeight:2})}}function kt(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function jn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-1oj0pf3")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function An(l){let e,t,n=l[5].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=O(n),a(t,"class","svelte-1oj0pf3"),a(e,"class","prompt-preview svelte-1oj0pf3")},m(o,i){A(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[5].prompt+"")&&X(s,n)},d(o){o&&j(e)}}}function wt(l){let e,t,n,s,o,i,c,u;function m(g,p){return g[3].gallery.showPromptOnHover&&g[5].prompt?An:jn}let v=m(l),d=v(l);function h(){return l[4](l[5])}return{c(){e=f("button"),t=f("img"),s=_(),o=f("div"),d.c(),i=_(),ye(t.src,n=l[5].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[7]+1)),a(t,"loading","lazy"),a(t,"class","svelte-1oj0pf3"),a(o,"class","image-overlay svelte-1oj0pf3"),a(e,"class","image-card svelte-1oj0pf3"),ie(e,"animation-delay",l[7]*50+"ms")},m(g,p){A(g,e,p),r(e,t),r(e,s),r(e,o),d.m(o,null),r(e,i),c||(u=U(e,"click",h),c=!0)},p(g,p){l=g,p&1&&!ye(t.src,n=l[5].url)&&a(t,"src",n),v===(v=m(l))&&d?d.p(l,p):(d.d(1),d=v(l),d&&(d.c(),d.m(o,null)))},d(g){g&&j(e),d.d(),c=!1,u()}}}function Ln(l){let e,t=ne(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=wt(kt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","grid-square svelte-1oj0pf3"),ie(e,"--thumb-height",l[2]+"px")},m(s,o){A(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&11){t=ne(s[0]);let i;for(i=0;i<t.length;i+=1){const c=kt(s,t,i);n[i]?n[i].p(c,o):(n[i]=wt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&ie(e,"--thumb-height",s[2]+"px")},i:K,o:K,d(s){s&&j(e),he(n,s)}}}function Tn(l,e,t){let n;Ae(l,Me,u=>t(3,n=u));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e;const c=u=>o(u);return l.$$set=u=>{"images"in u&&t(0,s=u.images),"onSelect"in u&&t(1,o=u.onSelect),"thumbnailHeight"in u&&t(2,i=u.thumbnailHeight)},[s,o,i,n,c]}class Mn extends Te{constructor(e){super(),Le(this,e,Tn,Ln,Fe,{images:0,onSelect:1,thumbnailHeight:2})}}function yt(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function In(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-6g0nko")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function Pn(l){let e,t,n=l[5].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=O(n),a(t,"class","svelte-6g0nko"),a(e,"class","prompt-preview svelte-6g0nko")},m(o,i){A(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[5].prompt+"")&&X(s,n)},d(o){o&&j(e)}}}function Ct(l){let e,t,n,s,o,i,c,u;function m(g,p){return g[3].gallery.showPromptOnHover&&g[5].prompt?Pn:In}let v=m(l),d=v(l);function h(){return l[4](l[5])}return{c(){e=f("button"),t=f("img"),s=_(),o=f("div"),d.c(),i=_(),ye(t.src,n=l[5].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[7]+1)),a(t,"loading","lazy"),a(t,"class","svelte-6g0nko"),a(o,"class","image-overlay svelte-6g0nko"),a(e,"class","image-card svelte-6g0nko"),ie(e,"animation-delay",l[7]*50+"ms")},m(g,p){A(g,e,p),r(e,t),r(e,s),r(e,o),d.m(o,null),r(e,i),c||(u=U(e,"click",h),c=!0)},p(g,p){l=g,p&1&&!ye(t.src,n=l[5].url)&&a(t,"src",n),v===(v=m(l))&&d?d.p(l,p):(d.d(1),d=v(l),d&&(d.c(),d.m(o,null)))},d(g){g&&j(e),d.d(),c=!1,u()}}}function Gn(l){let e,t=ne(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ct(yt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","grid-auto svelte-6g0nko"),ie(e,"--thumb-height",l[2]+"px")},m(s,o){A(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&11){t=ne(s[0]);let i;for(i=0;i<t.length;i+=1){const c=yt(s,t,i);n[i]?n[i].p(c,o):(n[i]=Ct(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&ie(e,"--thumb-height",s[2]+"px")},i:K,o:K,d(s){s&&j(e),he(n,s)}}}function Hn(l,e,t){let n;Ae(l,Me,u=>t(3,n=u));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e;const c=u=>o(u);return l.$$set=u=>{"images"in u&&t(0,s=u.images),"onSelect"in u&&t(1,o=u.onSelect),"thumbnailHeight"in u&&t(2,i=u.thumbnailHeight)},[s,o,i,n,c]}class On extends Te{constructor(e){super(),Le(this,e,Hn,Gn,Fe,{images:0,onSelect:1,thumbnailHeight:2})}}function St(l){let e;return{c(){e=f("div"),e.innerHTML=`<span class="pulse svelte-u8rtp8"></span>
          Generating...`,a(e,"class","generating-badge svelte-u8rtp8")},m(t,n){A(t,e,n)},d(t){t&&j(e)}}}function Ft(l){let e,t,n,s,o,i=l[2]>0&&Et(l);return{c(){e=f("div"),t=f("div"),n=_(),s=f("span"),s.textContent="Creating magic...",o=_(),i&&i.c(),a(t,"class","spinner svelte-u8rtp8"),a(e,"class","generating-banner svelte-u8rtp8")},m(c,u){A(c,e,u),r(e,t),r(e,n),r(e,s),r(e,o),i&&i.m(e,null)},p(c,u){c[2]>0?i?i.p(c,u):(i=Et(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(c){c&&j(e),i&&i.d()}}}function Et(l){let e,t;return{c(){e=f("div"),t=f("div"),a(t,"class","progress-fill svelte-u8rtp8"),ie(t,"width",l[2]+"%"),a(e,"class","progress-bar svelte-u8rtp8")},m(n,s){A(n,e,s),r(e,t)},p(n,s){s&4&&ie(t,"width",n[2]+"%")},d(n){n&&j(e)}}}function Rn(l){let e,t,n,s;const o=[qn,Vn,Un,Nn,Bn,zn],i=[];function c(u,m){return u[3].gallery.layout==="flex-row"?0:u[3].gallery.layout==="masonry-vertical"?1:u[3].gallery.layout==="masonry-horizontal"?2:u[3].gallery.layout==="grid-square"?3:u[3].gallery.layout==="grid-auto"?4:5}return t=c(l),n=i[t]=o[t](l),{c(){e=f("div"),n.c(),a(e,"class","gallery-grid svelte-u8rtp8")},m(u,m){A(u,e,m),i[t].m(e,null),s=!0},p(u,m){let v=t;t=c(u),t===v?i[t].p(u,m):(at(),be(i[v],1,1,()=>{i[v]=null}),ct(),n=i[t],n?n.p(u,m):(n=i[t]=o[t](u),n.c()),ve(n,1),n.m(e,null))},i(u){s||(ve(n),s=!0)},o(u){be(n),s=!1},d(u){u&&j(e),i[t].d()}}}function Dn(l){let e;return{c(){e=f("div"),e.innerHTML='<span class="empty-icon svelte-u8rtp8">‚ú®</span> <h3 class="svelte-u8rtp8">No images yet</h3> <p class="svelte-u8rtp8">Start generating with the CLI below</p>',a(e,"class","empty-state svelte-u8rtp8")},m(t,n){A(t,e,n)},p:K,i:K,o:K,d(t){t&&j(e)}}}function zn(l){let e,t;return e=new Bl({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){je(e.$$.fragment)},m(n,s){Ce(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(ve(e.$$.fragment,n),t=!0)},o(n){be(e.$$.fragment,n),t=!1},d(n){Se(e,n)}}}function Bn(l){let e,t;return e=new On({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){je(e.$$.fragment)},m(n,s){Ce(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(ve(e.$$.fragment,n),t=!0)},o(n){be(e.$$.fragment,n),t=!1},d(n){Se(e,n)}}}function Nn(l){let e,t;return e=new Mn({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){je(e.$$.fragment)},m(n,s){Ce(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(ve(e.$$.fragment,n),t=!0)},o(n){be(e.$$.fragment,n),t=!1},d(n){Se(e,n)}}}function Un(l){let e,t;return e=new En({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){je(e.$$.fragment)},m(n,s){Ce(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(ve(e.$$.fragment,n),t=!0)},o(n){be(e.$$.fragment,n),t=!1},d(n){Se(e,n)}}}function Vn(l){let e,t;return e=new wn({props:{images:l[0],onSelect:l[5]}}),{c(){je(e.$$.fragment)},m(n,s){Ce(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),e.$set(o)},i(n){t||(ve(e.$$.fragment,n),t=!0)},o(n){be(e.$$.fragment,n),t=!1},d(n){Se(e,n)}}}function qn(l){let e,t;return e=new Bl({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){je(e.$$.fragment)},m(n,s){Ce(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(ve(e.$$.fragment,n),t=!0)},o(n){be(e.$$.fragment,n),t=!1},d(n){Se(e,n)}}}function Wn(l){let e,t,n,s,o,i,c,u,m,v,d=l[0].length+"",h,g,p,k,w,C,M,b,y,G,F,z,I=l[1]&&St(),H=l[1]&&Ft(l);const D=[Dn,Rn],B=[];function R(L,Q){return L[0].length===0&&!L[1]?0:L[0].length>0?1:-1}return~(b=R(l))&&(y=B[b]=D[b](l)),{c(){e=f("div"),t=f("div"),n=f("div"),n.innerHTML='<img src="/assets/icon.jpg" alt="Z" class="brand-icon svelte-u8rtp8"/> <span class="brand-name svelte-u8rtp8">Z-Explorer</span>',s=_(),o=f("div"),I&&I.c(),i=_(),c=f("h2"),u=O(`Gallery
        `),m=f("span"),v=O("("),h=O(d),g=O(")"),p=_(),k=f("button"),k.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>',w=_(),C=f("div"),H&&H.c(),M=_(),y&&y.c(),a(n,"class","brand svelte-u8rtp8"),a(m,"class","count svelte-u8rtp8"),a(c,"class","svelte-u8rtp8"),a(k,"class","settings-btn svelte-u8rtp8"),a(k,"title","Settings"),a(o,"class","header-right svelte-u8rtp8"),a(t,"class","gallery-header svelte-u8rtp8"),a(C,"class","gallery-content svelte-u8rtp8"),a(e,"class","gallery svelte-u8rtp8")},m(L,Q){A(L,e,Q),r(e,t),r(t,n),r(t,s),r(t,o),I&&I.m(o,null),r(o,i),r(o,c),r(c,u),r(c,m),r(m,v),r(m,h),r(m,g),r(o,p),r(o,k),r(e,w),r(e,C),H&&H.m(C,null),r(C,M),~b&&B[b].m(C,null),G=!0,F||(z=U(k,"click",l[6]),F=!0)},p(L,[Q]){L[1]?I||(I=St(),I.c(),I.m(o,i)):I&&(I.d(1),I=null),(!G||Q&1)&&d!==(d=L[0].length+"")&&X(h,d),L[1]?H?H.p(L,Q):(H=Ft(L),H.c(),H.m(C,M)):H&&(H.d(1),H=null);let P=b;b=R(L),b===P?~b&&B[b].p(L,Q):(y&&(at(),be(B[P],1,1,()=>{B[P]=null}),ct()),~b?(y=B[b],y?y.p(L,Q):(y=B[b]=D[b](L),y.c()),ve(y,1),y.m(C,null)):y=null)},i(L){G||(ve(y),G=!0)},o(L){be(y),G=!1},d(L){L&&j(e),I&&I.d(),H&&H.d(),~b&&B[b].d(),F=!1,z()}}}function Zn(l,e,t){let n,s;Ae(l,Me,h=>t(3,n=h)),Ae(l,cn,h=>t(4,s=h));let{images:o=[]}=e,{isGenerating:i=!1}=e,{progress:c=0}=e,{onOpenSettings:u=null}=e;const m=rt();function v(h){m("select",h)}function d(){u&&u()}return l.$$set=h=>{"images"in h&&t(0,o=h.images),"isGenerating"in h&&t(1,i=h.isGenerating),"progress"in h&&t(2,c=h.progress),"onOpenSettings"in h&&t(7,u=h.onOpenSettings)},[o,i,c,n,s,v,d,u]}class Jn extends Te{constructor(e){super(),Le(this,e,Zn,Wn,Fe,{images:0,isGenerating:1,progress:2,onOpenSettings:7})}}function jt(l,e,t){const n=l.slice();return n[51]=e[t],n[53]=t,n}function At(l,e,t){const n=l.slice();return n[54]=e[t],n[53]=t,n}function Lt(l,e,t){const n=l.slice();return n[56]=e[t],n}function Tt(l,e,t){const n=l.slice();return n[56]=e[t],n}function Mt(l,e,t){const n=l.slice();return n[61]=e[t],n}function It(l){let e,t,n,s=l[11]?"‚ñº":"‚ñ∂",o,i,c,u,m,v,d=l[11]&&Pt();return{c(){e=f("div"),t=f("button"),n=f("span"),o=O(s),i=_(),c=f("span"),c.textContent="üìö Tutorial:",u=_(),d&&d.c(),a(n,"class","toggle-icon svelte-14vph7t"),a(c,"class","tutorial-label svelte-14vph7t"),a(t,"class","tutorial-toggle svelte-14vph7t"),a(t,"data-testid","tutorial-toggle"),a(t,"aria-expanded",l[11]),a(e,"class","tutorial-section svelte-14vph7t")},m(h,g){A(h,e,g),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(e,u),d&&d.m(e,null),m||(v=U(t,"click",l[15]),m=!0)},p(h,g){g[0]&2048&&s!==(s=h[11]?"‚ñº":"‚ñ∂")&&X(o,s),g[0]&2048&&a(t,"aria-expanded",h[11]),h[11]?d?d.p(h,g):(d=Pt(),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},d(h){h&&j(e),d&&d.d(),m=!1,v()}}}function Pt(l){let e,t;return{c(){e=f("div"),t=f("div"),t.textContent=`${os}`,a(t,"class","line dim svelte-14vph7t"),a(e,"class","tutorial-content svelte-14vph7t")},m(n,s){A(n,e,s),r(e,t)},p:K,d(n){n&&j(e)}}}function Gt(l){let e,t,n,s=l[10]?"‚ñº":"‚ñ∂",o,i,c,u,m,v,d=l[10]&&Ht(l);return{c(){e=f("div"),t=f("button"),n=f("span"),o=O(s),i=_(),c=f("span"),c.textContent="üí° Tips:",u=_(),d&&d.c(),a(n,"class","toggle-icon svelte-14vph7t"),a(c,"class","tips-label svelte-14vph7t"),a(t,"class","tips-toggle svelte-14vph7t"),a(t,"data-testid","tips-toggle"),a(t,"aria-expanded",l[10]),a(e,"class","tips-section svelte-14vph7t")},m(h,g){A(h,e,g),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(e,u),d&&d.m(e,null),m||(v=U(t,"click",l[14]),m=!0)},p(h,g){g[0]&1024&&s!==(s=h[10]?"‚ñº":"‚ñ∂")&&X(o,s),g[0]&1024&&a(t,"aria-expanded",h[10]),h[10]?d?d.p(h,g):(d=Ht(h),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},d(h){h&&j(e),d&&d.d(),m=!1,v()}}}function Ht(l){let e,t=ne(l[16]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ot(Mt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","tips-content svelte-14vph7t")},m(s,o){A(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,o){if(o[0]&65536){t=ne(s[16]);let i;for(i=0;i<t.length;i+=1){const c=Mt(s,t,i);n[i]?n[i].p(c,o):(n[i]=Ot(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&j(e),he(n,s)}}}function Ot(l){let e;return{c(){e=f("div"),e.textContent=`${l[61]}`,a(e,"class","line dim svelte-14vph7t")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function Qn(l){let e,t=l[54].text+"",n,s;return{c(){e=f("div"),n=O(t),a(e,"class",s="line "+l[54].type+" svelte-14vph7t")},m(o,i){A(o,e,i),r(e,n)},p(o,i){i[0]&2&&t!==(t=o[54].text+"")&&X(n,t),i[0]&2&&s!==(s="line "+o[54].type+" svelte-14vph7t")&&a(e,"class",s)},d(o){o&&j(e)}}}function Kn(l){let e,t,n,s,o=l[54].text+"",i,c,u;function m(h,g){return h[54].variant==="enhanced"?ns:ls}let v=m(l),d=v(l);return{c(){e=f("div"),t=f("span"),d.c(),n=_(),s=f("div"),i=O(o),c=_(),a(t,"class","prompt-label svelte-14vph7t"),a(s,"class","prompt-text svelte-14vph7t"),a(e,"class",u="prompt-highlight "+l[54].variant+" svelte-14vph7t")},m(h,g){A(h,e,g),r(e,t),d.m(t,null),r(e,n),r(e,s),r(s,i),r(e,c)},p(h,g){v!==(v=m(h))&&(d.d(1),d=v(h),d&&(d.c(),d.m(t,null))),g[0]&2&&o!==(o=h[54].text+"")&&X(i,o),g[0]&2&&u!==(u="prompt-highlight "+h[54].variant+" svelte-14vph7t")&&a(e,"class",u)},d(h){h&&j(e),d.d()}}}function Yn(l){let e,t=l[54].text+"",n;return{c(){e=f("div"),n=O(t),a(e,"class","line progress-msg svelte-14vph7t")},m(s,o){A(s,e,o),r(e,n)},p(s,o){o[0]&2&&t!==(t=s[54].text+"")&&X(n,t)},d(s){s&&j(e)}}}function Xn(l){let e,t=l[53]!==l[2]&&Rt(l);return{c(){t&&t.c(),e=tt()},m(n,s){t&&t.m(n,s),A(n,e,s)},p(n,s){n[53]!==n[2]?t?t.p(n,s):(t=Rt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&j(e),t&&t.d(n)}}}function xn(l){let e;return{c(){e=f("div"),a(e,"class","divider svelte-14vph7t")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function $n(l){let e,t=l[54].text+"",n;return{c(){e=f("div"),n=O(t),a(e,"class","line header svelte-14vph7t")},m(s,o){A(s,e,o),r(e,n)},p(s,o){o[0]&2&&t!==(t=s[54].text+"")&&X(n,t)},d(s){s&&j(e)}}}function es(l){let e,t,n=ne(l[54].rows),s=[];for(let o=0;o<n.length;o+=1)s[o]=Dt(Lt(l,n,o));return{c(){e=f("div");for(let o=0;o<s.length;o+=1)s[o].c();t=_(),a(e,"class","vars-table svelte-14vph7t")},m(o,i){A(o,e,i);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null);r(e,t)},p(o,i){if(i[0]&2){n=ne(o[54].rows);let c;for(c=0;c<n.length;c+=1){const u=Lt(o,n,c);s[c]?s[c].p(u,i):(s[c]=Dt(u),s[c].c(),s[c].m(e,t))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}},d(o){o&&j(e),he(s,o)}}}function ts(l){let e,t,n=ne(l[54].rows),s=[];for(let o=0;o<n.length;o+=1)s[o]=zt(Tt(l,n,o));return{c(){e=f("div");for(let o=0;o<s.length;o+=1)s[o].c();t=_(),a(e,"class","cmd-table svelte-14vph7t")},m(o,i){A(o,e,i);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null);r(e,t)},p(o,i){if(i[0]&2){n=ne(o[54].rows);let c;for(c=0;c<n.length;c+=1){const u=Tt(o,n,c);s[c]?s[c].p(u,i):(s[c]=zt(u),s[c].c(),s[c].m(e,t))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}},d(o){o&&j(e),he(s,o)}}}function ls(l){let e;return{c(){e=O("üìú Final Prompt")},m(t,n){A(t,e,n)},d(t){t&&j(e)}}}function ns(l){let e;return{c(){e=O("üí° Enhanced Prompt")},m(t,n){A(t,e,n)},d(t){t&&j(e)}}}function Rt(l){let e,t,n,s=l[54].stage.replace(/_/g," ")+"",o,i,c,u=l[54].percent+"",m,v,d,h,g,p,k;return{c(){e=f("div"),t=f("div"),n=f("span"),o=O(s),i=_(),c=f("span"),m=O(u),v=O("%"),d=_(),h=f("div"),g=f("div"),p=f("div"),k=_(),a(n,"class","progress-stage svelte-14vph7t"),a(c,"class","progress-percent svelte-14vph7t"),a(t,"class","progress-header svelte-14vph7t"),a(p,"class","progress-glow svelte-14vph7t"),a(g,"class","progress-fill svelte-14vph7t"),ie(g,"width",l[54].percent+"%"),a(h,"class","progress-track svelte-14vph7t"),a(e,"class","progress-container svelte-14vph7t")},m(w,C){A(w,e,C),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(c,m),r(c,v),r(e,d),r(e,h),r(h,g),r(g,p),r(e,k)},p(w,C){C[0]&2&&s!==(s=w[54].stage.replace(/_/g," ")+"")&&X(o,s),C[0]&2&&u!==(u=w[54].percent+"")&&X(m,u),C[0]&2&&ie(g,"width",w[54].percent+"%")},d(w){w&&j(e)}}}function Dt(l){let e,t,n=l[56].id+"",s,o,i,c,u=l[56].count+"",m,v,d,h,g=l[56].sample+"",p;return{c(){e=f("div"),t=f("span"),s=O(n),o=_(),i=f("span"),c=O("("),m=O(u),v=O(")"),d=_(),h=f("span"),p=O(g),a(t,"class","var-id svelte-14vph7t"),a(i,"class","var-count svelte-14vph7t"),a(h,"class","var-sample svelte-14vph7t"),a(e,"class","var-row svelte-14vph7t")},m(k,w){A(k,e,w),r(e,t),r(t,s),r(e,o),r(e,i),r(i,c),r(i,m),r(i,v),r(e,d),r(e,h),r(h,p)},p(k,w){w[0]&2&&n!==(n=k[56].id+"")&&X(s,n),w[0]&2&&u!==(u=k[56].count+"")&&X(m,u),w[0]&2&&g!==(g=k[56].sample+"")&&X(p,g)},d(k){k&&j(e)}}}function zt(l){let e,t,n=l[56].cmd+"",s,o,i,c=l[56].desc+"",u;return{c(){e=f("div"),t=f("span"),s=O(n),o=_(),i=f("span"),u=O(c),a(t,"class","cmd-name svelte-14vph7t"),a(i,"class","cmd-desc svelte-14vph7t"),a(e,"class","cmd-row svelte-14vph7t")},m(m,v){A(m,e,v),r(e,t),r(t,s),r(e,o),r(e,i),r(i,u)},p(m,v){v[0]&2&&n!==(n=m[56].cmd+"")&&X(s,n),v[0]&2&&c!==(c=m[56].desc+"")&&X(u,c)},d(m){m&&j(e)}}}function Bt(l){let e;function t(o,i){return o[54].type==="table"?ts:o[54].type==="varsTable"?es:o[54].type==="header"?$n:o[54].type==="divider"?xn:o[54].type==="progress-bar"?Xn:o[54].type==="progress-msg"?Yn:o[54].type==="prompt-highlight"?Kn:Qn}let n=t(l),s=n(l);return{c(){s.c(),e=tt()},m(o,i){s.m(o,i),A(o,e,i)},p(o,i){n===(n=t(o))&&s?s.p(o,i):(s.d(1),s=n(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){o&&j(e),s.d(o)}}}function Nt(l){let e,t,n,s,o=l[13].stage.replace(/_/g," ")+"",i,c,u,m=l[13].percent+"",v,d,h,g,p,k;return{c(){e=f("div"),t=f("div"),n=f("div"),s=f("span"),i=O(o),c=_(),u=f("span"),v=O(m),d=O("%"),h=_(),g=f("div"),p=f("div"),k=f("div"),a(s,"class","progress-stage svelte-14vph7t"),a(u,"class","progress-percent svelte-14vph7t"),a(n,"class","progress-header svelte-14vph7t"),a(k,"class","progress-glow svelte-14vph7t"),a(p,"class","progress-fill svelte-14vph7t"),ie(p,"width",l[13].percent+"%"),a(g,"class","progress-track svelte-14vph7t"),a(t,"class","progress-container svelte-14vph7t"),a(e,"class","active-progress svelte-14vph7t")},m(w,C){A(w,e,C),r(e,t),r(t,n),r(n,s),r(s,i),r(n,c),r(n,u),r(u,v),r(u,d),r(t,h),r(t,g),r(g,p),r(p,k)},p(w,C){C[0]&8192&&o!==(o=w[13].stage.replace(/_/g," ")+"")&&X(i,o),C[0]&8192&&m!==(m=w[13].percent+"")&&X(v,m),C[0]&8192&&ie(p,"width",w[13].percent+"%")},d(w){w&&j(e)}}}function Ut(l){let e,t=ne(l[5]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Vt(jt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","suggestions svelte-14vph7t")},m(s,o){A(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,o){if(o[0]&262304){t=ne(s[5]);let i;for(i=0;i<t.length;i+=1){const c=jt(s,t,i);n[i]?n[i].p(c,o):(n[i]=Vt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&j(e),he(n,s)}}}function Vt(l){let e,t=l[51]+"",n,s,o,i;function c(){return l[34](l[51])}return{c(){e=f("button"),n=O(t),s=_(),a(e,"class","suggestion svelte-14vph7t"),ce(e,"selected",l[53]===l[7])},m(u,m){A(u,e,m),r(e,n),r(e,s),o||(i=U(e,"click",c),o=!0)},p(u,m){l=u,m[0]&32&&t!==(t=l[51]+"")&&X(n,t),m[0]&128&&ce(e,"selected",l[53]===l[7])},d(u){u&&j(e),o=!1,i()}}}function ss(l){let e,t,n,s,o,i,c,u,m,v,d,h,g,p,k,w=(l[3].cli.showTutorialOnStart||l[11])&&It(l),C=(l[3].cli.showTipsOnStart||l[10])&&Gt(l),M=ne(l[1]),b=[];for(let F=0;F<M.length;F+=1)b[F]=Bt(At(l,M,F));let y=l[13]&&Nt(l),G=l[6]&&Ut(l);return{c(){e=f("div"),t=f("div"),w&&w.c(),n=_(),C&&C.c(),s=_();for(let F=0;F<b.length;F+=1)b[F].c();o=_(),y&&y.c(),i=_(),c=f("div"),u=f("div"),m=f("span"),m.textContent="‚ùØ‚ùØ‚ùØ",v=_(),d=f("input"),g=_(),G&&G.c(),a(t,"class","history svelte-14vph7t"),a(m,"class","prompt-symbol svelte-14vph7t"),a(d,"placeholder",h=l[0]?"Generating...":"Enter prompt or /help"),d.disabled=l[0],a(d,"spellcheck","false"),a(d,"autocomplete","off"),a(d,"class","svelte-14vph7t"),a(u,"class","input-line svelte-14vph7t"),a(c,"class","input-area svelte-14vph7t"),a(e,"class","cli svelte-14vph7t"),ie(e,"font-size",l[12])},m(F,z){A(F,e,z),r(e,t),w&&w.m(t,null),r(t,n),C&&C.m(t,null),r(t,s);for(let I=0;I<b.length;I+=1)b[I]&&b[I].m(t,null);l[31](t),r(e,o),y&&y.m(e,null),r(e,i),r(e,c),r(c,u),r(u,m),r(u,v),r(u,d),l[32](d),pe(d,l[4]),r(c,g),G&&G.m(c,null),p||(k=[U(d,"input",l[33]),U(d,"input",l[17]),U(d,"keydown",l[19])],p=!0)},p(F,z){if(F[3].cli.showTutorialOnStart||F[11]?w?w.p(F,z):(w=It(F),w.c(),w.m(t,n)):w&&(w.d(1),w=null),F[3].cli.showTipsOnStart||F[10]?C?C.p(F,z):(C=Gt(F),C.c(),C.m(t,s)):C&&(C.d(1),C=null),z[0]&6){M=ne(F[1]);let I;for(I=0;I<M.length;I+=1){const H=At(F,M,I);b[I]?b[I].p(H,z):(b[I]=Bt(H),b[I].c(),b[I].m(t,null))}for(;I<b.length;I+=1)b[I].d(1);b.length=M.length}F[13]?y?y.p(F,z):(y=Nt(F),y.c(),y.m(e,i)):y&&(y.d(1),y=null),z[0]&1&&h!==(h=F[0]?"Generating...":"Enter prompt or /help")&&a(d,"placeholder",h),z[0]&1&&(d.disabled=F[0]),z[0]&16&&d.value!==F[4]&&pe(d,F[4]),F[6]?G?G.p(F,z):(G=Ut(F),G.c(),G.m(c,null)):G&&(G.d(1),G=null),z[0]&4096&&ie(e,"font-size",F[12])},i:K,o:K,d(F){F&&j(e),w&&w.d(),C&&C.d(),he(b,F),l[31](null),y&&y.d(),l[32](null),G&&G.d(),p=!1,ke(k)}}}const os="Welcome to Z-Explorer! This tutorial will guide you through the app. (Coming soon...)";function is(l){const e={count:1,width:1024,height:1024};if(!l.includes(":"))return{prompt:l,params:e};const t=l.split(":"),n=t[t.length-1].trim();if(!/[xhw]\d/.test(n))return{prompt:l,params:e};const s=t.slice(0,-1).join(":").trim();for(const o of n.split(",")){const i=o.trim().toLowerCase();i.startsWith("x")&&(e.count=parseInt(i.slice(1))||1),i.startsWith("h")&&(e.height=parseInt(i.slice(1))||1024),i.startsWith("w")&&(e.width=parseInt(i.slice(1))||1024)}return{prompt:s,params:e}}function rs(l,e,t){let n,s,o;Ae(l,Me,T=>t(3,o=T));let{isGenerating:i=!1}=e,{isTauriAvailable:c=!1}=e,{getGpuInfo:u=null}=e,{unloadModels:m=null}=e,{listVariables:v=null}=e,{openSettings:d=null}=e;const h=rt();let g="",p=[],k=[],w=!1,C=-1,M,b,y=-1,G=null,F=[],z="0.4.1",I={image_model:"Z-Image-Turbo",image_mode:"loading...",llm_model:"Qwen3-4B",llm_mode:"loading..."};const H=["/help","/vars","/enhance","/seed","/size","/gpu","/unload","/settings","/version","/changelog","/quit","/q"];let D=o.cli.showTipsOnStart,B=o.cli.showTutorialOnStart;async function R(T){try{const Z=await fetch(`${T}/api/health`,{signal:AbortSignal.timeout(2e3)});if(Z.ok){const S=await Z.json();S.version&&(z=S.version)}const J=await fetch(`${T}/api/config`,{signal:AbortSignal.timeout(2e3)});if(J.ok){const S=await J.json();I=S,t(1,p=p.map(x=>x.type==="info"&&x.text.includes("Image:")?{...x,text:`üé® Image: ${S.image_model} (${S.image_mode})  ‚Ä¢  ü§ñ LLM: ${S.llm_model} (${S.llm_mode})`}:x))}}catch{}}async function L(){if(console.log("üìö [FakeCLI] Loading variables..."),v)try{const T=await v();console.log("üìö [FakeCLI] Variables result:",T),T?.success&&T.variables?(F=T.variables.map(Z=>Z.id),console.log("‚úÖ [FakeCLI] Loaded variables for autocomplete:",F)):console.warn("‚ö†Ô∏è [FakeCLI] No variables returned")}catch(T){console.error("‚ùå [FakeCLI] Could not load variables:",T)}else console.warn("‚ö†Ô∏è [FakeCLI] listVariables prop not provided")}it(async()=>{t(1,p=[{type:"info",text:`üé® Image: ${I.image_model} (${I.image_mode})  ‚Ä¢  ü§ñ LLM: ${I.llm_model} (${I.llm_mode})`},{type:"success",text:"‚úì All dependencies available"}]),await L(),M?.focus()});function Q(){t(10,D=!D)}function P(){t(11,B=!B)}const ee=["‚Ä¢ Use __variable__ syntax for random substitution (e.g., __animal__)","‚Ä¢ Missing variables are auto-generated by the local LLM","‚Ä¢ Add '>' to enhance prompt (e.g., 'a cat > make it magical')","‚Ä¢ Add batch params with ':' (e.g., 'prompt : x10,h832,w1216')"];function q(){const T=M?.selectionStart||0,Z=g.slice(0,T);if(Z.includes("/")){const J=Z.lastIndexOf("/"),S=Z.slice(J);t(5,k=H.filter(x=>x.startsWith(S)&&x!==S)),t(6,w=k.length>0),console.log(`üîç [Autocomplete] Command suggestions for "${S}":`,k);return}if(Z.includes("__")){const J=Z.lastIndexOf("__"),S=Z.slice(J);if(console.log(`üîç [Autocomplete] Looking for variables matching "${S}"`),console.log("üîç [Autocomplete] Available promptVars:",F),(S.match(/__/g)||[]).length===1){t(5,k=F.filter(x=>x.startsWith(S)&&x!==S)),t(6,w=k.length>0),console.log("üîç [Autocomplete] Variable suggestions:",k);return}}t(6,w=!1),t(5,k=[])}function ae(T){const Z=M?.selectionStart||0,J=g.slice(0,Z);if(J.includes("/")){const S=J.lastIndexOf("/");t(4,g=g.slice(0,S)+T+g.slice(Z))}else if(J.includes("__")){const S=J.lastIndexOf("__");J.slice(S),t(4,g=g.slice(0,S)+T+g.slice(Z))}t(6,w=!1),t(7,C=-1),M?.focus()}function W(T){if(w){if(T.key==="ArrowDown"){T.preventDefault(),t(7,C=Math.min(C+1,k.length-1));return}if(T.key==="ArrowUp"){T.preventDefault(),t(7,C=Math.max(C-1,-1));return}if((T.key==="Tab"||T.key==="Enter")&&C>=0){T.preventDefault(),ae(k[C]);return}if(T.key==="Escape"){t(6,w=!1);return}}T.key==="Enter"&&!w&&me()}function me(){if(!g.trim()||i)return;const T=g.trim();if(T.startsWith("/")){we(T),t(4,g="");return}const{prompt:Z,params:J}=is(T);t(1,p=[...p,{type:"input",text:`>>> ${T}`}]),(J.count>1||J.width!==1024||J.height!==1024)&&t(1,p=[...p,{type:"info",text:`üìê Batch: ${J.count} image(s) @ ${J.width}√ó${J.height}`}]),h("generate",{prompt:Z,params:J,seed:G}),G=null,de()}function we(T){t(1,p=[...p,{type:"input",text:`>>> ${T}`}]);const[Z,...J]=T.split(" ");switch(Z){case"/help":t(1,p=[...p,{type:"header",text:"üìñ Commands"},{type:"table",rows:[{cmd:"/help",desc:"Show this help"},{cmd:"/vars",desc:"List available prompt variables"},{cmd:"/enhance <prompt>",desc:"Enhance a prompt without generating"},{cmd:"/seed <number>",desc:"Set seed for next generation"},{cmd:"/size <WxH>",desc:"Set output size (e.g., 1024x1024)"},{cmd:"/gpu",desc:"Show GPU memory status"},{cmd:"/unload",desc:"Unload models to free GPU memory"},{cmd:"/settings",desc:"Open settings dialog"},{cmd:"/version",desc:"Show version information"},{cmd:"/changelog",desc:"Show recent changes"},{cmd:"/quit or /q",desc:"Exit"}]},{type:"divider"},{type:"cyan",text:"üí° Tips:"},{type:"dim",text:"‚Ä¢ Use __variable__ syntax for random substitution (e.g., __animal__)"},{type:"dim",text:"‚Ä¢ Missing variables are auto-generated by the local LLM"},{type:"dim",text:"‚Ä¢ Add '>' to enhance prompt (e.g., 'a cat > make it magical')"},{type:"dim",text:"‚Ä¢ Add batch params with ':' (e.g., 'prompt : x10,h832,w1216')"},{type:"dim",text:"  x<N>=count, h<N>=height, w<N>=width (all optional)"}]);break;case"/vars":v?(t(1,p=[...p,{type:"cyan",text:"üìã Loading variables..."}]),de(),v().then(S=>{if(S?.success&&S.variables){const x=S.variables.map($=>({id:$.id,count:$.count,sample:$.sample?.slice(0,3).join(", ")||""}));t(1,p=[...p,{type:"header",text:`üìã ${S.count} Variables Available`},{type:"varsTable",rows:x}]),F=S.variables.map($=>$.id)}else t(1,p=[...p,{type:"error",text:"‚ùå Failed to load variables"}]);de()})):t(1,p=[...p,{type:"header",text:"üìã Available Variables"},{type:"divider"},...F.map(S=>({type:"magenta",text:`  ${S}`}))]);break;case"/enhance":J.length>0?t(1,p=[...p,{type:"cyan",text:"ü§ñ Enhancing prompt with local LLM..."},{type:"dim",text:"(Enhancement will be applied during generation)"}]):t(1,p=[...p,{type:"error",text:"‚ùå Usage: /enhance <prompt>"}]);break;case"/seed":if(J.length>0){const S=parseInt(J[0]);!isNaN(S)&&S>=0?(G=S,t(1,p=[...p,{type:"success",text:`‚úì Seed set to: ${S}`},{type:"dim",text:"(Will be used for next generation, then reset)"}])):t(1,p=[...p,{type:"error",text:"‚ùå Invalid seed (must be a positive number)"}])}else G=null,t(1,p=[...p,{type:"cyan",text:"üé≤ Seed reset to random"}]);break;case"/size":if(J.length>0){const S=J[0].toLowerCase().match(/(\d+)x(\d+)/);S?t(1,p=[...p,{type:"success",text:`‚úì Size set to: ${S[1]}√ó${S[2]}`}]):t(1,p=[...p,{type:"error",text:"‚ùå Invalid size format. Use: /size 1024x1024"}])}else t(1,p=[...p,{type:"cyan",text:"üìê Current size: 1024√ó1024"}]);break;case"/gpu":u?(t(1,p=[...p,{type:"cyan",text:"üñ•Ô∏è Fetching GPU info..."}]),de(),u().then(S=>{S?.available?t(1,p=[...p,{type:"header",text:"üñ•Ô∏è GPU Memory Status"},{type:"success",text:`Device: ${S.device_name}`},{type:"info",text:`Allocated: ${S.allocated_gb} GB`},{type:"info",text:`Reserved: ${S.reserved_gb} GB`},{type:"info",text:`Total: ${S.total_gb} GB`},{type:"cyan",text:`Free: ${S.free_gb} GB`}]):t(1,p=[...p,{type:"error",text:`‚ùå ${S?.error||"GPU not available"}`}]),de()})):t(1,p=[...p,{type:"dim",text:"(GPU info not available in demo mode)"}]);break;case"/unload":m?(t(1,p=[...p,{type:"cyan",text:"üîÑ Unloading models..."}]),de(),m().then(S=>{if(S?.success){const x=[];S.llm_unloaded&&x.push("LLM (Qwen3-4B)"),S.image_model_unloaded&&x.push("Image model (Z-Image-Turbo)"),S.cuda_cache_cleared&&x.push("CUDA cache"),x.length>0?t(1,p=[...p,{type:"success",text:"‚úì Models unloaded successfully"},{type:"dim",text:`Unloaded: ${x.join(", ")}`},{type:"dim",text:"(Models will reload on next generation)"}]):t(1,p=[...p,{type:"info",text:"‚ÑπÔ∏è No models were loaded"}])}else t(1,p=[...p,{type:"error",text:"‚ùå Failed to unload models"}]);de()})):t(1,p=[...p,{type:"dim",text:"(Unload not available in demo mode)"}]);break;case"/version":t(1,p=[...p,{type:"header",text:`‚ö° Z-Explorer v${z}`},{type:"dim",text:"AI Image Generation Without the UI Tax"},{type:"info",text:"Z-Image-Turbo + Qwen3-4B"},{type:"divider"},{type:"dim",text:"GitHub: github.com/pyros-projects/z-Explorer"}]);break;case"/changelog":t(1,p=[...p,{type:"header",text:"üìã Changelog"},{type:"cyan",text:`v${z} - Desktop GUI Integration`},{type:"divider"},{type:"success",text:"‚ú® Added:"},{type:"dim",text:"‚Ä¢ Native desktop app via Tauri with bundled uv binary"},{type:"dim",text:"‚Ä¢ Three modes: GUI (default), CLI (--cli), Server (--server)"},{type:"dim",text:"‚Ä¢ Progress streaming via Server-Sent Events (SSE)"},{type:"dim",text:"‚Ä¢ Masonry gallery layout for generated images"},{type:"dim",text:"‚Ä¢ Prompt saved alongside images as .txt files"},{type:"dim",text:"‚Ä¢ Variable autocomplete in CLI-style input"},{type:"dim",text:"‚Ä¢ /changelog and /version commands"},{type:"divider"},{type:"info",text:"üîÑ Changed:"},{type:"dim",text:"‚Ä¢ Default mode is now GUI (previously CLI-only)"},{type:"dim",text:"‚Ä¢ Server port standardized to 8345"},{type:"divider"},{type:"dim",text:"Full changelog: github.com/pyros-projects/z-Explorer/blob/main/CHANGELOG.md"}]);break;case"/settings":d?(t(1,p=[...p,{type:"cyan",text:"‚öôÔ∏è Opening settings..."}]),d()):t(1,p=[...p,{type:"dim",text:"(Settings not available in this mode)"}]);break;case"/quit":case"/q":t(1,p=[...p,{type:"cyan",text:"üëã Goodbye! (Close the window to exit)"}]);break;default:t(1,p=[...p,{type:"error",text:`‚ùå Unknown command: ${Z}`},{type:"dim",text:"Type /help for available commands"}])}de()}function de(){setTimeout(()=>{b&&t(9,b.scrollTop=b.scrollHeight,b)},10)}function _e(T,Z=!1){t(1,p=[...p,{type:Z?"error":"output",text:T}]),de()}const fe={starting:"üöÄ",loading_vars:"üìã",substituting:"üîÑ",var_missing:"‚ö†Ô∏è",var_generating:"ü§ñ",var_saved:"üíæ",enhancing:"‚ú®",enhanced:"üí°",phase1_complete:"üìù",final_prompt:"üìú",llm_unloaded:"üßπ",loading_image_model:"üé®",generating_image:"üñºÔ∏è",diffusion_step:"‚ö°",generating_steps:"‚ö°",image_saved:"üíæ",complete:"‚úÖ",error:"‚ùå"},E=new Set(["diffusion_step","generating_steps"]);function N(){console.log("üé¨ [FakeCLI] startGeneration() called"),t(2,y=p.length),t(1,p=[...p,{type:"progress-bar",percent:0,stage:"starting"}]),console.log("üìä [FakeCLI] Progress bar added at index:",y),de()}function Y(T,Z,J){if(console.log(`üìà [FakeCLI] updateProgress(${T}%, ${Z}, "${J}")`),y>=0&&y<p.length?(t(1,p[y]={type:"progress-bar",percent:T,stage:Z},p),t(1,p=[...p]),console.log(`üìä [FakeCLI] Progress bar updated: ${T}% - ${Z}`)):console.warn("‚ö†Ô∏è [FakeCLI] Progress bar index invalid:",y),J&&!E.has(Z)){const S=fe[Z]||"‚ö°";Z==="enhanced"?console.log("üí° [FakeCLI] Skipping enhanced prompt display (will show in final)"):Z==="final_prompt"?(t(1,p=[...p,{type:"prompt-highlight",variant:"final",text:J}]),console.log(`üìú [FakeCLI] Added final prompt: ${J.substring(0,50)}...`)):(t(1,p=[...p,{type:"progress-msg",text:`${S} ${J}`}]),console.log(`üí¨ [FakeCLI] Added progress message: ${S} ${J}`))}else E.has(Z)&&console.log(`üîá [FakeCLI] Silent stage, only updating bar: ${Z}`);de()}function se(T){console.log(`üèÅ [FakeCLI] completeGeneration(success=${T})`),y>=0&&y<p.length&&(t(1,p[y]={type:"progress-bar",percent:100,stage:T?"complete":"error"},p),t(1,p=[...p]),console.log("‚úÖ [FakeCLI] Progress bar set to complete")),t(2,y=-1),de()}function le(){se(!0)}const ue={small:"11px",medium:"13px",large:"15px"};function oe(T){Qe[T?"unshift":"push"](()=>{b=T,t(9,b)})}function V(T){Qe[T?"unshift":"push"](()=>{M=T,t(8,M)})}function re(){g=this.value,t(4,g)}const ge=T=>ae(T);return l.$$set=T=>{"isGenerating"in T&&t(0,i=T.isGenerating),"isTauriAvailable"in T&&t(20,c=T.isTauriAvailable),"getGpuInfo"in T&&t(21,u=T.getGpuInfo),"unloadModels"in T&&t(22,m=T.unloadModels),"listVariables"in T&&t(23,v=T.listVariables),"openSettings"in T&&t(24,d=T.openSettings)},l.$$.update=()=>{l.$$.dirty[0]&6&&t(13,n=(()=>{if(y>=0&&y<p.length){const T=p[y];if(T.type==="progress-bar")return T}return null})()),l.$$.dirty[0]&8&&t(12,s=ue[o.cli.fontSize]||"13px")},[i,p,y,o,g,k,w,C,M,b,D,B,s,n,Q,P,ee,q,ae,W,c,u,m,v,d,R,_e,N,Y,se,le,oe,V,re,ge]}class as extends Te{constructor(e){super(),Le(this,e,rs,ss,Fe,{isGenerating:0,isTauriAvailable:20,getGpuInfo:21,unloadModels:22,listVariables:23,openSettings:24,fetchVersion:25,addResult:26,startGeneration:27,updateProgress:28,completeGeneration:29,clearProgress:30},null,[-1,-1,-1])}get fetchVersion(){return this.$$.ctx[25]}get addResult(){return this.$$.ctx[26]}get startGeneration(){return this.$$.ctx[27]}get updateProgress(){return this.$$.ctx[28]}get completeGeneration(){return this.$$.ctx[29]}get clearProgress(){return this.$$.ctx[30]}}function qt(l,e,t){const n=l.slice();return n[16]=e[t],n}function Wt(l,e,t){const n=l.slice();return n[16]=e[t],n}function cs(l){let e,t,n,s,o,i,c,u,m,v,d,h,g=ne(l[5]),p=[];for(let k=0;k<g.length;k+=1)p[k]=Zt(qt(l,g,k));return{c(){e=f("div"),t=f("h2"),t.textContent="Models Required",n=_(),s=f("p"),s.textContent="Z-Explorer needs to download AI models (~5-10 GB) to generate images locally.",o=_(),i=f("div");for(let k=0;k<p.length;k+=1)p[k].c();c=_(),u=f("button"),u.innerHTML='<span>Download Models</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1vajwe8"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"></path></svg>',m=_(),v=f("p"),v.textContent="Models are cached locally for offline use",a(t,"class","svelte-1vajwe8"),a(s,"class","info-text svelte-1vajwe8"),a(i,"class","models-list svelte-1vajwe8"),a(u,"class","primary-btn svelte-1vajwe8"),a(v,"class","storage-hint svelte-1vajwe8"),a(e,"class","ready-state svelte-1vajwe8")},m(k,w){A(k,e,w),r(e,t),r(e,n),r(e,s),r(e,o),r(e,i);for(let C=0;C<p.length;C+=1)p[C]&&p[C].m(i,null);r(e,c),r(e,u),r(e,m),r(e,v),d||(h=U(u,"click",l[9]),d=!0)},p(k,w){if(w&96){g=ne(k[5]);let C;for(C=0;C<g.length;C+=1){const M=qt(k,g,C);p[C]?p[C].p(M,w):(p[C]=Zt(M),p[C].c(),p[C].m(i,null))}for(;C<p.length;C+=1)p[C].d(1);p.length=g.length}},d(k){k&&j(e),he(p,k),d=!1,h()}}}function us(l){let e,t,n,s,o,i,c,u=l[7]&&Jt(l),m=ne(l[5]),v=[];for(let d=0;d<m.length;d+=1)v[d]=xt(Wt(l,m,d));return{c(){e=f("div"),t=f("h2"),t.textContent="Downloading Models",n=_(),u&&u.c(),s=_(),o=f("div");for(let d=0;d<v.length;d+=1)v[d].c();i=_(),c=f("p"),c.textContent="This may take several minutes depending on your connection",a(t,"class","svelte-1vajwe8"),a(o,"class","models-list svelte-1vajwe8"),a(c,"class","download-hint svelte-1vajwe8"),a(e,"class","download-state svelte-1vajwe8")},m(d,h){A(d,e,h),r(e,t),r(e,n),u&&u.m(e,null),r(e,s),r(e,o);for(let g=0;g<v.length;g+=1)v[g]&&v[g].m(o,null);r(e,i),r(e,c)},p(d,h){if(d[7]?u?u.p(d,h):(u=Jt(d),u.c(),u.m(e,s)):u&&(u.d(1),u=null),h&416){m=ne(d[5]);let g;for(g=0;g<m.length;g+=1){const p=Wt(d,m,g);v[g]?v[g].p(p,h):(v[g]=xt(p),v[g].c(),v[g].m(o,null))}for(;g<v.length;g+=1)v[g].d(1);v.length=m.length}},d(d){d&&j(e),u&&u.d(),he(v,d)}}}function fs(l){let e,t,n,s,o,i,c=(l[4]||"An error occurred")+"",u,m,v,d,h;return{c(){e=f("div"),t=f("div"),t.textContent="!",n=_(),s=f("h2"),s.textContent="Download Failed",o=_(),i=f("p"),u=O(c),m=_(),v=f("button"),v.textContent="Retry Download",a(t,"class","error-icon svelte-1vajwe8"),a(s,"class","svelte-1vajwe8"),a(i,"class","error-message svelte-1vajwe8"),a(v,"class","primary-btn svelte-1vajwe8"),a(e,"class","error-state svelte-1vajwe8")},m(g,p){A(g,e,p),r(e,t),r(e,n),r(e,s),r(e,o),r(e,i),r(i,u),r(e,m),r(e,v),d||(h=U(v,"click",l[11]),d=!0)},p(g,p){p&16&&c!==(c=(g[4]||"An error occurred")+"")&&X(u,c)},d(g){g&&j(e),d=!1,h()}}}function ds(l){let e,t,n,s,o,i,c,u,m,v;return{c(){e=f("div"),t=f("div"),t.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="svelte-1vajwe8"><polyline points="20 6 9 17 4 12"></polyline></svg>',n=_(),s=f("h2"),s.textContent="Ready to Create",o=_(),i=f("p"),i.textContent="All models downloaded. Let's make some art.",c=_(),u=f("button"),u.innerHTML='<span>Start Creating</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1vajwe8"><path d="M5 12h14M12 5l7 7-7 7"></path></svg>',a(t,"class","success-icon svelte-1vajwe8"),a(s,"class","svelte-1vajwe8"),a(i,"class","svelte-1vajwe8"),a(u,"class","primary-btn svelte-1vajwe8"),a(e,"class","complete-state svelte-1vajwe8")},m(d,h){A(d,e,h),r(e,t),r(e,n),r(e,s),r(e,o),r(e,i),r(e,c),r(e,u),m||(v=U(u,"click",l[10]),m=!0)},p:K,d(d){d&&j(e),m=!1,v()}}}function ps(l){let e;return{c(){e=f("div"),e.innerHTML='<div class="spinner svelte-1vajwe8"></div> <p class="svelte-1vajwe8">Initializing...</p>',a(e,"class","loading-state svelte-1vajwe8")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function Zt(l){let e,t,n=l[6][l[16].name]?"‚úì":"‚óã",s,o,i,c,u=l[16].name+"",m,v,d,h=l[16].repo_id+"",g,p;return{c(){e=f("div"),t=f("span"),s=O(n),o=_(),i=f("div"),c=f("span"),m=O(u),v=_(),d=f("span"),g=O(h),p=_(),a(t,"class","model-check svelte-1vajwe8"),a(c,"class","model-label svelte-1vajwe8"),a(d,"class","model-repo svelte-1vajwe8"),a(i,"class","model-info svelte-1vajwe8"),a(e,"class","model-item svelte-1vajwe8"),ce(e,"downloaded",l[6][l[16].name])},m(k,w){A(k,e,w),r(e,t),r(t,s),r(e,o),r(e,i),r(i,c),r(c,m),r(i,v),r(i,d),r(d,g),r(e,p)},p(k,w){w&96&&n!==(n=k[6][k[16].name]?"‚úì":"‚óã")&&X(s,n),w&32&&u!==(u=k[16].name+"")&&X(m,u),w&32&&h!==(h=k[16].repo_id+"")&&X(g,h),w&96&&ce(e,"downloaded",k[6][k[16].name])},d(k){k&&j(e)}}}function Jt(l){let e,t,n,s=l[7].model_name+"",o,i,c,u=l[7].status+"",m,v,d,h,g,p,k,w=l[7].progress_percent.toFixed(1)+"",C,M,b,y,G,F,z=l[7].bytes_total>0&&Qt(l),I=l[7].speed_mbps>0&&Kt(l),H=l[7].eta_seconds&&Yt(l),D=l[7].current_file&&Xt(l);return{c(){e=f("div"),t=f("div"),n=f("span"),o=O(s),i=_(),c=f("span"),m=O(u),v=_(),d=f("div"),h=f("div"),g=_(),p=f("div"),k=f("span"),C=O(w),M=O("%"),b=_(),z&&z.c(),y=_(),I&&I.c(),G=_(),H&&H.c(),F=_(),D&&D.c(),a(n,"class","model-name svelte-1vajwe8"),a(c,"class","model-status svelte-1vajwe8"),a(t,"class","model-header svelte-1vajwe8"),a(h,"class","progress-bar svelte-1vajwe8"),ie(h,"width",l[7].progress_percent+"%"),a(d,"class","progress-bar-container svelte-1vajwe8"),a(k,"class","progress-percent svelte-1vajwe8"),a(p,"class","progress-details svelte-1vajwe8"),a(e,"class","current-model svelte-1vajwe8")},m(B,R){A(B,e,R),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(c,m),r(e,v),r(e,d),r(d,h),r(e,g),r(e,p),r(p,k),r(k,C),r(k,M),r(p,b),z&&z.m(p,null),r(p,y),I&&I.m(p,null),r(p,G),H&&H.m(p,null),r(e,F),D&&D.m(e,null)},p(B,R){R&128&&s!==(s=B[7].model_name+"")&&X(o,s),R&128&&u!==(u=B[7].status+"")&&X(m,u),R&128&&ie(h,"width",B[7].progress_percent+"%"),R&128&&w!==(w=B[7].progress_percent.toFixed(1)+"")&&X(C,w),B[7].bytes_total>0?z?z.p(B,R):(z=Qt(B),z.c(),z.m(p,y)):z&&(z.d(1),z=null),B[7].speed_mbps>0?I?I.p(B,R):(I=Kt(B),I.c(),I.m(p,G)):I&&(I.d(1),I=null),B[7].eta_seconds?H?H.p(B,R):(H=Yt(B),H.c(),H.m(p,null)):H&&(H.d(1),H=null),B[7].current_file?D?D.p(B,R):(D=Xt(B),D.c(),D.m(e,null)):D&&(D.d(1),D=null)},d(B){B&&j(e),z&&z.d(),I&&I.d(),H&&H.d(),D&&D.d()}}}function Qt(l){let e,t=Ye(l[7].bytes_done)+"",n,s,o=Ye(l[7].bytes_total)+"",i;return{c(){e=f("span"),n=O(t),s=O(" / "),i=O(o),a(e,"class","progress-size")},m(c,u){A(c,e,u),r(e,n),r(e,s),r(e,i)},p(c,u){u&128&&t!==(t=Ye(c[7].bytes_done)+"")&&X(n,t),u&128&&o!==(o=Ye(c[7].bytes_total)+"")&&X(i,o)},d(c){c&&j(e)}}}function Kt(l){let e,t=l[7].speed_mbps.toFixed(1)+"",n,s;return{c(){e=f("span"),n=O(t),s=O(" MB/s"),a(e,"class","progress-speed")},m(o,i){A(o,e,i),r(e,n),r(e,s)},p(o,i){i&128&&t!==(t=o[7].speed_mbps.toFixed(1)+"")&&X(n,t)},d(o){o&&j(e)}}}function Yt(l){let e,t,n=$t(l[7].eta_seconds)+"",s;return{c(){e=f("span"),t=O("ETA: "),s=O(n),a(e,"class","progress-eta")},m(o,i){A(o,e,i),r(e,t),r(e,s)},p(o,i){i&128&&n!==(n=$t(o[7].eta_seconds)+"")&&X(s,n)},d(o){o&&j(e)}}}function Xt(l){let e,t=l[7].current_file+"",n;return{c(){e=f("div"),n=O(t),a(e,"class","current-file svelte-1vajwe8")},m(s,o){A(s,e,o),r(e,n)},p(s,o){o&128&&t!==(t=s[7].current_file+"")&&X(n,t)},d(s){s&&j(e)}}}function ms(l){let e;return{c(){e=O("‚óã")},m(t,n){A(t,e,n)},d(t){t&&j(e)}}}function gs(l){let e;return{c(){e=O("‚óè")},m(t,n){A(t,e,n)},d(t){t&&j(e)}}}function hs(l){let e;return{c(){e=O("‚úì")},m(t,n){A(t,e,n)},d(t){t&&j(e)}}}function xt(l){let e,t,n,s,o,i=l[16].name+"",c,u;function m(h,g){return g&288&&(n=null),n==null&&(n=!!h[8].includes(h[16].name)),n?hs:h[7]?.model_name===h[16].name?gs:ms}let v=m(l,-1),d=v(l);return{c(){e=f("div"),t=f("span"),d.c(),s=_(),o=f("span"),c=O(i),u=_(),a(t,"class","model-check svelte-1vajwe8"),a(o,"class","model-label svelte-1vajwe8"),a(e,"class","model-item svelte-1vajwe8"),ce(e,"completed",l[8].includes(l[16].name)),ce(e,"active",l[7]?.model_name===l[16].name)},m(h,g){A(h,e,g),r(e,t),d.m(t,null),r(e,s),r(e,o),r(o,c),r(e,u)},p(h,g){v!==(v=m(h,g))&&(d.d(1),d=v(h),d&&(d.c(),d.m(t,null))),g&32&&i!==(i=h[16].name+"")&&X(c,i),g&288&&ce(e,"completed",h[8].includes(h[16].name)),g&160&&ce(e,"active",h[7]?.model_name===h[16].name)},d(h){h&&j(e),d.d()}}}function vs(l){let e,t,n,s,o,i,c,u;function m(h,g){return h[0]?ps:h[2]?ds:h[3]?fs:h[1]?us:cs}let v=m(l),d=v(l);return{c(){e=f("div"),t=f("div"),n=f("div"),n.innerHTML='<img src="/assets/icon.jpg" alt="Z-Explorer" class="logo-img svelte-1vajwe8"/> <h1 class="svelte-1vajwe8">Z-Explorer</h1> <p class="subtitle svelte-1vajwe8">Local AI Image Generation</p>',s=_(),d.c(),o=_(),i=f("div"),c=_(),u=f("div"),a(n,"class","header svelte-1vajwe8"),a(t,"class","setup-card svelte-1vajwe8"),a(i,"class","bg-glow svelte-1vajwe8"),a(u,"class","bg-glow-2 svelte-1vajwe8"),a(e,"class","setup-container svelte-1vajwe8")},m(h,g){A(h,e,g),r(e,t),r(t,n),r(t,s),d.m(t,null),r(e,o),r(e,i),r(e,c),r(e,u)},p(h,[g]){v===(v=m(h))&&d?d.p(h,g):(d.d(1),d=v(h),d&&(d.c(),d.m(t,null)))},i:K,o:K,d(h){h&&j(e),d.d()}}}function Ye(l){if(l===0)return"0 B";const e=1024,t=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,n)).toFixed(2))+" "+t[n]}function $t(l){if(!l||l<=0)return"--:--";const e=Math.floor(l/60),t=Math.floor(l%60);return`${e}:${t.toString().padStart(2,"0")}`}function _s(l,e,t){let{apiBase:n=""}=e;const s=rt();let o=!0,i=!1,c=!1,u=!1,m="",v=[],d={},h=null,g=[],p=null;async function k(){try{const b=await fetch(`${n}/api/setup/status`);if(b.ok){const y=await b.json();t(5,v=y.models_needed||[]),t(6,d=y.models_downloaded||{}),v.every(F=>d[F.name])&&v.length>0&&t(2,c=!0)}}catch(b){console.error("Failed to check setup status:",b)}finally{t(0,o=!1)}}function w(){i||(t(1,i=!0),t(3,u=!1),t(4,m=""),t(8,g=[]),p=new EventSource(`${n}/api/setup/download`),p.onmessage=b=>{try{const y=JSON.parse(b.data);if(y.status==="all_complete"||y.status==="error"){t(2,c=y.success),t(3,u=!y.success),t(1,i=!1),p?.close();return}t(7,h=y),y.status==="complete"&&y.model_name&&(g.includes(y.model_name)||t(8,g=[...g,y.model_name])),y.status==="error"&&y.error&&(t(3,u=!0),t(4,m=y.error),t(1,i=!1),p?.close())}catch(y){console.error("Failed to parse download progress:",y)}},p.onerror=b=>{console.error("Download SSE error:",b),t(3,u=!0),t(4,m="Connection to server lost"),t(1,i=!1),p?.close()})}function C(){s("complete")}function M(){t(3,u=!1),t(4,m=""),w()}return it(()=>{k()}),Ml(()=>{p?.close()}),l.$$set=b=>{"apiBase"in b&&t(12,n=b.apiBase)},[o,i,c,u,m,v,d,h,g,w,C,M,n]}class bs extends Te{constructor(e){super(),Le(this,e,_s,vs,Fe,{apiBase:12})}}function el(l,e,t){const n=l.slice();return n[63]=e[t],n}function tl(l,e,t){const n=l.slice();return n[63]=e[t],n}function ll(l,e,t){const n=l.slice();return n[63]=e[t],n}function nl(l,e,t){const n=l.slice();return n[63]=e[t],n}function sl(l,e,t){const n=l.slice();return n[60]=e[t],n}function ol(l,e,t){const n=l.slice();return n[63]=e[t],n}function il(l){let e,t,n,s,o,i,c,u,m,v,d,h,g,p,k,w,C,M,b,y,G,F,z,I,H,D,B,R,L,Q,P,ee,q,ae,W,me,we;function de(N,Y){if(N[4]==="gallery")return Cs;if(N[4]==="cli")return ys;if(N[4]==="generation")return ws;if(N[4]==="models")return ks}let _e=de(l),fe=_e&&_e(l),E=l[5]&&yl(l);return{c(){e=f("div"),t=f("div"),n=f("div"),s=f("h2"),s.textContent="Settings",o=_(),i=f("button"),i.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"></path></svg>',c=_(),u=f("div"),m=f("button"),v=O("Gallery"),h=_(),g=f("button"),p=O("CLI"),w=_(),C=f("button"),M=O("Generation"),y=_(),G=f("button"),F=O("Models"),I=_(),H=f("div"),fe&&fe.c(),D=_(),B=f("div"),R=f("button"),R.textContent="Reset to Defaults",L=_(),Q=f("div"),P=f("button"),P.textContent="Cancel",ee=_(),q=f("button"),ae=O("Save"),W=_(),E&&E.c(),a(s,"id","settings-title"),a(s,"class","svelte-1msrv69"),a(i,"class","close-btn svelte-1msrv69"),a(i,"aria-label","Close settings"),a(n,"class","settings-header svelte-1msrv69"),a(m,"role","tab"),a(m,"aria-selected",d=l[4]==="gallery"),a(m,"class","svelte-1msrv69"),ce(m,"active",l[4]==="gallery"),a(g,"role","tab"),a(g,"aria-selected",k=l[4]==="cli"),a(g,"class","svelte-1msrv69"),ce(g,"active",l[4]==="cli"),a(C,"role","tab"),a(C,"aria-selected",b=l[4]==="generation"),a(C,"class","svelte-1msrv69"),ce(C,"active",l[4]==="generation"),a(G,"role","tab"),a(G,"aria-selected",z=l[4]==="models"),a(G,"class","svelte-1msrv69"),ce(G,"active",l[4]==="models"),a(u,"class","tabs svelte-1msrv69"),a(u,"role","tablist"),a(H,"class","tab-content svelte-1msrv69"),a(R,"class","btn btn-secondary svelte-1msrv69"),a(P,"class","btn btn-ghost svelte-1msrv69"),a(q,"class","btn btn-primary svelte-1msrv69"),q.disabled=l[16],a(Q,"class","footer-right svelte-1msrv69"),a(B,"class","settings-footer svelte-1msrv69"),a(t,"class","settings-dialog svelte-1msrv69"),a(t,"data-testid","settings-content"),a(e,"class","settings-overlay svelte-1msrv69"),a(e,"role","dialog"),a(e,"aria-modal","true"),a(e,"aria-labelledby","settings-title"),a(e,"data-testid","settings-overlay")},m(N,Y){A(N,e,Y),r(e,t),r(t,n),r(n,s),r(n,o),r(n,i),r(t,c),r(t,u),r(u,m),r(m,v),r(u,h),r(u,g),r(g,p),r(u,w),r(u,C),r(C,M),r(u,y),r(u,G),r(G,F),r(t,I),r(t,H),fe&&fe.m(H,null),r(t,D),r(t,B),r(B,R),r(B,L),r(B,Q),r(Q,P),r(Q,ee),r(Q,q),r(q,ae),r(t,W),E&&E.m(t,null),me||(we=[U(i,"click",function(){et(l[1])&&l[1].apply(this,arguments)}),U(m,"click",l[37]),U(g,"click",l[38]),U(C,"click",l[39]),U(G,"click",l[40]),U(R,"click",l[28]),U(P,"click",l[27]),U(q,"click",l[26]),U(t,"click",Tl(l[36])),U(e,"click",l[32]),U(e,"keydown",l[31])],me=!0)},p(N,Y){l=N,Y[0]&16&&d!==(d=l[4]==="gallery")&&a(m,"aria-selected",d),Y[0]&16&&ce(m,"active",l[4]==="gallery"),Y[0]&16&&k!==(k=l[4]==="cli")&&a(g,"aria-selected",k),Y[0]&16&&ce(g,"active",l[4]==="cli"),Y[0]&16&&b!==(b=l[4]==="generation")&&a(C,"aria-selected",b),Y[0]&16&&ce(C,"active",l[4]==="generation"),Y[0]&16&&z!==(z=l[4]==="models")&&a(G,"aria-selected",z),Y[0]&16&&ce(G,"active",l[4]==="models"),_e===(_e=de(l))&&fe?fe.p(l,Y):(fe&&fe.d(1),fe=_e&&_e(l),fe&&(fe.c(),fe.m(H,null))),Y[0]&65536&&(q.disabled=l[16]),l[5]?E?E.p(l,Y):(E=yl(l),E.c(),E.m(t,null)):E&&(E.d(1),E=null)},d(N){N&&j(e),fe&&fe.d(),E&&E.d(),me=!1,ke(we)}}}function ks(l){let e,t,n,s,o,i,c,u,m,v,d=Xe(l[6]),h,g=xe(l[6]),p,k,w,C,M,b,y,G,F,z,I=Xe(l[9]),H,D=xe(l[9]),B,R,L,Q,P=l[12]?"Testing...":"Test Connection",ee,q,ae,W=l[14]?"Reloading...":"Reload Models",me,we,de,_e,fe,E,N,Y,se=ne(l[21]),le=[];for(let S=0;S<se.length;S+=1)le[S]=rl(tl(l,se,S));let ue=d&&al(l),oe=g&&cl(l),V=ne(l[22]),re=[];for(let S=0;S<V.length;S+=1)re[S]=ul(el(l,V,S));let ge=I&&fl(l),T=D&&dl(l),Z=l[13]&&pl(l),J=l[15]&&ml(l);return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Image Model",s=_(),o=f("div"),i=f("div"),c=f("label"),c.textContent="Mode",u=_(),m=f("select");for(let S=0;S<le.length;S+=1)le[S].c();v=_(),ue&&ue.c(),h=_(),oe&&oe.c(),p=_(),k=f("div"),w=f("h3"),w.textContent="LLM Model",C=_(),M=f("div"),b=f("div"),y=f("label"),y.textContent="Mode",G=_(),F=f("select");for(let S=0;S<re.length;S+=1)re[S].c();z=_(),ge&&ge.c(),H=_(),T&&T.c(),B=_(),R=f("div"),L=f("div"),Q=f("button"),ee=O(P),q=_(),ae=f("button"),me=O(W),de=_(),Z&&Z.c(),_e=_(),J&&J.c(),fe=_(),E=f("p"),E.textContent=`üí° Changes override your .env configuration for this session only.
                They are stored in localStorage and do NOT modify your .env file.`,a(n,"class","svelte-1msrv69"),a(c,"for","image-mode"),a(c,"class","svelte-1msrv69"),a(m,"id","image-mode"),a(m,"data-testid","image-mode-select"),a(m,"class","svelte-1msrv69"),l[6]===void 0&&We(()=>l[53].call(m)),a(i,"class","input-row svelte-1msrv69"),a(o,"class","model-config svelte-1msrv69"),a(t,"class","setting-group svelte-1msrv69"),a(w,"class","svelte-1msrv69"),a(y,"for","llm-mode"),a(y,"class","svelte-1msrv69"),a(F,"id","llm-mode"),a(F,"data-testid","llm-mode-select"),a(F,"class","svelte-1msrv69"),l[9]===void 0&&We(()=>l[56].call(F)),a(b,"class","input-row svelte-1msrv69"),a(M,"class","model-config svelte-1msrv69"),a(k,"class","setting-group svelte-1msrv69"),a(Q,"class","btn btn-secondary svelte-1msrv69"),Q.disabled=l[12],a(ae,"class","btn btn-primary svelte-1msrv69"),ae.disabled=we=l[14]||!l[13]?.valid,a(L,"class","action-buttons svelte-1msrv69"),a(E,"class","model-hint svelte-1msrv69"),a(R,"class","setting-group model-actions svelte-1msrv69"),a(e,"class","tab-panel svelte-1msrv69"),a(e,"role","tabpanel")},m(S,x){A(S,e,x),r(e,t),r(t,n),r(t,s),r(t,o),r(o,i),r(i,c),r(i,u),r(i,m);for(let $=0;$<le.length;$+=1)le[$]&&le[$].m(m,null);Ne(m,l[6],!0),r(o,v),ue&&ue.m(o,null),r(o,h),oe&&oe.m(o,null),r(e,p),r(e,k),r(k,w),r(k,C),r(k,M),r(M,b),r(b,y),r(b,G),r(b,F);for(let $=0;$<re.length;$+=1)re[$]&&re[$].m(F,null);Ne(F,l[9],!0),r(M,z),ge&&ge.m(M,null),r(M,H),T&&T.m(M,null),r(e,B),r(e,R),r(R,L),r(L,Q),r(Q,ee),r(L,q),r(L,ae),r(ae,me),r(R,de),Z&&Z.m(R,null),r(R,_e),J&&J.m(R,null),r(R,fe),r(R,E),N||(Y=[U(m,"change",l[53]),U(F,"change",l[56]),U(Q,"click",l[33]),U(ae,"click",l[34])],N=!0)},p(S,x){if(x[0]&2097152){se=ne(S[21]);let $;for($=0;$<se.length;$+=1){const Pe=tl(S,se,$);le[$]?le[$].p(Pe,x):(le[$]=rl(Pe),le[$].c(),le[$].m(m,null))}for(;$<le.length;$+=1)le[$].d(1);le.length=se.length}if(x[0]&2097216&&Ne(m,S[6]),x[0]&64&&(d=Xe(S[6])),d?ue?ue.p(S,x):(ue=al(S),ue.c(),ue.m(o,h)):ue&&(ue.d(1),ue=null),x[0]&64&&(g=xe(S[6])),g?oe?oe.p(S,x):(oe=cl(S),oe.c(),oe.m(o,null)):oe&&(oe.d(1),oe=null),x[0]&4194304){V=ne(S[22]);let $;for($=0;$<V.length;$+=1){const Pe=el(S,V,$);re[$]?re[$].p(Pe,x):(re[$]=ul(Pe),re[$].c(),re[$].m(F,null))}for(;$<re.length;$+=1)re[$].d(1);re.length=V.length}x[0]&4194816&&Ne(F,S[9]),x[0]&512&&(I=Xe(S[9])),I?ge?ge.p(S,x):(ge=fl(S),ge.c(),ge.m(M,H)):ge&&(ge.d(1),ge=null),x[0]&512&&(D=xe(S[9])),D?T?T.p(S,x):(T=dl(S),T.c(),T.m(M,null)):T&&(T.d(1),T=null),x[0]&4096&&P!==(P=S[12]?"Testing...":"Test Connection")&&X(ee,P),x[0]&4096&&(Q.disabled=S[12]),x[0]&16384&&W!==(W=S[14]?"Reloading...":"Reload Models")&&X(me,W),x[0]&24576&&we!==(we=S[14]||!S[13]?.valid)&&(ae.disabled=we),S[13]?Z?Z.p(S,x):(Z=pl(S),Z.c(),Z.m(R,_e)):Z&&(Z.d(1),Z=null),S[15]?J?J.p(S,x):(J=ml(S),J.c(),J.m(R,fe)):J&&(J.d(1),J=null)},d(S){S&&j(e),he(le,S),ue&&ue.d(),oe&&oe.d(),he(re,S),ge&&ge.d(),T&&T.d(),Z&&Z.d(),J&&J.d(),N=!1,ke(Y)}}}function ws(l){let e,t,n,s,o,i,c,u,m,v,d,h,g,p,k,w,C,M,b,y,G,F,z,I,H,D,B,R,L,Q;return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Default Dimensions",s=_(),o=f("div"),i=f("div"),c=f("label"),c.textContent="Default Width",u=_(),m=f("input"),v=_(),d=f("span"),d.textContent="√ó",h=_(),g=f("div"),p=f("label"),p.textContent="Default Height",k=_(),w=f("input"),C=_(),M=f("div"),b=f("div"),y=f("label"),y.textContent="Default Count",G=_(),F=f("input"),z=_(),I=f("div"),H=f("label"),D=f("input"),B=_(),R=f("span"),R.textContent="Auto-enhance prompts with LLM",a(n,"class","svelte-1msrv69"),a(c,"for","default-width"),a(c,"class","svelte-1msrv69"),a(m,"id","default-width"),a(m,"type","number"),a(m,"min","256"),a(m,"max","2048"),a(m,"step","64"),a(m,"class","svelte-1msrv69"),a(i,"class","input-group svelte-1msrv69"),a(d,"class","dimension-separator svelte-1msrv69"),a(p,"for","default-height"),a(p,"class","svelte-1msrv69"),a(w,"id","default-height"),a(w,"type","number"),a(w,"min","256"),a(w,"max","2048"),a(w,"step","64"),a(w,"class","svelte-1msrv69"),a(g,"class","input-group svelte-1msrv69"),a(o,"class","dimension-inputs svelte-1msrv69"),a(t,"class","setting-group svelte-1msrv69"),a(y,"for","default-count"),a(y,"class","svelte-1msrv69"),a(F,"id","default-count"),a(F,"type","number"),a(F,"min","1"),a(F,"max","10"),a(F,"class","svelte-1msrv69"),a(b,"class","input-group svelte-1msrv69"),a(M,"class","setting-group svelte-1msrv69"),a(D,"type","checkbox"),a(D,"class","svelte-1msrv69"),a(R,"class","svelte-1msrv69"),a(H,"class","checkbox-label svelte-1msrv69"),a(I,"class","setting-group svelte-1msrv69"),a(e,"class","tab-panel svelte-1msrv69"),a(e,"role","tabpanel")},m(P,ee){A(P,e,ee),r(e,t),r(t,n),r(t,s),r(t,o),r(o,i),r(i,c),r(i,u),r(i,m),pe(m,l[2].generation.defaultWidth),r(o,v),r(o,d),r(o,h),r(o,g),r(g,p),r(g,k),r(g,w),pe(w,l[2].generation.defaultHeight),r(e,C),r(e,M),r(M,b),r(b,y),r(b,G),r(b,F),pe(F,l[2].generation.defaultCount),r(e,z),r(e,I),r(I,H),r(H,D),D.checked=l[2].generation.autoEnhance,r(H,B),r(H,R),L||(Q=[U(m,"input",l[49]),U(w,"input",l[50]),U(F,"input",l[51]),U(D,"change",l[52])],L=!0)},p(P,ee){ee[0]&4&&Ue(m.value)!==P[2].generation.defaultWidth&&pe(m,P[2].generation.defaultWidth),ee[0]&4&&Ue(w.value)!==P[2].generation.defaultHeight&&pe(w,P[2].generation.defaultHeight),ee[0]&4&&Ue(F.value)!==P[2].generation.defaultCount&&pe(F,P[2].generation.defaultCount),ee[0]&4&&(D.checked=P[2].generation.autoEnhance)},d(P){P&&j(e),L=!1,ke(Q)}}}function ys(l){let e,t,n,s,o,i,c,u,m,v,d,h,g,p,k,w,C,M,b,y,G,F,z,I,H=ne(l[20]),D=[];for(let L=0;L<H.length;L+=1)D[L]=hl(nl(l,H,L));let B=ne(l[19]),R=[];for(let L=0;L<B.length;L+=1)R[L]=vl(ll(l,B,L));return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Panel Height",s=_(),o=f("div");for(let L=0;L<D.length;L+=1)D[L].c();i=_(),c=f("div"),u=f("h3"),u.textContent="Font Size",m=_(),v=f("div");for(let L=0;L<R.length;L+=1)R[L].c();d=_(),h=f("div"),g=f("label"),p=f("input"),k=_(),w=f("span"),w.textContent="Show tips on startup",C=_(),M=f("div"),b=f("label"),y=f("input"),G=_(),F=f("span"),F.textContent="Show tutorial on startup",a(n,"class","svelte-1msrv69"),a(o,"class","radio-group svelte-1msrv69"),a(t,"class","setting-group svelte-1msrv69"),a(u,"class","svelte-1msrv69"),a(v,"class","radio-group svelte-1msrv69"),a(c,"class","setting-group svelte-1msrv69"),a(p,"type","checkbox"),a(p,"class","svelte-1msrv69"),a(w,"class","svelte-1msrv69"),a(g,"class","checkbox-label svelte-1msrv69"),a(h,"class","setting-group svelte-1msrv69"),a(y,"type","checkbox"),a(y,"class","svelte-1msrv69"),a(F,"class","svelte-1msrv69"),a(b,"class","checkbox-label svelte-1msrv69"),a(M,"class","setting-group svelte-1msrv69"),a(e,"class","tab-panel svelte-1msrv69"),a(e,"role","tabpanel")},m(L,Q){A(L,e,Q),r(e,t),r(t,n),r(t,s),r(t,o);for(let P=0;P<D.length;P+=1)D[P]&&D[P].m(o,null);r(e,i),r(e,c),r(c,u),r(c,m),r(c,v);for(let P=0;P<R.length;P+=1)R[P]&&R[P].m(v,null);r(e,d),r(e,h),r(h,g),r(g,p),p.checked=l[2].cli.showTipsOnStart,r(g,k),r(g,w),r(e,C),r(e,M),r(M,b),r(b,y),y.checked=l[2].cli.showTutorialOnStart,r(b,G),r(b,F),z||(I=[U(p,"change",l[47]),U(y,"change",l[48])],z=!0)},p(L,Q){if(Q[0]&1048580){H=ne(L[20]);let P;for(P=0;P<H.length;P+=1){const ee=nl(L,H,P);D[P]?D[P].p(ee,Q):(D[P]=hl(ee),D[P].c(),D[P].m(o,null))}for(;P<D.length;P+=1)D[P].d(1);D.length=H.length}if(Q[0]&524292){B=ne(L[19]);let P;for(P=0;P<B.length;P+=1){const ee=ll(L,B,P);R[P]?R[P].p(ee,Q):(R[P]=vl(ee),R[P].c(),R[P].m(v,null))}for(;P<R.length;P+=1)R[P].d(1);R.length=B.length}Q[0]&4&&(p.checked=L[2].cli.showTipsOnStart),Q[0]&4&&(y.checked=L[2].cli.showTutorialOnStart)},d(L){L&&j(e),he(D,L),he(R,L),z=!1,ke(I)}}}function Cs(l){let e,t,n,s,o,i,c,u,m,v,d,h,g,p,k,w,C,M,b,y,G,F,z,I,H,D,B,R=ne(l[17]),L=[];for(let q=0;q<R.length;q+=1)L[q]=_l(ol(l,R,q));let Q=ne(l[18]),P=[];for(let q=0;q<Q.length;q+=1)P[q]=bl(sl(l,Q,q));let ee=l[2].gallery.thumbnailSize==="custom"&&kl(l);return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Gallery Layout",s=_(),o=f("div");for(let q=0;q<L.length;q+=1)L[q].c();i=_(),c=f("div"),u=f("h3"),u.textContent="Thumbnail Size",m=_(),v=f("div");for(let q=0;q<P.length;q+=1)P[q].c();d=_(),ee&&ee.c(),h=_(),g=f("div"),p=f("label"),k=f("input"),w=_(),C=f("span"),C.textContent="Show prompt on hover",M=_(),b=f("div"),y=f("h3"),y.textContent="Sort Order",G=_(),F=f("select"),z=f("option"),z.textContent="Newest First",I=f("option"),I.textContent="Oldest First",H=f("option"),H.textContent="By Name",a(n,"class","svelte-1msrv69"),a(o,"class","layout-options svelte-1msrv69"),a(t,"class","setting-group svelte-1msrv69"),a(u,"class","svelte-1msrv69"),a(v,"class","radio-group svelte-1msrv69"),a(c,"class","setting-group svelte-1msrv69"),a(k,"type","checkbox"),a(k,"class","svelte-1msrv69"),a(C,"class","svelte-1msrv69"),a(p,"class","checkbox-label svelte-1msrv69"),a(g,"class","setting-group svelte-1msrv69"),a(y,"class","svelte-1msrv69"),z.__value="newest",pe(z,z.__value),I.__value="oldest",pe(I,I.__value),H.__value="name",pe(H,H.__value),a(F,"class","svelte-1msrv69"),l[2].gallery.sortOrder===void 0&&We(()=>l[44].call(F)),a(b,"class","setting-group svelte-1msrv69"),a(e,"class","tab-panel svelte-1msrv69"),a(e,"role","tabpanel")},m(q,ae){A(q,e,ae),r(e,t),r(t,n),r(t,s),r(t,o);for(let W=0;W<L.length;W+=1)L[W]&&L[W].m(o,null);r(e,i),r(e,c),r(c,u),r(c,m),r(c,v);for(let W=0;W<P.length;W+=1)P[W]&&P[W].m(v,null);r(c,d),ee&&ee.m(c,null),r(e,h),r(e,g),r(g,p),r(p,k),k.checked=l[2].gallery.showPromptOnHover,r(p,w),r(p,C),r(e,M),r(e,b),r(b,y),r(b,G),r(b,F),r(F,z),r(F,I),r(F,H),Ne(F,l[2].gallery.sortOrder,!0),D||(B=[U(k,"change",l[43]),U(F,"change",l[44])],D=!0)},p(q,ae){if(ae[0]&33685508){R=ne(q[17]);let W;for(W=0;W<R.length;W+=1){const me=ol(q,R,W);L[W]?L[W].p(me,ae):(L[W]=_l(me),L[W].c(),L[W].m(o,null))}for(;W<L.length;W+=1)L[W].d(1);L.length=R.length}if(ae[0]&8650756){Q=ne(q[18]);let W;for(W=0;W<Q.length;W+=1){const me=sl(q,Q,W);P[W]?P[W].p(me,ae):(P[W]=bl(me),P[W].c(),P[W].m(v,null))}for(;W<P.length;W+=1)P[W].d(1);P.length=Q.length}q[2].gallery.thumbnailSize==="custom"?ee?ee.p(q,ae):(ee=kl(q),ee.c(),ee.m(c,null)):ee&&(ee.d(1),ee=null),ae[0]&4&&(k.checked=q[2].gallery.showPromptOnHover),ae[0]&4&&Ne(F,q[2].gallery.sortOrder)},d(q){q&&j(e),he(L,q),he(P,q),ee&&ee.d(),D=!1,ke(B)}}}function rl(l){let e,t=l[63].label+"",n;return{c(){e=f("option"),n=O(t),e.__value=l[63].value,pe(e,e.__value)},m(s,o){A(s,e,o),r(e,n)},p:K,d(s){s&&j(e)}}}function al(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Repository",n=_(),s=f("input"),a(t,"for","image-repo"),a(t,"class","svelte-1msrv69"),a(s,"id","image-repo"),a(s,"type","text"),a(s,"data-testid","image-repo-input"),a(s,"placeholder","e.g., Tongyi-MAI/Z-Image-Turbo"),a(s,"class","svelte-1msrv69"),a(e,"class","input-row svelte-1msrv69")},m(c,u){A(c,e,u),r(e,t),r(e,n),r(e,s),pe(s,l[7]),o||(i=U(s,"input",l[54]),o=!0)},p(c,u){u[0]&128&&s.value!==c[7]&&pe(s,c[7])},d(c){c&&j(e),o=!1,i()}}}function cl(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Local Path",n=_(),s=f("input"),a(t,"for","image-path"),a(t,"class","svelte-1msrv69"),a(s,"id","image-path"),a(s,"type","text"),a(s,"data-testid","image-path-input"),a(s,"placeholder","/path/to/model"),a(s,"class","svelte-1msrv69"),a(e,"class","input-row svelte-1msrv69")},m(c,u){A(c,e,u),r(e,t),r(e,n),r(e,s),pe(s,l[8]),o||(i=U(s,"input",l[55]),o=!0)},p(c,u){u[0]&256&&s.value!==c[8]&&pe(s,c[8])},d(c){c&&j(e),o=!1,i()}}}function ul(l){let e,t=l[63].label+"",n;return{c(){e=f("option"),n=O(t),e.__value=l[63].value,pe(e,e.__value)},m(s,o){A(s,e,o),r(e,n)},p:K,d(s){s&&j(e)}}}function fl(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Repository",n=_(),s=f("input"),a(t,"for","llm-repo"),a(t,"class","svelte-1msrv69"),a(s,"id","llm-repo"),a(s,"type","text"),a(s,"data-testid","llm-repo-input"),a(s,"placeholder","e.g., unsloth/Qwen3-4B-Instruct-2507-bnb-4bit"),a(s,"class","svelte-1msrv69"),a(e,"class","input-row svelte-1msrv69")},m(c,u){A(c,e,u),r(e,t),r(e,n),r(e,s),pe(s,l[10]),o||(i=U(s,"input",l[57]),o=!0)},p(c,u){u[0]&1024&&s.value!==c[10]&&pe(s,c[10])},d(c){c&&j(e),o=!1,i()}}}function dl(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Local Path",n=_(),s=f("input"),a(t,"for","llm-path"),a(t,"class","svelte-1msrv69"),a(s,"id","llm-path"),a(s,"type","text"),a(s,"data-testid","llm-path-input"),a(s,"placeholder","/path/to/llm"),a(s,"class","svelte-1msrv69"),a(e,"class","input-row svelte-1msrv69")},m(c,u){A(c,e,u),r(e,t),r(e,n),r(e,s),pe(s,l[11]),o||(i=U(s,"input",l[58]),o=!0)},p(c,u){u[0]&2048&&s.value!==c[11]&&pe(s,c[11])},d(c){c&&j(e),o=!1,i()}}}function pl(l){let e,t=l[13].valid?"‚úì":"‚úó",n,s,o=l[13].message+"",i;return{c(){e=f("div"),n=O(t),s=_(),i=O(o),a(e,"class","result-message svelte-1msrv69"),ce(e,"success",l[13].valid),ce(e,"error",!l[13].valid)},m(c,u){A(c,e,u),r(e,n),r(e,s),r(e,i)},p(c,u){u[0]&8192&&t!==(t=c[13].valid?"‚úì":"‚úó")&&X(n,t),u[0]&8192&&o!==(o=c[13].message+"")&&X(i,o),u[0]&8192&&ce(e,"success",c[13].valid),u[0]&8192&&ce(e,"error",!c[13].valid)},d(c){c&&j(e)}}}function ml(l){let e,t=l[15].status==="ok"?"‚úì Models reloaded!":`‚úó ${l[15].message}`,n,s,o=l[15].status==="ok"&&l[15].duration_ms&&gl(l);return{c(){e=f("div"),n=O(t),s=_(),o&&o.c(),a(e,"class","result-message svelte-1msrv69"),ce(e,"success",l[15].status==="ok"),ce(e,"error",l[15].status!=="ok")},m(i,c){A(i,e,c),r(e,n),r(e,s),o&&o.m(e,null)},p(i,c){c[0]&32768&&t!==(t=i[15].status==="ok"?"‚úì Models reloaded!":`‚úó ${i[15].message}`)&&X(n,t),i[15].status==="ok"&&i[15].duration_ms?o?o.p(i,c):(o=gl(i),o.c(),o.m(e,null)):o&&(o.d(1),o=null),c[0]&32768&&ce(e,"success",i[15].status==="ok"),c[0]&32768&&ce(e,"error",i[15].status!=="ok")},d(i){i&&j(e),o&&o.d()}}}function gl(l){let e,t,n=l[15].duration_ms+"",s,o;return{c(){e=f("span"),t=O("("),s=O(n),o=O("ms)"),a(e,"class","duration svelte-1msrv69")},m(i,c){A(i,e,c),r(e,t),r(e,s),r(e,o)},p(i,c){c[0]&32768&&n!==(n=i[15].duration_ms+"")&&X(s,n)},d(i){i&&j(e)}}}function hl(l){let e,t,n,s,o,i,c,u;function m(){return l[45](l[63])}return{c(){e=f("label"),t=f("input"),s=_(),o=f("span"),o.textContent=`${l[63].label}`,i=_(),a(t,"type","radio"),a(t,"name","cliHeight"),t.value=l[63].value,t.checked=n=l[2].cli.height===l[63].value,a(t,"class","svelte-1msrv69"),a(o,"class","radio-text svelte-1msrv69"),a(e,"class","radio-label svelte-1msrv69")},m(v,d){A(v,e,d),r(e,t),r(e,s),r(e,o),r(e,i),c||(u=U(t,"change",m),c=!0)},p(v,d){l=v,d[0]&4&&n!==(n=l[2].cli.height===l[63].value)&&(t.checked=n)},d(v){v&&j(e),c=!1,u()}}}function vl(l){let e,t,n,s,o,i,c,u;function m(){return l[46](l[63])}return{c(){e=f("label"),t=f("input"),s=_(),o=f("span"),o.textContent=`${l[63].label}`,i=_(),a(t,"type","radio"),a(t,"name","fontSize"),t.value=l[63].value,t.checked=n=l[2].cli.fontSize===l[63].value,a(t,"class","svelte-1msrv69"),a(o,"class","radio-text svelte-1msrv69"),a(e,"class","radio-label svelte-1msrv69")},m(v,d){A(v,e,d),r(e,t),r(e,s),r(e,o),r(e,i),c||(u=U(t,"change",m),c=!0)},p(v,d){l=v,d[0]&4&&n!==(n=l[2].cli.fontSize===l[63].value)&&(t.checked=n)},d(v){v&&j(e),c=!1,u()}}}function _l(l){let e,t,n,s,o,i,c;function u(){return l[41](l[63])}return{c(){e=f("button"),t=f("span"),t.textContent=`${l[63].icon}`,n=_(),s=f("span"),s.textContent=`${l[63].label}`,o=_(),a(t,"class","layout-icon svelte-1msrv69"),a(s,"class","layout-label svelte-1msrv69"),a(e,"class","layout-option svelte-1msrv69"),a(e,"data-testid","layout-"+l[63].value),ce(e,"selected",l[2].gallery.layout===l[63].value)},m(m,v){A(m,e,v),r(e,t),r(e,n),r(e,s),r(e,o),i||(c=U(e,"click",u),i=!0)},p(m,v){l=m,v[0]&131076&&ce(e,"selected",l[2].gallery.layout===l[63].value)},d(m){m&&j(e),i=!1,c()}}}function Ss(l){let e;return{c(){e=f("span"),e.textContent=`${l[60].height}px`,a(e,"class","radio-hint svelte-1msrv69")},m(t,n){A(t,e,n)},p:K,d(t){t&&j(e)}}}function bl(l){let e,t,n,s,o,i,c,u,m;function v(){return l[42](l[60])}let d=l[60].value!=="custom"&&Ss(l);return{c(){e=f("label"),t=f("input"),s=_(),o=f("span"),o.textContent=`${l[60].label}`,i=_(),d&&d.c(),c=_(),a(t,"type","radio"),a(t,"name","thumbnailSize"),t.value=l[60].value,t.checked=n=l[2].gallery.thumbnailSize===l[60].value,a(t,"class","svelte-1msrv69"),a(o,"class","radio-text svelte-1msrv69"),a(e,"class","radio-label svelte-1msrv69")},m(h,g){A(h,e,g),r(e,t),r(e,s),r(e,o),r(e,i),d&&d.m(e,null),r(e,c),u||(m=U(t,"change",v),u=!0)},p(h,g){l=h,g[0]&4&&n!==(n=l[2].gallery.thumbnailSize===l[60].value)&&(t.checked=n),l[60].value!=="custom"&&d.p(l,g)},d(h){h&&j(e),d&&d.d(),u=!1,m()}}}function kl(l){let e,t,n,s,o,i,c,u,m=l[3]&&wl(l);return{c(){e=f("div"),t=f("label"),t.textContent="Custom Height (px)",n=_(),s=f("input"),i=_(),m&&m.c(),a(t,"for","custom-thumbnail"),a(t,"class","svelte-1msrv69"),a(s,"id","custom-thumbnail"),a(s,"type","number"),a(s,"min","80"),a(s,"max","500"),s.value=o=l[2].gallery.thumbnailHeight,a(s,"data-testid","custom-thumbnail-input"),a(s,"class","svelte-1msrv69"),a(e,"class","custom-input-group svelte-1msrv69")},m(v,d){A(v,e,d),r(e,t),r(e,n),r(e,s),r(e,i),m&&m.m(e,null),c||(u=U(s,"input",l[24]),c=!0)},p(v,d){d[0]&4&&o!==(o=v[2].gallery.thumbnailHeight)&&s.value!==o&&(s.value=o),v[3]?m?m.p(v,d):(m=wl(v),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(v){v&&j(e),m&&m.d(),c=!1,u()}}}function wl(l){let e,t;return{c(){e=f("span"),t=O(l[3]),a(e,"class","error-text svelte-1msrv69")},m(n,s){A(n,e,s),r(e,t)},p(n,s){s[0]&8&&X(t,n[3])},d(n){n&&j(e)}}}function yl(l){let e,t,n,s,o,i,c,u,m,v,d,h;return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Reset Settings?",s=_(),o=f("p"),o.textContent="Are you sure you want to reset all settings to their default values? This cannot be undone.",i=_(),c=f("div"),u=f("button"),u.textContent="Cancel",m=_(),v=f("button"),v.textContent="Confirm",a(n,"class","svelte-1msrv69"),a(o,"class","svelte-1msrv69"),a(u,"class","btn btn-ghost svelte-1msrv69"),a(v,"class","btn btn-danger svelte-1msrv69"),a(c,"class","confirm-actions svelte-1msrv69"),a(t,"class","confirm-dialog svelte-1msrv69"),a(e,"class","confirm-overlay svelte-1msrv69")},m(g,p){A(g,e,p),r(e,t),r(t,n),r(t,s),r(t,o),r(t,i),r(t,c),r(c,u),r(c,m),r(c,v),d||(h=[U(u,"click",l[30]),U(v,"click",l[29])],d=!0)},p:K,d(g){g&&j(e),d=!1,ke(h)}}}function Fs(l){let e,t=l[0]&&il(l);return{c(){t&&t.c(),e=tt()},m(n,s){t&&t.m(n,s),A(n,e,s)},p(n,s){n[0]?t?t.p(n,s):(t=il(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:K,o:K,d(n){n&&j(e),t&&t.d(n)}}}function Xe(l){return l==="hf_download"||l==="sdnq"}function xe(l){return l==="hf_local"||l==="components"||l==="gguf"}function Es(l,e,t){let n,s;Ae(l,Me,te=>t(35,s=te));let{open:o=!1}=e,{onClose:i}=e,c="gallery",u=structuredClone(Oe),m="",v=!1;const d=[{value:"flex-row",label:"Flex Row",icon:"‚ïê"},{value:"masonry-vertical",label:"Masonry Vertical",icon:"‚ñì"},{value:"masonry-horizontal",label:"Masonry Horizontal",icon:"‚ñí"},{value:"grid-square",label:"Grid Square",icon:"‚ñ¶"},{value:"grid-auto",label:"Grid Auto",icon:"‚ñ§"}],h=[{value:"small",label:"Small",height:120},{value:"medium",label:"Medium",height:180},{value:"large",label:"Large",height:250},{value:"xlarge",label:"X-Large",height:350},{value:"custom",label:"Custom",height:0}],g=[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}],p=[{value:250,label:"Compact (250px)"},{value:350,label:"Small (350px)"},{value:420,label:"Medium (420px)"},{value:500,label:"Large (500px)"},{value:600,label:"Maximum (600px)"}],k=[{value:"hf_download",label:"HuggingFace Download"},{value:"hf_local",label:"Local HF Clone"},{value:"sdnq",label:"SDNQ Quantized"},{value:"components",label:"Components"}],w=[{value:"hf_download",label:"HuggingFace Download"},{value:"hf_local",label:"Local HF Clone"},{value:"gguf",label:"GGUF File"},{value:"z_image",label:"Z-Image Encoder"}];let C="hf_download",M="",b="",y="hf_download",G="",F="",z=!1,I=null,H=!1,D=null;function B(te){Rl(te)?t(3,m=""):t(3,m="Must be between 80 and 500 pixels")}function R(te){const Ee=h.find(Ge=>Ge.value===te),Re=te!=="custom"&&Ee?Ee.height:u.gallery.thumbnailHeight;te!=="custom"&&t(3,m=""),t(2,u={...u,gallery:{...u.gallery,thumbnailSize:te,thumbnailHeight:Re}})}function L(te){const Ee=te.target,Re=parseInt(Ee.value,10);B(Re),t(2,u={...u,gallery:{...u.gallery,thumbnailHeight:Re}})}function Q(te){t(2,u={...u,gallery:{...u.gallery,layout:te}})}function P(){n||(un(u.gallery),zl(u.cli),fn(u.generation),i())}function ee(){i()}function q(){t(5,v=!0)}function ae(){dn(),t(2,u=structuredClone(Oe)),t(5,v=!1),t(3,m="")}function W(){t(5,v=!1)}function me(te){te.key==="Escape"&&(v?W():i())}function we(te){te.target===te.currentTarget&&i()}async function de(){t(12,z=!0),t(13,I=null),t(15,D=null);try{const Ee=await(await fetch("/api/settings/models/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_type:"image",mode:C,repo:M||null,path:b||null})})).json();if(!Ee.valid){t(13,I={valid:!1,message:`Image: ${Ee.message}`});return}const Ge=await(await fetch("/api/settings/models/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_type:"llm",mode:y,repo:G||null,path:F||null})})).json();if(!Ge.valid){t(13,I={valid:!1,message:`LLM: ${Ge.message}`});return}t(13,I={valid:!0,message:"Configuration valid!"})}catch(te){t(13,I={valid:!1,message:`Connection error: ${te}`})}finally{t(12,z=!1)}}async function _e(){t(14,H=!0),t(15,D=null);try{const Ee=await(await fetch("/api/settings/models",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_mode:C,image_repo:M||null,image_path:b||null,llm_mode:y,llm_repo:G||null,llm_path:F||null})})).json();if(Ee.status!=="ok"){t(15,D={status:"error",message:Ee.message});return}const Ge=await(await fetch("/api/models/reload",{method:"POST",headers:{"Content-Type":"application/json"}})).json();t(15,D=Ge),Ge.status==="ok"&&t(2,u.models={imageMode:C,imageRepo:M,imagePath:b,llmMode:y,llmRepo:G,llmPath:F},u)}catch(te){t(15,D={status:"error",message:`Error: ${te}`})}finally{t(14,H=!1)}}function fe(te){Il.call(this,l,te)}const E=()=>t(4,c="gallery"),N=()=>t(4,c="cli"),Y=()=>t(4,c="generation"),se=()=>t(4,c="models"),le=te=>Q(te.value),ue=te=>R(te.value);function oe(){u.gallery.showPromptOnHover=this.checked,t(2,u),t(0,o),t(35,s)}function V(){u.gallery.sortOrder=lt(this),t(2,u),t(0,o),t(35,s)}const re=te=>{t(2,u.cli.height=te.value,u)},ge=te=>{t(2,u.cli.fontSize=te.value,u)};function T(){u.cli.showTipsOnStart=this.checked,t(2,u),t(0,o),t(35,s)}function Z(){u.cli.showTutorialOnStart=this.checked,t(2,u),t(0,o),t(35,s)}function J(){u.generation.defaultWidth=Ue(this.value),t(2,u),t(0,o),t(35,s)}function S(){u.generation.defaultHeight=Ue(this.value),t(2,u),t(0,o),t(35,s)}function x(){u.generation.defaultCount=Ue(this.value),t(2,u),t(0,o),t(35,s)}function $(){u.generation.autoEnhance=this.checked,t(2,u),t(0,o),t(35,s)}function Pe(){C=lt(this),t(6,C),t(0,o),t(35,s),t(2,u),t(21,k)}function Nl(){M=this.value,t(7,M),t(0,o),t(35,s),t(2,u)}function Ul(){b=this.value,t(8,b),t(0,o),t(35,s),t(2,u)}function Vl(){y=lt(this),t(9,y),t(0,o),t(35,s),t(2,u),t(22,w)}function ql(){G=this.value,t(10,G),t(0,o),t(35,s),t(2,u)}function Wl(){F=this.value,t(11,F),t(0,o),t(35,s),t(2,u)}return l.$$set=te=>{"open"in te&&t(0,o=te.open),"onClose"in te&&t(1,i=te.onClose)},l.$$.update=()=>{l.$$.dirty[0]&5|l.$$.dirty[1]&16&&o&&(t(2,u=structuredClone(s)),t(4,c="gallery"),t(3,m=""),t(5,v=!1),t(13,I=null),t(15,D=null),t(6,C=u.models.imageMode||"hf_download"),t(7,M=u.models.imageRepo||""),t(8,b=u.models.imagePath||""),t(9,y=u.models.llmMode||"hf_download"),t(10,G=u.models.llmRepo||""),t(11,F=u.models.llmPath||"")),l.$$.dirty[0]&8&&t(16,n=m!=="")},[o,i,u,m,c,v,C,M,b,y,G,F,z,I,H,D,n,d,h,g,p,k,w,R,L,Q,P,ee,q,ae,W,me,we,de,_e,s,fe,E,N,Y,se,le,ue,oe,V,re,ge,T,Z,J,S,x,$,Pe,Nl,Ul,Vl,ql,Wl]}class js extends Te{constructor(e){super(),Le(this,e,Es,Fs,Fe,{open:0,onClose:1},null,[-1,-1,-1])}}function As(l){let e,t,n,s,o,i,c,u,m,v,d,h,g,p,k,w=l[8]&&Cl(l);s=new Jn({props:{images:l[2],isGenerating:l[3],progress:l[4],onOpenSettings:l[14]}}),s.$on("select",l[22]);let C=l[5]&&Sl(l),M={isGenerating:l[3],isTauriAvailable:l[6]||l[7],getGpuInfo:l[19],unloadModels:l[20],listVariables:l[21],openSettings:l[14]};return v=new as({props:M}),l[27](v),v.$on("generate",l[18]),h=new js({props:{open:l[11],onClose:l[15]}}),{c(){e=f("main"),w&&w.c(),t=_(),n=f("div"),je(s.$$.fragment),o=_(),C&&C.c(),i=_(),c=f("div"),c.innerHTML='<div class="handle-line svelte-6jb8a2"></div>',u=_(),m=f("div"),je(v.$$.fragment),d=_(),je(h.$$.fragment),a(n,"class","gallery-container svelte-6jb8a2"),a(c,"class","resize-handle svelte-6jb8a2"),a(m,"class","cli-container svelte-6jb8a2"),ie(m,"height",l[0]+"px"),ie(m,"flex","none"),a(e,"class","app svelte-6jb8a2"),ce(e,"resizing",l[1])},m(b,y){A(b,e,y),w&&w.m(e,null),r(e,t),r(e,n),Ce(s,n,null),r(n,o),C&&C.m(n,null),r(e,i),r(e,c),r(e,u),r(e,m),Ce(v,m,null),r(e,d),Ce(h,e,null),g=!0,p||(k=U(c,"mousedown",l[17]),p=!0)},p(b,y){b[8]?w?w.p(b,y):(w=Cl(b),w.c(),w.m(e,t)):w&&(w.d(1),w=null);const G={};y[0]&4&&(G.images=b[2]),y[0]&8&&(G.isGenerating=b[3]),y[0]&16&&(G.progress=b[4]),s.$set(G),b[5]?C?C.p(b,y):(C=Sl(b),C.c(),C.m(n,null)):C&&(C.d(1),C=null);const F={};y[0]&8&&(F.isGenerating=b[3]),y[0]&192&&(F.isTauriAvailable=b[6]||b[7]),v.$set(F),(!g||y[0]&1)&&ie(m,"height",b[0]+"px");const z={};y[0]&2048&&(z.open=b[11]),h.$set(z),(!g||y[0]&2)&&ce(e,"resizing",b[1])},i(b){g||(ve(s.$$.fragment,b),ve(v.$$.fragment,b),ve(h.$$.fragment,b),g=!0)},o(b){be(s.$$.fragment,b),be(v.$$.fragment,b),be(h.$$.fragment,b),g=!1},d(b){b&&j(e),w&&w.d(),Se(s),C&&C.d(),l[27](null),Se(v),Se(h),p=!1,k()}}}function Ls(l){let e,t;return e=new bs({props:{apiBase:l[13]}}),e.$on("complete",l[16]),{c(){je(e.$$.fragment)},m(n,s){Ce(e,n,s),t=!0},p:K,i(n){t||(ve(e.$$.fragment,n),t=!0)},o(n){be(e.$$.fragment,n),t=!1},d(n){Se(e,n)}}}function Ts(l){let e;return{c(){e=f("div"),e.innerHTML='<div class="loading-spinner svelte-6jb8a2"></div> <p class="svelte-6jb8a2">Connecting to server...</p>',a(e,"class","loading-screen svelte-6jb8a2")},m(t,n){A(t,e,n)},p:K,i:K,o:K,d(t){t&&j(e)}}}function Cl(l){let e,t;return{c(){e=f("div"),t=O(l[8]),a(e,"class","status-bar svelte-6jb8a2")},m(n,s){A(n,e,s),r(e,t)},p(n,s){s[0]&256&&X(t,n[8])},d(n){n&&j(e)}}}function Sl(l){let e,t,n,s,o,i,c,u,m,v,d=l[3]&&Fl(l),h=l[5].prompt&&jl(l);return{c(){e=f("div"),d&&d.c(),t=_(),n=f("div"),s=f("img"),i=_(),h&&h.c(),c=_(),u=f("button"),u.textContent="√ó",ye(s.src,o=l[5].url)||a(s,"src",o),a(s,"alt","Preview"),a(s,"class","preview-image svelte-6jb8a2"),a(n,"class","preview-content svelte-6jb8a2"),a(u,"class","close-btn svelte-6jb8a2"),a(e,"class","preview-overlay svelte-6jb8a2"),a(e,"role","dialog"),a(e,"aria-modal","true")},m(g,p){A(g,e,p),d&&d.m(e,null),r(e,t),r(e,n),r(n,s),r(n,i),h&&h.m(n,null),r(e,c),r(e,u),m||(v=[U(n,"click",Tl(l[25])),U(u,"click",l[23]),U(e,"click",l[23]),U(e,"keydown",l[26])],m=!0)},p(g,p){g[3]?d?d.p(g,p):(d=Fl(g),d.c(),d.m(e,t)):d&&(d.d(1),d=null),p[0]&32&&!ye(s.src,o=g[5].url)&&a(s,"src",o),g[5].prompt?h?h.p(g,p):(h=jl(g),h.c(),h.m(n,null)):h&&(h.d(1),h=null)},d(g){g&&j(e),d&&d.d(),h&&h.d(),m=!1,ke(v)}}}function Fl(l){let e,t,n,s,o,i=l[4]>0&&El(l);return{c(){e=f("div"),t=f("span"),n=_(),s=f("span"),s.textContent="Generating...",o=_(),i&&i.c(),a(t,"class","pulse svelte-6jb8a2"),a(e,"class","preview-generating svelte-6jb8a2")},m(c,u){A(c,e,u),r(e,t),r(e,n),r(e,s),r(e,o),i&&i.m(e,null)},p(c,u){c[4]>0?i?i.p(c,u):(i=El(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(c){c&&j(e),i&&i.d()}}}function El(l){let e,t;return{c(){e=f("div"),t=f("div"),a(t,"class","preview-progress-fill svelte-6jb8a2"),ie(t,"width",l[4]+"%"),a(e,"class","preview-progress svelte-6jb8a2")},m(n,s){A(n,e,s),r(e,t)},p(n,s){s[0]&16&&ie(t,"width",n[4]+"%")},d(n){n&&j(e)}}}function jl(l){let e,t,n,s,o=l[5].prompt+"",i;return{c(){e=f("div"),t=f("span"),t.textContent="üìú Prompt",n=_(),s=f("p"),i=O(o),a(t,"class","prompt-label svelte-6jb8a2"),a(s,"class","prompt-text svelte-6jb8a2"),a(e,"class","preview-prompt svelte-6jb8a2")},m(c,u){A(c,e,u),r(e,t),r(e,n),r(e,s),r(s,i)},p(c,u){u[0]&32&&o!==(o=c[5].prompt+"")&&X(i,o)},d(c){c&&j(e)}}}function Ms(l){let e,t,n,s;const o=[Ts,Ls,As],i=[];function c(u,m){return u[10]?0:u[9]&&u[7]?1:2}return e=c(l),t=i[e]=o[e](l),{c(){t.c(),n=tt()},m(u,m){i[e].m(u,m),A(u,n,m),s=!0},p(u,m){let v=e;e=c(u),e===v?i[e].p(u,m):(at(),be(i[v],1,1,()=>{i[v]=null}),ct(),t=i[e],t?t.p(u,m):(t=i[e]=o[e](u),t.c()),ve(t,1),t.m(n.parentNode,n))},i(u){s||(ve(t),s=!0)},o(u){be(t),s=!1},d(u){u&&j(n),i[e].d(u)}}}let Is=150,Ps=600;function Gs(){if(typeof window<"u"){const{protocol:l,hostname:e,port:t}=window.location;return t==="5173"?"":`${l}//${e}${t?":"+t:""}`}return"http://127.0.0.1:8345"}function Hs(l,e,t){let n;Ae(l,Me,E=>t(24,n=E));const s=Gs();let o=[],i=!1,c=0,u=null,m=!1,v=!1,d="",h=!1,g=!0,p=!1;function k(){t(11,p=!0)}function w(){t(11,p=!1)}let C=null,M,b=null,y=n.cli.height,G=!1;async function F(){try{const{invoke:E}=await Ie(async()=>{const{invoke:se}=await import("./core-CKq3Z5BB.js");return{invoke:se}},[]),N=await Ie(()=>import("./core-CKq3Z5BB.js"),[]),{listen:Y}=await Ie(async()=>{const{listen:se}=await import("./event-DUeWsK_d.js");return{listen:se}},__vite__mapDeps([0,1]));return C=N.convertFileSrc,await E("list_images"),t(6,m=!0),Y("generation-progress",se=>{const{message:le,progress:ue,stage:oe}=se.payload;if(ue!==null&&t(4,c=ue),M){const V=oe==="error";M.addResult(le,V)}if(oe==="image_ready"&&le.includes("Saved: ")){const V=le.replace("üíæ Saved: ",""),re=L(V);t(5,u={url:re})}}),!0}catch{return t(6,m=!1),!1}}async function z(){try{return(await fetch(`${s}/api/health`,{signal:AbortSignal.timeout(2e3)})).ok}catch{return!1}}async function I(){try{const E=await fetch(`${s}/api/setup/status`);if(E.ok){const N=await E.json();if(!N.is_configured)return!0;const Y=N.models_needed||[],se=N.models_downloaded||{};return Y.some(le=>!se[le.name])}}catch(E){console.log("Could not check setup status:",E)}return!1}function H(){t(9,h=!1),we()}function D(E){t(1,G=!0),document.addEventListener("mousemove",B),document.addEventListener("mouseup",R),E.preventDefault()}function B(E){if(!G)return;const N=document.querySelector(".app");if(!N)return;const se=N.getBoundingClientRect().bottom-E.clientY;t(0,y=Math.max(Is,Math.min(Ps,se)))}function R(){t(1,G=!1),document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",R),zl({height:y})}function L(E){if(!E)return console.warn("üîÑ [toDisplayUrl] Empty path received"),"";if(typeof C=="function"&&!E.startsWith("http"))try{return C(E)}catch(N){console.warn("üîÑ [toDisplayUrl] Tauri convertFileSrc failed:",N)}if(E.startsWith("http"))return E;if(E.startsWith("/output/"))return`${s}${E}`;if(E.includes("output")){const N=E.split(/[/\\]/).pop();return`${s}/output/${N}`}return E}async function Q(E,N,Y){t(3,i=!0),t(4,c=0),M&&M.startGeneration();const se=new URLSearchParams({prompt:E,count:String(N.count||1),width:String(N.width||1024),height:String(N.height||1024)});Y!==null&&se.set("seed",String(Y)),console.log("üé¨ [GENERATE] Starting generation..."),console.log("üìù [GENERATE] Prompt:",E),console.log("‚öôÔ∏è [GENERATE] Params:",N),console.log("üé≤ [GENERATE] Seed:",Y);try{const le=`${s}/api/generate/stream?${se}`;console.log("üîó [SSE] Connecting to:",le),b=new EventSource(le);let ue=0;b.onopen=()=>{console.log("‚úÖ [SSE] Connection opened")},b.onerror=oe=>{console.error("‚ùå [SSE] Connection error:",oe)},b.onmessage=oe=>{ue++,console.log(`üì® [SSE] Event #${ue}:`,oe.data);try{const V=JSON.parse(oe.data);if(console.log("üì¶ [SSE] Parsed event:",{stage:V.stage,message:V.message,progress:V.progress,path:V.path,final_prompts:V.final_prompts}),V.progress!==void 0&&V.progress!==null&&(console.log(`üìä [PROGRESS] Updating to ${V.progress}%`),t(4,c=V.progress)),M&&V.stage&&V.stage!=="complete"&&V.stage!=="error"&&(console.log(`üîÑ [CLI] Updating progress: ${V.stage} (${V.progress}%)`),M.updateProgress(V.progress||0,V.stage,V.message||"")),V.stage==="image_saved"&&V.path)try{console.log("üñºÔ∏è [IMAGE] Raw path from event:",V.path);const re=L(V.path);console.log("üñºÔ∏è [IMAGE] Converted URL:",re);const ge=V.data?.prompt||void 0,T={url:re,prompt:ge};t(2,o=[T,...o]),console.log("üñºÔ∏è [IMAGE] Added to gallery, setting preview..."),t(5,u=T),console.log("üñºÔ∏è [IMAGE] Preview set to:",u)}catch(re){console.error("‚ùå [IMAGE] Error handling image_saved:",re)}if(V.stage==="substituting"&&console.log(`üîÄ [SUBSTITUTE] ${V.message}`),V.stage==="complete"){if(console.log("‚úÖ [COMPLETE] Generation finished!"),console.log("üìù [COMPLETE] Final prompts:",V.final_prompts),console.log("üñºÔ∏è [COMPLETE] Images:",V.images),t(3,i=!1),t(4,c=0),M&&(M.completeGeneration(!0),M.addResult(`‚úÖ ${V.message||"Generation complete!"}`),V.final_prompts&&V.final_prompts.length>0)){const re=V.final_prompts[0];re!==E&&M.addResult(`üìù Final prompt: ${re}`)}b?.close(),we()}V.stage==="error"&&(console.error("‚ùå [ERROR]",V.message),t(3,i=!1),t(4,c=0),M&&(M.completeGeneration(!1),M.addResult(V.message||"Generation failed",!0)),b?.close())}catch(V){console.error("‚ùå [SSE] Failed to parse event:",V,"Raw:",oe.data)}},b.onerror=oe=>{console.error("SSE error:",oe),t(3,i=!1),t(4,c=0),M&&M.addResult("‚ùå Connection to server lost",!0),b?.close()}}catch(le){console.error("Generation failed:",le),t(8,d=`‚ùå Generation failed: ${le}`),t(3,i=!1),t(4,c=0)}}async function P(E){const{prompt:N,params:Y,seed:se}=E.detail;if(t(8,d=""),m){t(3,i=!0),t(4,c=0);try{const{invoke:le}=await Ie(async()=>{const{invoke:oe}=await import("./core-CKq3Z5BB.js");return{invoke:oe}},[]),ue=await le("generate_image",{prompt:N,count:Y.count||1,width:Y.width||1024,height:Y.height||1024,seed:se||null});if(Array.isArray(ue)){const oe=ue.map(V=>({url:L(V)}));t(2,o=[...oe,...o])}}catch(le){console.error("Generation failed:",le),t(8,d=`‚ùå Generation failed: ${le}`)}finally{t(3,i=!1),t(4,c=0)}}else v?await Q(N,Y,se):(t(8,d="‚ö†Ô∏è No backend connected. Start with: z-explorer"),M&&M.addResult("‚ö†Ô∏è Server not running. Start with: z-explorer",!0))}async function ee(){if(m)try{const{invoke:E}=await Ie(async()=>{const{invoke:N}=await import("./core-CKq3Z5BB.js");return{invoke:N}},[]);return await E("get_gpu_info")}catch(E){return console.error("Failed to get GPU info:",E),null}else if(v)try{const E=await fetch(`${s}/api/gpu`);if(E.ok)return await E.json()}catch(E){console.error("Failed to get GPU info:",E)}return null}async function q(){if(m)try{const{invoke:E}=await Ie(async()=>{const{invoke:N}=await import("./core-CKq3Z5BB.js");return{invoke:N}},[]);return await E("unload_models")}catch(E){return console.error("Failed to unload models:",E),null}else if(v)try{const E=await fetch(`${s}/api/unload`,{method:"POST"});if(E.ok)return await E.json()}catch(E){console.error("Failed to unload models:",E)}return null}async function ae(){if(console.log("üìö [App] handleListVariables called, tauri:",m),m)try{const{invoke:E}=await Ie(async()=>{const{invoke:N}=await import("./core-CKq3Z5BB.js");return{invoke:N}},[]);return await E("list_variables")}catch(E){return console.error("Failed to list variables:",E),null}try{console.log("üìö [App] Fetching variables from:",`${s}/api/variables`);const E=await fetch(`${s}/api/variables`);if(E.ok){const N=await E.json();return console.log("üìö [App] Variables loaded:",N),N}else console.warn("üìö [App] Variables fetch failed:",E.status)}catch(E){console.warn("üìö [App] Variables fetch error (server might not be running):",E)}return null}function W(E){console.log("üñºÔ∏è [handleImageSelect] Event detail:",E.detail),console.log("üñºÔ∏è [handleImageSelect] Prompt:",E.detail?.prompt),t(5,u=E.detail)}function me(){t(5,u=null)}async function we(){try{const E=await fetch(`${s}/api/images`);if(E.ok){const N=await E.json();N.images&&t(2,o=N.images.map(Y=>{let se;return Y.url?se=Y.url.startsWith("http")?Y.url:`${s}${Y.url}`:se=`${s}/output/${Y.name}`,{url:se,prompt:Y.prompt||void 0}}))}}catch(E){console.log("Could not load images:",E)}}it(async()=>{if(Dl(),await F()){t(8,d="üñ•Ô∏è Running in native Tauri mode"),t(10,g=!1);try{const{invoke:N}=await Ie(async()=>{const{invoke:se}=await import("./core-CKq3Z5BB.js");return{invoke:se}},[]),Y=await N("list_images");t(2,o=Y.map(se=>({url:L(se)})))}catch(N){console.log("Failed to load images:",N)}}else if(t(7,v=await z()),v){if(t(9,h=await I()),t(10,g=!1),!h){const N=s||window.location.origin;t(8,d=`‚úÖ Connected to Z-Explorer server (${N})`),await we(),M&&await M.fetchVersion(s)}}else t(10,g=!1),t(8,d="üé® Offline mode - Start server with: z-explorer")}),Ml(()=>{b?.close()});function de(E){Il.call(this,l,E)}const _e=E=>E.key==="Escape"&&me();function fe(E){Qe[E?"unshift":"push"](()=>{M=E,t(12,M)})}return l.$$.update=()=>{l.$$.dirty[0]&16777219&&!G&&n.cli.height!==y&&t(0,y=n.cli.height)},[y,G,o,i,c,u,m,v,d,h,g,p,M,s,k,w,H,D,P,ee,q,ae,W,me,n,de,_e,fe]}class Os extends Te{constructor(e){super(),Le(this,e,Hs,Ms,Fe,{},null,[-1,-1])}}new Os({target:document.getElementById("app")});
