const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/event-DUeWsK_d.js","assets/core-CKq3Z5BB.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const fn="modulepreload",dn=function(l){return"/"+l},vt={},Ne=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");s=Promise.allSettled(t.map(u=>{if(u=dn(u),u in vt)return;vt[u]=!0;const m=u.endsWith(".css"),_=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${_}`))return;const d=document.createElement("link");if(d.rel=m?"stylesheet":fn,m||(d.as="script"),d.crossOrigin="",d.href=u,c&&d.setAttribute("nonce",c),document.head.appendChild(d),m)return new Promise((h,g)=>{d.addEventListener("load",h),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return s.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function $(){}function Vl(l){return l()}function bt(){return Object.create(null)}function Ae(l){l.forEach(Vl)}function rt(l){return typeof l=="function"}function Ge(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let lt;function He(l,e){return l===e?!0:(lt||(lt=document.createElement("a")),lt.href=e,l===lt.href)}function pn(l){return Object.keys(l).length===0}function Ul(l,...e){if(l==null){for(const n of e)n(void 0);return $}const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function De(l,e,t){l.$$.on_destroy.push(Ul(e,t))}function r(l,e){l.appendChild(e)}function C(l,e,t){l.insertBefore(e,t||null)}function S(l){l.parentNode&&l.parentNode.removeChild(l)}function ye(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function f(l){return document.createElement(l)}function R(l){return document.createTextNode(l)}function v(){return R(" ")}function at(){return R("")}function Z(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function ql(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function a(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Ke(l){return l===""?null:+l}function mn(l){return Array.from(l.childNodes)}function X(l,e){e=""+e,l.data!==e&&(l.data=e)}function we(l,e){l.value=e??""}function me(l,e,t,n){t==null?l.style.removeProperty(e):l.style.setProperty(e,t,"")}function Qe(l,e,t){for(let n=0;n<l.options.length;n+=1){const s=l.options[n];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(l.selectedIndex=-1)}function ct(l){const e=l.querySelector(":checked");return e&&e.__value}function ie(l,e,t){l.classList.toggle(e,!!t)}function gn(l,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(l,{detail:e,bubbles:t,cancelable:n})}let et;function $e(l){et=l}function dt(){if(!et)throw new Error("Function called outside component initialization");return et}function pt(l){dt().$$.on_mount.push(l)}function Wl(l){dt().$$.on_destroy.push(l)}function mt(){const l=dt();return(e,t,{cancelable:n=!1}={})=>{const s=l.$$.callbacks[e];if(s){const o=gn(e,t,{cancelable:n});return s.slice().forEach(i=>{i.call(l,o)}),!o.defaultPrevented}return!0}}function Zl(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const Je=[],tt=[];let Ye=[];const kt=[],hn=Promise.resolve();let ft=!1;function _n(){ft||(ft=!0,hn.then(Jl))}function xe(l){Ye.push(l)}const ut=new Set;let We=0;function Jl(){if(We!==0)return;const l=et;do{try{for(;We<Je.length;){const e=Je[We];We++,$e(e),vn(e.$$)}}catch(e){throw Je.length=0,We=0,e}for($e(null),Je.length=0,We=0;tt.length;)tt.pop()();for(let e=0;e<Ye.length;e+=1){const t=Ye[e];ut.has(t)||(ut.add(t),t())}Ye.length=0}while(Je.length);for(;kt.length;)kt.pop()();ft=!1,ut.clear(),$e(l)}function vn(l){if(l.fragment!==null){l.update(),Ae(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(xe)}}function bn(l){const e=[],t=[];Ye.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Ye=e}const it=new Set;let Ue;function gt(){Ue={r:0,c:[],p:Ue}}function ht(){Ue.r||Ae(Ue.c),Ue=Ue.p}function Se(l,e){l&&l.i&&(it.delete(l),l.i(e))}function Ee(l,e,t,n){if(l&&l.o){if(it.has(l))return;it.add(l),Ue.c.push(()=>{it.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function ue(l){return l?.length!==void 0?l:Array.from(l)}function Re(l){l&&l.c()}function Ie(l,e,t){const{fragment:n,after_update:s}=l.$$;n&&n.m(e,t),xe(()=>{const o=l.$$.on_mount.map(Vl).filter(rt);l.$$.on_destroy?l.$$.on_destroy.push(...o):Ae(o),l.$$.on_mount=[]}),s.forEach(xe)}function Pe(l,e){const t=l.$$;t.fragment!==null&&(bn(t.after_update),Ae(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function kn(l,e){l.$$.dirty[0]===-1&&(Je.push(l),_n(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function ze(l,e,t,n,s,o,i=null,c=[-1]){const u=et;$e(l);const m=l.$$={fragment:null,ctx:[],props:o,update:$,not_equal:s,bound:bt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:bt(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};i&&i(m.root);let _=!1;if(m.ctx=t?t(l,e.props||{},(d,h,...g)=>{const p=g.length?g[0]:h;return m.ctx&&s(m.ctx[d],m.ctx[d]=p)&&(!m.skip_bound&&m.bound[d]&&m.bound[d](p),_&&kn(l,d)),h}):[],m.update(),_=!0,Ae(m.before_update),m.fragment=n?n(m.ctx):!1,e.target){if(e.hydrate){const d=mn(e.target);m.fragment&&m.fragment.l(d),d.forEach(S)}else m.fragment&&m.fragment.c();e.intro&&Se(l.$$.fragment),Ie(l,e.target,e.anchor),Jl()}$e(u)}class Be{$$=void 0;$$set=void 0;$destroy(){Pe(this,1),this.$destroy=$}$on(e,t){if(!rt(t))return $;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!pn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const wn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(wn);const Ze=[];function yn(l,e){return{subscribe:Ql(l,e).subscribe}}function Ql(l,e=$){let t;const n=new Set;function s(c){if(Ge(l,c)&&(l=c,t)){const u=!Ze.length;for(const m of n)m[1](),Ze.push(m,l);if(u){for(let m=0;m<Ze.length;m+=2)Ze[m][0](Ze[m+1]);Ze.length=0}}}function o(c){s(c(l))}function i(c,u=$){const m=[c,u];return n.add(m),n.size===1&&(t=e(s,o)||$),c(l),()=>{n.delete(m),n.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:i}}function Sn(l,e,t){const n=!Array.isArray(l),s=n?[l]:l;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return yn(t,(i,c)=>{let u=!1;const m=[];let _=0,d=$;const h=()=>{if(_)return;d();const p=e(n?m[0]:m,i,c);o?i(p):d=rt(p)?p:$},g=s.map((p,b)=>Ul(p,F=>{m[b]=F,_&=~(1<<b),u&&h()},()=>{_|=1<<b}));return u=!0,h(),function(){Ae(g),d(),u=!1}})}const Kl="z-explorer-settings",qe={gallery:{layout:"flex-row",thumbnailSize:"medium",thumbnailHeight:180,showPromptOnHover:!0,sortOrder:"newest"},cli:{height:420,showTipsOnStart:!0,showTutorialOnStart:!0,fontSize:"medium",showHistory:!0},generation:{defaultWidth:1024,defaultHeight:1024,defaultCount:1,autoEnhance:!1},models:{imageMode:null,imageRepo:null,imagePath:null,llmMode:null,llmRepo:null,llmPath:null}};function Cn(l,e){if(!e||typeof e!="object")return l;const t=e,n={...l};return t.gallery&&typeof t.gallery=="object"&&(n.gallery={...l.gallery,...t.gallery}),t.cli&&typeof t.cli=="object"&&(n.cli={...l.cli,...t.cli}),t.generation&&typeof t.generation=="object"&&(n.generation={...l.generation,...t.generation}),t.models&&typeof t.models=="object"&&(n.models={...l.models,...t.models}),n}function Fn(){try{const l=localStorage.getItem(Kl);if(!l)return qe;const e=JSON.parse(l);return Cn(qe,e)}catch(l){return console.warn("Failed to load settings, using defaults:",l),qe}}function Yl(l){try{return localStorage.setItem(Kl,JSON.stringify(l)),!0}catch(e){return console.error("Failed to save settings:",e),!1}}function Xl(l){return typeof l=="number"&&isFinite(l)&&l>=80&&l<=500}function En(l,e){switch(l){case"small":return 120;case"medium":return 180;case"large":return 250;case"xlarge":return 350;case"custom":return Xl(e)?e:180;default:return 180}}let Xe;function xl(){const l=Fn();Xe?Xe.set(l):Xe=Ql(l)}xl();const je={subscribe:(l,e)=>Xe.subscribe(l,e)},An=Sn(je,l=>En(l.gallery.thumbnailSize,l.gallery.thumbnailHeight));function _t(l){Xe.update(e=>{const t=l(e);return Yl(t),t})}function Tn(l){_t(e=>({...e,gallery:{...e.gallery,...l}}))}function $l(l){_t(e=>({...e,cli:{...e.cli,...l}}))}function Ln(l){_t(e=>({...e,generation:{...e.generation,...l}}))}function Mn(){Xe.set(qe),Yl(qe)}function wt(l,e,t){const n=l.slice();return n[10]=e[t],n[12]=t,n}function Hn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-1tf9jje")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function In(l){let e,t,n=l[10].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=R(n),a(t,"class","svelte-1tf9jje"),a(e,"class","prompt-preview svelte-1tf9jje")},m(o,i){C(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[10].prompt+"")&&X(s,n)},d(o){o&&S(e)}}}function yt(l){let e,t,n,s,o,i,c,u;function m(...p){return l[6](l[10],...p)}function _(p,b){return p[3].gallery.showPromptOnHover&&p[10].prompt?In:Hn}let d=_(l),h=d(l);function g(){return l[7](l[10])}return{c(){e=f("button"),t=f("img"),s=v(),o=f("div"),h.c(),i=v(),He(t.src,n=l[10].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[12]+1)),a(t,"loading","lazy"),a(t,"class","svelte-1tf9jje"),a(o,"class","image-overlay svelte-1tf9jje"),a(e,"class","image-card svelte-1tf9jje"),me(e,"animation-delay",l[12]*50+"ms"),me(e,"flex-grow",l[5](l[10]))},m(p,b){C(p,e,b),r(e,t),r(e,s),r(e,o),h.m(o,null),r(e,i),c||(u=[Z(t,"load",m),Z(e,"click",g)],c=!0)},p(p,b){l=p,b&1&&!He(t.src,n=l[10].url)&&a(t,"src",n),d===(d=_(l))&&h?h.p(l,b):(h.d(1),h=d(l),h&&(h.c(),h.m(o,null))),b&1&&me(e,"flex-grow",l[5](l[10]))},d(p){p&&S(e),h.d(),c=!1,Ae(u)}}}function Pn(l){let e,t=ue(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=yt(wt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","flex-row svelte-1tf9jje"),me(e,"--thumb-height",l[2]+"px")},m(s,o){C(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&59){t=ue(s[0]);let i;for(i=0;i<t.length;i+=1){const c=wt(s,t,i);n[i]?n[i].p(c,o):(n[i]=yt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&me(e,"--thumb-height",s[2]+"px")},i:$,o:$,d(s){s&&S(e),ye(n,s)}}}function Gn(l,e,t){let n;De(l,je,g=>t(3,n=g));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e,c=new Map;function u(g,p){const b=g.target;if(b.naturalWidth&&b.naturalHeight){const F=b.naturalWidth/b.naturalHeight;c.set(p.url,F),c=c}}function m(g){return c.get(g.url)||1}function _(g){const p=m(g);return Math.max(.5,Math.min(2,p))}const d=(g,p)=>u(p,g),h=g=>o(g);return l.$$set=g=>{"images"in g&&t(0,s=g.images),"onSelect"in g&&t(1,o=g.onSelect),"thumbnailHeight"in g&&t(2,i=g.thumbnailHeight)},[s,o,i,n,u,_,d,h]}class en extends Be{constructor(e){super(),ze(this,e,Gn,Pn,Ge,{images:0,onSelect:1,thumbnailHeight:2})}}function St(l,e,t){const n=l.slice();return n[4]=e[t],n[6]=t,n}function On(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-1cd54o6")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function Rn(l){let e,t,n=l[4].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=R(n),a(t,"class","svelte-1cd54o6"),a(e,"class","prompt-preview svelte-1cd54o6")},m(o,i){C(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[4].prompt+"")&&X(s,n)},d(o){o&&S(e)}}}function Ct(l){let e,t,n,s,o,i,c,u;function m(g,p){return g[2].gallery.showPromptOnHover&&g[4].prompt?Rn:On}let _=m(l),d=_(l);function h(){return l[3](l[4])}return{c(){e=f("button"),t=f("img"),s=v(),o=f("div"),d.c(),i=v(),He(t.src,n=l[4].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[6]+1)),a(t,"loading","lazy"),a(t,"class","svelte-1cd54o6"),a(o,"class","image-overlay svelte-1cd54o6"),a(e,"class","image-card svelte-1cd54o6"),me(e,"animation-delay",l[6]*50+"ms")},m(g,p){C(g,e,p),r(e,t),r(e,s),r(e,o),d.m(o,null),r(e,i),c||(u=Z(e,"click",h),c=!0)},p(g,p){l=g,p&1&&!He(t.src,n=l[4].url)&&a(t,"src",n),_===(_=m(l))&&d?d.p(l,p):(d.d(1),d=_(l),d&&(d.c(),d.m(o,null)))},d(g){g&&S(e),d.d(),c=!1,u()}}}function Dn(l){let e,t=ue(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ct(St(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","masonry-vertical svelte-1cd54o6")},m(s,o){C(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&7){t=ue(s[0]);let i;for(i=0;i<t.length;i+=1){const c=St(s,t,i);n[i]?n[i].p(c,o):(n[i]=Ct(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},i:$,o:$,d(s){s&&S(e),ye(n,s)}}}function zn(l,e,t){let n;De(l,je,c=>t(2,n=c));let{images:s=[]}=e,{onSelect:o}=e;const i=c=>o(c);return l.$$set=c=>{"images"in c&&t(0,s=c.images),"onSelect"in c&&t(1,o=c.onSelect)},[s,o,n,i]}class Bn extends Be{constructor(e){super(),ze(this,e,zn,Dn,Ge,{images:0,onSelect:1})}}function Ft(l,e,t){const n=l.slice();return n[9]=e[t],n[11]=t,n}function jn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-177e03b")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function Nn(l){let e,t,n=l[9].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=R(n),a(t,"class","svelte-177e03b"),a(e,"class","prompt-preview svelte-177e03b")},m(o,i){C(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[9].prompt+"")&&X(s,n)},d(o){o&&S(e)}}}function Et(l){let e,t,n,s,o,i,c,u;function m(...p){return l[6](l[9],...p)}function _(p,b){return p[3].gallery.showPromptOnHover&&p[9].prompt?Nn:jn}let d=_(l),h=d(l);function g(){return l[7](l[9])}return{c(){e=f("button"),t=f("img"),s=v(),o=f("div"),h.c(),i=v(),He(t.src,n=l[9].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[11]+1)),a(t,"loading","lazy"),a(t,"class","svelte-177e03b"),a(o,"class","image-overlay svelte-177e03b"),a(e,"class","image-card svelte-177e03b"),me(e,"animation-delay",l[11]*50+"ms"),me(e,"width",l[5](l[9])+"px")},m(p,b){C(p,e,b),r(e,t),r(e,s),r(e,o),h.m(o,null),r(e,i),c||(u=[Z(t,"load",m),Z(e,"click",g)],c=!0)},p(p,b){l=p,b&1&&!He(t.src,n=l[9].url)&&a(t,"src",n),d===(d=_(l))&&h?h.p(l,b):(h.d(1),h=d(l),h&&(h.c(),h.m(o,null))),b&1&&me(e,"width",l[5](l[9])+"px")},d(p){p&&S(e),h.d(),c=!1,Ae(u)}}}function Vn(l){let e,t=ue(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Et(Ft(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","masonry-horizontal svelte-177e03b"),me(e,"--thumb-height",l[2]+"px")},m(s,o){C(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&59){t=ue(s[0]);let i;for(i=0;i<t.length;i+=1){const c=Ft(s,t,i);n[i]?n[i].p(c,o):(n[i]=Et(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&me(e,"--thumb-height",s[2]+"px")},i:$,o:$,d(s){s&&S(e),ye(n,s)}}}function Un(l,e,t){let n;De(l,je,h=>t(3,n=h));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e,c=new Map;function u(h,g){const p=h.target;if(p.naturalWidth&&p.naturalHeight){const b=p.naturalWidth/p.naturalHeight;c.set(g.url,b),c=c}}function m(h){const g=c.get(h.url)||1;return Math.round(i*g)}const _=(h,g)=>u(g,h),d=h=>o(h);return l.$$set=h=>{"images"in h&&t(0,s=h.images),"onSelect"in h&&t(1,o=h.onSelect),"thumbnailHeight"in h&&t(2,i=h.thumbnailHeight)},[s,o,i,n,u,m,_,d]}class qn extends Be{constructor(e){super(),ze(this,e,Un,Vn,Ge,{images:0,onSelect:1,thumbnailHeight:2})}}function At(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function Wn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-1oj0pf3")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function Zn(l){let e,t,n=l[5].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=R(n),a(t,"class","svelte-1oj0pf3"),a(e,"class","prompt-preview svelte-1oj0pf3")},m(o,i){C(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[5].prompt+"")&&X(s,n)},d(o){o&&S(e)}}}function Tt(l){let e,t,n,s,o,i,c,u;function m(g,p){return g[3].gallery.showPromptOnHover&&g[5].prompt?Zn:Wn}let _=m(l),d=_(l);function h(){return l[4](l[5])}return{c(){e=f("button"),t=f("img"),s=v(),o=f("div"),d.c(),i=v(),He(t.src,n=l[5].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[7]+1)),a(t,"loading","lazy"),a(t,"class","svelte-1oj0pf3"),a(o,"class","image-overlay svelte-1oj0pf3"),a(e,"class","image-card svelte-1oj0pf3"),me(e,"animation-delay",l[7]*50+"ms")},m(g,p){C(g,e,p),r(e,t),r(e,s),r(e,o),d.m(o,null),r(e,i),c||(u=Z(e,"click",h),c=!0)},p(g,p){l=g,p&1&&!He(t.src,n=l[5].url)&&a(t,"src",n),_===(_=m(l))&&d?d.p(l,p):(d.d(1),d=_(l),d&&(d.c(),d.m(o,null)))},d(g){g&&S(e),d.d(),c=!1,u()}}}function Jn(l){let e,t=ue(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Tt(At(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","grid-square svelte-1oj0pf3"),me(e,"--thumb-height",l[2]+"px")},m(s,o){C(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&11){t=ue(s[0]);let i;for(i=0;i<t.length;i+=1){const c=At(s,t,i);n[i]?n[i].p(c,o):(n[i]=Tt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&me(e,"--thumb-height",s[2]+"px")},i:$,o:$,d(s){s&&S(e),ye(n,s)}}}function Qn(l,e,t){let n;De(l,je,u=>t(3,n=u));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e;const c=u=>o(u);return l.$$set=u=>{"images"in u&&t(0,s=u.images),"onSelect"in u&&t(1,o=u.onSelect),"thumbnailHeight"in u&&t(2,i=u.thumbnailHeight)},[s,o,i,n,c]}class Kn extends Be{constructor(e){super(),ze(this,e,Qn,Jn,Ge,{images:0,onSelect:1,thumbnailHeight:2})}}function Lt(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function Yn(l){let e;return{c(){e=f("span"),e.textContent="üîç",a(e,"class","zoom-icon svelte-6g0nko")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function Xn(l){let e,t,n=l[5].prompt+"",s;return{c(){e=f("div"),t=f("p"),s=R(n),a(t,"class","svelte-6g0nko"),a(e,"class","prompt-preview svelte-6g0nko")},m(o,i){C(o,e,i),r(e,t),r(t,s)},p(o,i){i&1&&n!==(n=o[5].prompt+"")&&X(s,n)},d(o){o&&S(e)}}}function Mt(l){let e,t,n,s,o,i,c,u;function m(g,p){return g[3].gallery.showPromptOnHover&&g[5].prompt?Xn:Yn}let _=m(l),d=_(l);function h(){return l[4](l[5])}return{c(){e=f("button"),t=f("img"),s=v(),o=f("div"),d.c(),i=v(),He(t.src,n=l[5].url)||a(t,"src",n),a(t,"alt","Generated image "+(l[7]+1)),a(t,"loading","lazy"),a(t,"class","svelte-6g0nko"),a(o,"class","image-overlay svelte-6g0nko"),a(e,"class","image-card svelte-6g0nko"),me(e,"animation-delay",l[7]*50+"ms")},m(g,p){C(g,e,p),r(e,t),r(e,s),r(e,o),d.m(o,null),r(e,i),c||(u=Z(e,"click",h),c=!0)},p(g,p){l=g,p&1&&!He(t.src,n=l[5].url)&&a(t,"src",n),_===(_=m(l))&&d?d.p(l,p):(d.d(1),d=_(l),d&&(d.c(),d.m(o,null)))},d(g){g&&S(e),d.d(),c=!1,u()}}}function xn(l){let e,t=ue(l[0]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Mt(Lt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","grid-auto svelte-6g0nko"),me(e,"--thumb-height",l[2]+"px")},m(s,o){C(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,[o]){if(o&11){t=ue(s[0]);let i;for(i=0;i<t.length;i+=1){const c=Lt(s,t,i);n[i]?n[i].p(c,o):(n[i]=Mt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}o&4&&me(e,"--thumb-height",s[2]+"px")},i:$,o:$,d(s){s&&S(e),ye(n,s)}}}function $n(l,e,t){let n;De(l,je,u=>t(3,n=u));let{images:s=[]}=e,{onSelect:o}=e,{thumbnailHeight:i=180}=e;const c=u=>o(u);return l.$$set=u=>{"images"in u&&t(0,s=u.images),"onSelect"in u&&t(1,o=u.onSelect),"thumbnailHeight"in u&&t(2,i=u.thumbnailHeight)},[s,o,i,n,c]}class es extends Be{constructor(e){super(),ze(this,e,$n,xn,Ge,{images:0,onSelect:1,thumbnailHeight:2})}}function Ht(l){let e;return{c(){e=f("div"),e.innerHTML=`<span class="pulse svelte-u8rtp8"></span>
          Generating...`,a(e,"class","generating-badge svelte-u8rtp8")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function It(l){let e,t,n,s,o,i=l[2]>0&&Pt(l);return{c(){e=f("div"),t=f("div"),n=v(),s=f("span"),s.textContent="Creating magic...",o=v(),i&&i.c(),a(t,"class","spinner svelte-u8rtp8"),a(e,"class","generating-banner svelte-u8rtp8")},m(c,u){C(c,e,u),r(e,t),r(e,n),r(e,s),r(e,o),i&&i.m(e,null)},p(c,u){c[2]>0?i?i.p(c,u):(i=Pt(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(c){c&&S(e),i&&i.d()}}}function Pt(l){let e,t;return{c(){e=f("div"),t=f("div"),a(t,"class","progress-fill svelte-u8rtp8"),me(t,"width",l[2]+"%"),a(e,"class","progress-bar svelte-u8rtp8")},m(n,s){C(n,e,s),r(e,t)},p(n,s){s&4&&me(t,"width",n[2]+"%")},d(n){n&&S(e)}}}function ts(l){let e,t,n,s;const o=[as,rs,is,os,ss,ns],i=[];function c(u,m){return u[3].gallery.layout==="flex-row"?0:u[3].gallery.layout==="masonry-vertical"?1:u[3].gallery.layout==="masonry-horizontal"?2:u[3].gallery.layout==="grid-square"?3:u[3].gallery.layout==="grid-auto"?4:5}return t=c(l),n=i[t]=o[t](l),{c(){e=f("div"),n.c(),a(e,"class","gallery-grid svelte-u8rtp8")},m(u,m){C(u,e,m),i[t].m(e,null),s=!0},p(u,m){let _=t;t=c(u),t===_?i[t].p(u,m):(gt(),Ee(i[_],1,1,()=>{i[_]=null}),ht(),n=i[t],n?n.p(u,m):(n=i[t]=o[t](u),n.c()),Se(n,1),n.m(e,null))},i(u){s||(Se(n),s=!0)},o(u){Ee(n),s=!1},d(u){u&&S(e),i[t].d()}}}function ls(l){let e;return{c(){e=f("div"),e.innerHTML='<span class="empty-icon svelte-u8rtp8">‚ú®</span> <h3 class="svelte-u8rtp8">No images yet</h3> <p class="svelte-u8rtp8">Start generating with the CLI below</p>',a(e,"class","empty-state svelte-u8rtp8")},m(t,n){C(t,e,n)},p:$,i:$,o:$,d(t){t&&S(e)}}}function ns(l){let e,t;return e=new en({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){Re(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(Se(e.$$.fragment,n),t=!0)},o(n){Ee(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function ss(l){let e,t;return e=new es({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){Re(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(Se(e.$$.fragment,n),t=!0)},o(n){Ee(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function os(l){let e,t;return e=new Kn({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){Re(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(Se(e.$$.fragment,n),t=!0)},o(n){Ee(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function is(l){let e,t;return e=new qn({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){Re(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(Se(e.$$.fragment,n),t=!0)},o(n){Ee(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function rs(l){let e,t;return e=new Bn({props:{images:l[0],onSelect:l[5]}}),{c(){Re(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),e.$set(o)},i(n){t||(Se(e.$$.fragment,n),t=!0)},o(n){Ee(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function as(l){let e,t;return e=new en({props:{images:l[0],onSelect:l[5],thumbnailHeight:l[4]}}),{c(){Re(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const o={};s&1&&(o.images=n[0]),s&16&&(o.thumbnailHeight=n[4]),e.$set(o)},i(n){t||(Se(e.$$.fragment,n),t=!0)},o(n){Ee(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function cs(l){let e,t,n,s,o,i,c,u,m,_,d=l[0].length+"",h,g,p,b,F,k,w,y,T,A,E,P,H=l[1]&&Ht(),I=l[1]&&It(l);const z=[ls,ts],D=[];function L(M,V){return M[0].length===0&&!M[1]?0:M[0].length>0?1:-1}return~(y=L(l))&&(T=D[y]=z[y](l)),{c(){e=f("div"),t=f("div"),n=f("div"),n.innerHTML='<img src="/assets/icon.jpg" alt="Z" class="brand-icon svelte-u8rtp8"/> <span class="brand-name svelte-u8rtp8">Z-Explorer</span>',s=v(),o=f("div"),H&&H.c(),i=v(),c=f("h2"),u=R(`Gallery\r
        `),m=f("span"),_=R("("),h=R(d),g=R(")"),p=v(),b=f("button"),b.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>',F=v(),k=f("div"),I&&I.c(),w=v(),T&&T.c(),a(n,"class","brand svelte-u8rtp8"),a(m,"class","count svelte-u8rtp8"),a(c,"class","svelte-u8rtp8"),a(b,"class","settings-btn svelte-u8rtp8"),a(b,"title","Settings"),a(o,"class","header-right svelte-u8rtp8"),a(t,"class","gallery-header svelte-u8rtp8"),a(k,"class","gallery-content svelte-u8rtp8"),a(e,"class","gallery svelte-u8rtp8")},m(M,V){C(M,e,V),r(e,t),r(t,n),r(t,s),r(t,o),H&&H.m(o,null),r(o,i),r(o,c),r(c,u),r(c,m),r(m,_),r(m,h),r(m,g),r(o,p),r(o,b),r(e,F),r(e,k),I&&I.m(k,null),r(k,w),~y&&D[y].m(k,null),A=!0,E||(P=Z(b,"click",l[6]),E=!0)},p(M,[V]){M[1]?H||(H=Ht(),H.c(),H.m(o,i)):H&&(H.d(1),H=null),(!A||V&1)&&d!==(d=M[0].length+"")&&X(h,d),M[1]?I?I.p(M,V):(I=It(M),I.c(),I.m(k,w)):I&&(I.d(1),I=null);let U=y;y=L(M),y===U?~y&&D[y].p(M,V):(T&&(gt(),Ee(D[U],1,1,()=>{D[U]=null}),ht()),~y?(T=D[y],T?T.p(M,V):(T=D[y]=z[y](M),T.c()),Se(T,1),T.m(k,null)):T=null)},i(M){A||(Se(T),A=!0)},o(M){Ee(T),A=!1},d(M){M&&S(e),H&&H.d(),I&&I.d(),~y&&D[y].d(),E=!1,P()}}}function us(l,e,t){let n,s;De(l,je,h=>t(3,n=h)),De(l,An,h=>t(4,s=h));let{images:o=[]}=e,{isGenerating:i=!1}=e,{progress:c=0}=e,{onOpenSettings:u=null}=e;const m=mt();function _(h){m("select",h)}function d(){u&&u()}return l.$$set=h=>{"images"in h&&t(0,o=h.images),"isGenerating"in h&&t(1,i=h.isGenerating),"progress"in h&&t(2,c=h.progress),"onOpenSettings"in h&&t(7,u=h.onOpenSettings)},[o,i,c,n,s,_,d,u]}class fs extends Be{constructor(e){super(),ze(this,e,us,cs,Ge,{images:0,isGenerating:1,progress:2,onOpenSettings:7})}}function Gt(l,e,t){const n=l.slice();return n[53]=e[t],n[55]=t,n}function Ot(l,e,t){const n=l.slice();return n[56]=e[t],n[55]=t,n}function Rt(l,e,t){const n=l.slice();return n[58]=e[t],n}function Dt(l,e,t){const n=l.slice();return n[58]=e[t],n}function zt(l,e,t){const n=l.slice();return n[63]=e[t],n}function Bt(l){let e,t,n,s=l[11]?"‚ñº":"‚ñ∂",o,i,c,u,m,_,d=l[11]&&jt();return{c(){e=f("div"),t=f("button"),n=f("span"),o=R(s),i=v(),c=f("span"),c.textContent="üìö Tutorial:",u=v(),d&&d.c(),a(n,"class","toggle-icon svelte-3nxlm"),a(c,"class","tutorial-label svelte-3nxlm"),a(t,"class","tutorial-toggle svelte-3nxlm"),a(t,"data-testid","tutorial-toggle"),a(t,"aria-expanded",l[11]),a(e,"class","tutorial-section svelte-3nxlm")},m(h,g){C(h,e,g),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(e,u),d&&d.m(e,null),m||(_=Z(t,"click",l[17]),m=!0)},p(h,g){g[0]&2048&&s!==(s=h[11]?"‚ñº":"‚ñ∂")&&X(o,s),g[0]&2048&&a(t,"aria-expanded",h[11]),h[11]?d?d.p(h,g):(d=jt(),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},d(h){h&&S(e),d&&d.d(),m=!1,_()}}}function jt(l){let e,t;return{c(){e=f("div"),t=f("div"),t.textContent=`${Ss}`,a(t,"class","line dim svelte-3nxlm"),a(e,"class","tutorial-content svelte-3nxlm")},m(n,s){C(n,e,s),r(e,t)},p:$,d(n){n&&S(e)}}}function Nt(l){let e,t,n,s=l[10]?"‚ñº":"‚ñ∂",o,i,c,u,m,_,d=l[10]&&Vt(l);return{c(){e=f("div"),t=f("button"),n=f("span"),o=R(s),i=v(),c=f("span"),c.textContent="üí° Tips:",u=v(),d&&d.c(),a(n,"class","toggle-icon svelte-3nxlm"),a(c,"class","tips-label svelte-3nxlm"),a(t,"class","tips-toggle svelte-3nxlm"),a(t,"data-testid","tips-toggle"),a(t,"aria-expanded",l[10]),a(e,"class","tips-section svelte-3nxlm")},m(h,g){C(h,e,g),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(e,u),d&&d.m(e,null),m||(_=Z(t,"click",l[16]),m=!0)},p(h,g){g[0]&1024&&s!==(s=h[10]?"‚ñº":"‚ñ∂")&&X(o,s),g[0]&1024&&a(t,"aria-expanded",h[10]),h[10]?d?d.p(h,g):(d=Vt(h),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},d(h){h&&S(e),d&&d.d(),m=!1,_()}}}function Vt(l){let e,t=ue(l[18]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ut(zt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","tips-content svelte-3nxlm")},m(s,o){C(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,o){if(o[0]&262144){t=ue(s[18]);let i;for(i=0;i<t.length;i+=1){const c=zt(s,t,i);n[i]?n[i].p(c,o):(n[i]=Ut(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&S(e),ye(n,s)}}}function Ut(l){let e;return{c(){e=f("div"),e.textContent=`${l[63]}`,a(e,"class","line dim svelte-3nxlm")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function ds(l){let e,t=l[56].text+"",n,s;return{c(){e=f("div"),n=R(t),a(e,"class",s="line "+l[56].type+" svelte-3nxlm")},m(o,i){C(o,e,i),r(e,n)},p(o,i){i[0]&2&&t!==(t=o[56].text+"")&&X(n,t),i[0]&2&&s!==(s="line "+o[56].type+" svelte-3nxlm")&&a(e,"class",s)},d(o){o&&S(e)}}}function ps(l){let e,t,n,s,o=l[56].text+"",i,c,u;function m(h,g){return h[56].variant==="enhanced"?ws:ks}let _=m(l),d=_(l);return{c(){e=f("div"),t=f("span"),d.c(),n=v(),s=f("div"),i=R(o),c=v(),a(t,"class","prompt-label svelte-3nxlm"),a(s,"class","prompt-text svelte-3nxlm"),a(e,"class",u="prompt-highlight "+l[56].variant+" svelte-3nxlm")},m(h,g){C(h,e,g),r(e,t),d.m(t,null),r(e,n),r(e,s),r(s,i),r(e,c)},p(h,g){_!==(_=m(h))&&(d.d(1),d=_(h),d&&(d.c(),d.m(t,null))),g[0]&2&&o!==(o=h[56].text+"")&&X(i,o),g[0]&2&&u!==(u="prompt-highlight "+h[56].variant+" svelte-3nxlm")&&a(e,"class",u)},d(h){h&&S(e),d.d()}}}function ms(l){let e,t=l[56].text+"",n;return{c(){e=f("div"),n=R(t),a(e,"class","line progress-msg svelte-3nxlm")},m(s,o){C(s,e,o),r(e,n)},p(s,o){o[0]&2&&t!==(t=s[56].text+"")&&X(n,t)},d(s){s&&S(e)}}}function gs(l){let e,t=l[55]!==l[2]&&qt(l);return{c(){t&&t.c(),e=at()},m(n,s){t&&t.m(n,s),C(n,e,s)},p(n,s){n[55]!==n[2]?t?t.p(n,s):(t=qt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&S(e),t&&t.d(n)}}}function hs(l){let e;return{c(){e=f("div"),a(e,"class","divider svelte-3nxlm")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function _s(l){let e,t=l[56].text+"",n;return{c(){e=f("div"),n=R(t),a(e,"class","line header svelte-3nxlm")},m(s,o){C(s,e,o),r(e,n)},p(s,o){o[0]&2&&t!==(t=s[56].text+"")&&X(n,t)},d(s){s&&S(e)}}}function vs(l){let e,t,n=ue(l[56].rows),s=[];for(let o=0;o<n.length;o+=1)s[o]=Wt(Rt(l,n,o));return{c(){e=f("div");for(let o=0;o<s.length;o+=1)s[o].c();t=v(),a(e,"class","vars-table svelte-3nxlm")},m(o,i){C(o,e,i);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null);r(e,t)},p(o,i){if(i[0]&2){n=ue(o[56].rows);let c;for(c=0;c<n.length;c+=1){const u=Rt(o,n,c);s[c]?s[c].p(u,i):(s[c]=Wt(u),s[c].c(),s[c].m(e,t))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}},d(o){o&&S(e),ye(s,o)}}}function bs(l){let e,t,n=ue(l[56].rows),s=[];for(let o=0;o<n.length;o+=1)s[o]=Zt(Dt(l,n,o));return{c(){e=f("div");for(let o=0;o<s.length;o+=1)s[o].c();t=v(),a(e,"class","cmd-table svelte-3nxlm")},m(o,i){C(o,e,i);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null);r(e,t)},p(o,i){if(i[0]&2){n=ue(o[56].rows);let c;for(c=0;c<n.length;c+=1){const u=Dt(o,n,c);s[c]?s[c].p(u,i):(s[c]=Zt(u),s[c].c(),s[c].m(e,t))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}},d(o){o&&S(e),ye(s,o)}}}function ks(l){let e;return{c(){e=R("üìú Final Prompt")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function ws(l){let e;return{c(){e=R("üí° Enhanced Prompt")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function qt(l){let e,t,n,s=l[56].stage.replace(/_/g," ")+"",o,i,c,u=l[56].percent+"",m,_,d,h,g,p,b;return{c(){e=f("div"),t=f("div"),n=f("span"),o=R(s),i=v(),c=f("span"),m=R(u),_=R("%"),d=v(),h=f("div"),g=f("div"),p=f("div"),b=v(),a(n,"class","progress-stage svelte-3nxlm"),a(c,"class","progress-percent svelte-3nxlm"),a(t,"class","progress-header svelte-3nxlm"),a(p,"class","progress-glow svelte-3nxlm"),a(g,"class","progress-fill svelte-3nxlm"),me(g,"width",l[56].percent+"%"),a(h,"class","progress-track svelte-3nxlm"),a(e,"class","progress-container svelte-3nxlm")},m(F,k){C(F,e,k),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(c,m),r(c,_),r(e,d),r(e,h),r(h,g),r(g,p),r(e,b)},p(F,k){k[0]&2&&s!==(s=F[56].stage.replace(/_/g," ")+"")&&X(o,s),k[0]&2&&u!==(u=F[56].percent+"")&&X(m,u),k[0]&2&&me(g,"width",F[56].percent+"%")},d(F){F&&S(e)}}}function Wt(l){let e,t,n=l[58].id+"",s,o,i,c,u=l[58].count+"",m,_,d,h,g=l[58].sample+"",p;return{c(){e=f("div"),t=f("span"),s=R(n),o=v(),i=f("span"),c=R("("),m=R(u),_=R(")"),d=v(),h=f("span"),p=R(g),a(t,"class","var-id svelte-3nxlm"),a(i,"class","var-count svelte-3nxlm"),a(h,"class","var-sample svelte-3nxlm"),a(e,"class","var-row svelte-3nxlm")},m(b,F){C(b,e,F),r(e,t),r(t,s),r(e,o),r(e,i),r(i,c),r(i,m),r(i,_),r(e,d),r(e,h),r(h,p)},p(b,F){F[0]&2&&n!==(n=b[58].id+"")&&X(s,n),F[0]&2&&u!==(u=b[58].count+"")&&X(m,u),F[0]&2&&g!==(g=b[58].sample+"")&&X(p,g)},d(b){b&&S(e)}}}function Zt(l){let e,t,n=l[58].cmd+"",s,o,i,c=l[58].desc+"",u;return{c(){e=f("div"),t=f("span"),s=R(n),o=v(),i=f("span"),u=R(c),a(t,"class","cmd-name svelte-3nxlm"),a(i,"class","cmd-desc svelte-3nxlm"),a(e,"class","cmd-row svelte-3nxlm")},m(m,_){C(m,e,_),r(e,t),r(t,s),r(e,o),r(e,i),r(i,u)},p(m,_){_[0]&2&&n!==(n=m[58].cmd+"")&&X(s,n),_[0]&2&&c!==(c=m[58].desc+"")&&X(u,c)},d(m){m&&S(e)}}}function Jt(l){let e;function t(o,i){return o[56].type==="table"?bs:o[56].type==="varsTable"?vs:o[56].type==="header"?_s:o[56].type==="divider"?hs:o[56].type==="progress-bar"?gs:o[56].type==="progress-msg"?ms:o[56].type==="prompt-highlight"?ps:ds}let n=t(l),s=n(l);return{c(){s.c(),e=at()},m(o,i){s.m(o,i),C(o,e,i)},p(o,i){n===(n=t(o))&&s?s.p(o,i):(s.d(1),s=n(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){o&&S(e),s.d(o)}}}function Qt(l){let e,t,n,s,o=l[14].stage.replace(/_/g," ")+"",i,c,u,m=l[14].percent+"",_,d,h,g,p,b;return{c(){e=f("div"),t=f("div"),n=f("div"),s=f("span"),i=R(o),c=v(),u=f("span"),_=R(m),d=R("%"),h=v(),g=f("div"),p=f("div"),b=f("div"),a(s,"class","progress-stage svelte-3nxlm"),a(u,"class","progress-percent svelte-3nxlm"),a(n,"class","progress-header svelte-3nxlm"),a(b,"class","progress-glow svelte-3nxlm"),a(p,"class","progress-fill svelte-3nxlm"),me(p,"width",l[14].percent+"%"),a(g,"class","progress-track svelte-3nxlm"),a(t,"class","progress-container svelte-3nxlm"),a(e,"class","active-progress svelte-3nxlm")},m(F,k){C(F,e,k),r(e,t),r(t,n),r(n,s),r(s,i),r(n,c),r(n,u),r(u,_),r(u,d),r(t,h),r(t,g),r(g,p),r(p,b)},p(F,k){k[0]&16384&&o!==(o=F[14].stage.replace(/_/g," ")+"")&&X(i,o),k[0]&16384&&m!==(m=F[14].percent+"")&&X(_,m),k[0]&16384&&me(p,"width",F[14].percent+"%")},d(F){F&&S(e)}}}function Kt(l){let e,t=ue(l[5]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Yt(Gt(l,t,s));return{c(){e=f("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","suggestions svelte-3nxlm")},m(s,o){C(s,e,o);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,o){if(o[0]&1048736){t=ue(s[5]);let i;for(i=0;i<t.length;i+=1){const c=Gt(s,t,i);n[i]?n[i].p(c,o):(n[i]=Yt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&S(e),ye(n,s)}}}function Yt(l){let e,t=l[53]+"",n,s,o,i;function c(){return l[36](l[53])}return{c(){e=f("button"),n=R(t),s=v(),a(e,"class","suggestion svelte-3nxlm"),ie(e,"selected",l[55]===l[7])},m(u,m){C(u,e,m),r(e,n),r(e,s),o||(i=Z(e,"click",c),o=!0)},p(u,m){l=u,m[0]&32&&t!==(t=l[53]+"")&&X(n,t),m[0]&128&&ie(e,"selected",l[55]===l[7])},d(u){u&&S(e),o=!1,i()}}}function ys(l){let e,t,n,s,o,i,c,u,m,_=l[12]?"‚ò∞":"‚àí",d,h,g,p,b,F,k,w,y,T,A,E=(l[3].cli.showTutorialOnStart||l[11])&&Bt(l),P=(l[3].cli.showTipsOnStart||l[10])&&Nt(l),H=ue(l[1]),I=[];for(let L=0;L<H.length;L+=1)I[L]=Jt(Ot(l,H,L));let z=l[14]&&Qt(l),D=l[6]&&Kt(l);return{c(){e=f("div"),t=f("div"),E&&E.c(),n=v(),P&&P.c(),s=v();for(let L=0;L<I.length;L+=1)I[L].c();o=v(),z&&z.c(),i=v(),c=f("div"),u=f("div"),m=f("button"),d=R(_),p=v(),b=f("span"),b.textContent="‚ùØ‚ùØ‚ùØ",F=v(),k=f("input"),y=v(),D&&D.c(),a(t,"class","history svelte-3nxlm"),ie(t,"hidden",!l[12]),a(m,"class","history-toggle svelte-3nxlm"),a(m,"title",h=l[12]?"Hide history":"Show history"),a(m,"aria-label",g=l[12]?"Hide history":"Show history"),a(m,"aria-pressed",l[12]),a(b,"class","prompt-symbol svelte-3nxlm"),a(k,"placeholder",w=l[0]?"Generating...":"Enter prompt or /help"),k.disabled=l[0],a(k,"spellcheck","false"),a(k,"autocomplete","off"),a(k,"class","svelte-3nxlm"),a(u,"class","input-line svelte-3nxlm"),a(c,"class","input-area svelte-3nxlm"),ie(c,"no-border",!l[12]&&!l[14]),a(e,"class","cli svelte-3nxlm"),me(e,"font-size",l[13]),ie(e,"history-hidden",!l[12])},m(L,M){C(L,e,M),r(e,t),E&&E.m(t,null),r(t,n),P&&P.m(t,null),r(t,s);for(let V=0;V<I.length;V+=1)I[V]&&I[V].m(t,null);l[33](t),r(e,o),z&&z.m(e,null),r(e,i),r(e,c),r(c,u),r(u,m),r(m,d),r(u,p),r(u,b),r(u,F),r(u,k),l[34](k),we(k,l[4]),r(c,y),D&&D.m(c,null),T||(A=[Z(m,"click",l[15]),Z(k,"input",l[35]),Z(k,"input",l[19]),Z(k,"keydown",l[21])],T=!0)},p(L,M){if(L[3].cli.showTutorialOnStart||L[11]?E?E.p(L,M):(E=Bt(L),E.c(),E.m(t,n)):E&&(E.d(1),E=null),L[3].cli.showTipsOnStart||L[10]?P?P.p(L,M):(P=Nt(L),P.c(),P.m(t,s)):P&&(P.d(1),P=null),M[0]&6){H=ue(L[1]);let V;for(V=0;V<H.length;V+=1){const U=Ot(L,H,V);I[V]?I[V].p(U,M):(I[V]=Jt(U),I[V].c(),I[V].m(t,null))}for(;V<I.length;V+=1)I[V].d(1);I.length=H.length}M[0]&4096&&ie(t,"hidden",!L[12]),L[14]?z?z.p(L,M):(z=Qt(L),z.c(),z.m(e,i)):z&&(z.d(1),z=null),M[0]&4096&&_!==(_=L[12]?"‚ò∞":"‚àí")&&X(d,_),M[0]&4096&&h!==(h=L[12]?"Hide history":"Show history")&&a(m,"title",h),M[0]&4096&&g!==(g=L[12]?"Hide history":"Show history")&&a(m,"aria-label",g),M[0]&4096&&a(m,"aria-pressed",L[12]),M[0]&1&&w!==(w=L[0]?"Generating...":"Enter prompt or /help")&&a(k,"placeholder",w),M[0]&1&&(k.disabled=L[0]),M[0]&16&&k.value!==L[4]&&we(k,L[4]),L[6]?D?D.p(L,M):(D=Kt(L),D.c(),D.m(c,null)):D&&(D.d(1),D=null),M[0]&20480&&ie(c,"no-border",!L[12]&&!L[14]),M[0]&8192&&me(e,"font-size",L[13]),M[0]&4096&&ie(e,"history-hidden",!L[12])},i:$,o:$,d(L){L&&S(e),E&&E.d(),P&&P.d(),ye(I,L),l[33](null),z&&z.d(),l[34](null),D&&D.d(),T=!1,Ae(A)}}}const Ss="Welcome to Z-Explorer! This tutorial will guide you through the app. (Coming soon...)";function Cs(l){const e={count:1,width:1024,height:1024};if(!l.includes(":"))return{prompt:l,params:e};const t=l.split(":"),n=t[t.length-1].trim();if(!/[xhw]\d/.test(n))return{prompt:l,params:e};const s=t.slice(0,-1).join(":").trim();for(const o of n.split(",")){const i=o.trim().toLowerCase();i.startsWith("x")&&(e.count=parseInt(i.slice(1))||1),i.startsWith("h")&&(e.height=parseInt(i.slice(1))||1024),i.startsWith("w")&&(e.width=parseInt(i.slice(1))||1024)}return{prompt:s,params:e}}function Fs(l,e,t){let n,s,o;De(l,je,O=>t(3,o=O));let{isGenerating:i=!1}=e,{isTauriAvailable:c=!1}=e,{getGpuInfo:u=null}=e,{unloadModels:m=null}=e,{listVariables:_=null}=e,{openSettings:d=null}=e;const h=mt();let g="",p=[],b=[],F=!1,k=-1,w,y,T=-1,A=null,E=[],P="0.4.1",H={image_model:"Z-Image-Turbo",image_mode:"loading...",llm_model:"Qwen3-4B",llm_mode:"loading..."};const I=["/help","/vars","/enhance","/seed","/size","/gpu","/unload","/settings","/version","/changelog","/quit","/q"];let z=o.cli.showTipsOnStart,D=o.cli.showTutorialOnStart,L=o.cli.showHistory;function M(){t(12,L=!L),h("historyToggle",{visible:L})}async function V(O){try{const K=await fetch(`${O}/api/health`,{signal:AbortSignal.timeout(2e3)});if(K.ok){const B=await K.json();B.version&&(P=B.version)}const Y=await fetch(`${O}/api/config`,{signal:AbortSignal.timeout(2e3)});if(Y.ok){const B=await Y.json();H=B,t(1,p=p.map(fe=>fe.type==="info"&&fe.text.includes("Image:")?{...fe,text:`üé® Image: ${B.image_model} (${B.image_mode})  ‚Ä¢  ü§ñ LLM: ${B.llm_model} (${B.llm_mode})`}:fe))}}catch{}}async function U(){if(console.log("üìö [FakeCLI] Loading variables..."),_)try{const O=await _();console.log("üìö [FakeCLI] Variables result:",O),O?.success&&O.variables?(E=O.variables.map(K=>K.id),console.log("‚úÖ [FakeCLI] Loaded variables for autocomplete:",E)):console.warn("‚ö†Ô∏è [FakeCLI] No variables returned")}catch(O){console.error("‚ùå [FakeCLI] Could not load variables:",O)}else console.warn("‚ö†Ô∏è [FakeCLI] listVariables prop not provided")}pt(async()=>{t(1,p=[{type:"info",text:`üé® Image: ${H.image_model} (${H.image_mode})  ‚Ä¢  ü§ñ LLM: ${H.llm_model} (${H.llm_mode})`},{type:"success",text:"‚úì All dependencies available"}]),await U(),w?.focus()});function ne(){t(10,z=!z)}function J(){t(11,D=!D)}const re=["‚Ä¢ Use __variable__ syntax for random substitution (e.g., __animal__)","‚Ä¢ Missing variables are auto-generated by the local LLM","‚Ä¢ Add '>' to enhance prompt (e.g., 'a cat > make it magical')","‚Ä¢ Add batch params with ':' (e.g., 'prompt : x10,h832,w1216')"];function j(){const O=w?.selectionStart||0,K=g.slice(0,O);if(K.includes("/")){const Y=K.lastIndexOf("/"),B=K.slice(Y);t(5,b=I.filter(fe=>fe.startsWith(B)&&fe!==B)),t(6,F=b.length>0),console.log(`üîç [Autocomplete] Command suggestions for "${B}":`,b);return}if(K.includes("__")){const Y=K.lastIndexOf("__"),B=K.slice(Y);if(console.log(`üîç [Autocomplete] Looking for variables matching "${B}"`),console.log("üîç [Autocomplete] Available promptVars:",E),(B.match(/__/g)||[]).length===1){t(5,b=E.filter(fe=>fe.startsWith(B)&&fe!==B)),t(6,F=b.length>0),console.log("üîç [Autocomplete] Variable suggestions:",b);return}}t(6,F=!1),t(5,b=[])}function se(O){const K=w?.selectionStart||0,Y=g.slice(0,K);if(Y.includes("/")){const B=Y.lastIndexOf("/");t(4,g=g.slice(0,B)+O+g.slice(K))}else if(Y.includes("__")){const B=Y.lastIndexOf("__");Y.slice(B),t(4,g=g.slice(0,B)+O+g.slice(K))}t(6,F=!1),t(7,k=-1),w?.focus()}function le(O){if(F){if(O.key==="ArrowDown"){O.preventDefault(),t(7,k=Math.min(k+1,b.length-1));return}if(O.key==="ArrowUp"){O.preventDefault(),t(7,k=Math.max(k-1,-1));return}if((O.key==="Tab"||O.key==="Enter")&&k>=0){O.preventDefault(),se(b[k]);return}if(O.key==="Escape"){t(6,F=!1);return}}O.key==="Enter"&&!F&&ve()}function ve(){if(!g.trim()||i)return;const O=g.trim();if(O.startsWith("/")){x(O),t(4,g="");return}const{prompt:K,params:Y}=Cs(O);t(1,p=[...p,{type:"input",text:`>>> ${O}`}]),(Y.count>1||Y.width!==1024||Y.height!==1024)&&t(1,p=[...p,{type:"info",text:`üìê Batch: ${Y.count} image(s) @ ${Y.width}√ó${Y.height}`}]),h("generate",{prompt:K,params:Y,seed:A}),A=null,ge()}function x(O){t(1,p=[...p,{type:"input",text:`>>> ${O}`}]);const[K,...Y]=O.split(" ");switch(K){case"/help":t(1,p=[...p,{type:"header",text:"üìñ Commands"},{type:"table",rows:[{cmd:"/help",desc:"Show this help"},{cmd:"/vars",desc:"List available prompt variables"},{cmd:"/enhance <prompt>",desc:"Enhance a prompt without generating"},{cmd:"/seed <number>",desc:"Set seed for next generation"},{cmd:"/size <WxH>",desc:"Set output size (e.g., 1024x1024)"},{cmd:"/gpu",desc:"Show GPU memory status"},{cmd:"/unload",desc:"Unload models to free GPU memory"},{cmd:"/settings",desc:"Open settings dialog"},{cmd:"/version",desc:"Show version information"},{cmd:"/changelog",desc:"Show recent changes"},{cmd:"/quit or /q",desc:"Exit"}]},{type:"divider"},{type:"cyan",text:"üí° Tips:"},{type:"dim",text:"‚Ä¢ Use __variable__ syntax for random substitution (e.g., __animal__)"},{type:"dim",text:"‚Ä¢ Missing variables are auto-generated by the local LLM"},{type:"dim",text:"‚Ä¢ Add '>' to enhance prompt (e.g., 'a cat > make it magical')"},{type:"dim",text:"‚Ä¢ Add batch params with ':' (e.g., 'prompt : x10,h832,w1216')"},{type:"dim",text:"  x<N>=count, h<N>=height, w<N>=width (all optional)"}]);break;case"/vars":_?(t(1,p=[...p,{type:"cyan",text:"üìã Loading variables..."}]),ge(),_().then(B=>{if(B?.success&&B.variables){const fe=B.variables.map(ke=>({id:ke.id,count:ke.count,sample:ke.sample?.slice(0,3).join(", ")||""}));t(1,p=[...p,{type:"header",text:`üìã ${B.count} Variables Available`},{type:"varsTable",rows:fe}]),E=B.variables.map(ke=>ke.id)}else t(1,p=[...p,{type:"error",text:"‚ùå Failed to load variables"}]);ge()})):t(1,p=[...p,{type:"header",text:"üìã Available Variables"},{type:"divider"},...E.map(B=>({type:"magenta",text:`  ${B}`}))]);break;case"/enhance":Y.length>0?t(1,p=[...p,{type:"cyan",text:"ü§ñ Enhancing prompt with local LLM..."},{type:"dim",text:"(Enhancement will be applied during generation)"}]):t(1,p=[...p,{type:"error",text:"‚ùå Usage: /enhance <prompt>"}]);break;case"/seed":if(Y.length>0){const B=parseInt(Y[0]);!isNaN(B)&&B>=0?(A=B,t(1,p=[...p,{type:"success",text:`‚úì Seed set to: ${B}`},{type:"dim",text:"(Will be used for next generation, then reset)"}])):t(1,p=[...p,{type:"error",text:"‚ùå Invalid seed (must be a positive number)"}])}else A=null,t(1,p=[...p,{type:"cyan",text:"üé≤ Seed reset to random"}]);break;case"/size":if(Y.length>0){const B=Y[0].toLowerCase().match(/(\d+)x(\d+)/);B?t(1,p=[...p,{type:"success",text:`‚úì Size set to: ${B[1]}√ó${B[2]}`}]):t(1,p=[...p,{type:"error",text:"‚ùå Invalid size format. Use: /size 1024x1024"}])}else t(1,p=[...p,{type:"cyan",text:"üìê Current size: 1024√ó1024"}]);break;case"/gpu":u?(t(1,p=[...p,{type:"cyan",text:"üñ•Ô∏è Fetching GPU info..."}]),ge(),u().then(B=>{B?.available?t(1,p=[...p,{type:"header",text:"üñ•Ô∏è GPU Memory Status"},{type:"success",text:`Device: ${B.device_name}`},{type:"info",text:`Allocated: ${B.allocated_gb} GB`},{type:"info",text:`Reserved: ${B.reserved_gb} GB`},{type:"info",text:`Total: ${B.total_gb} GB`},{type:"cyan",text:`Free: ${B.free_gb} GB`}]):t(1,p=[...p,{type:"error",text:`‚ùå ${B?.error||"GPU not available"}`}]),ge()})):t(1,p=[...p,{type:"dim",text:"(GPU info not available in demo mode)"}]);break;case"/unload":m?(t(1,p=[...p,{type:"cyan",text:"üîÑ Unloading models..."}]),ge(),m().then(B=>{if(B?.success){const fe=[];B.llm_unloaded&&fe.push("LLM (Qwen3-4B)"),B.image_model_unloaded&&fe.push("Image model (Z-Image-Turbo)"),B.cuda_cache_cleared&&fe.push("CUDA cache"),fe.length>0?t(1,p=[...p,{type:"success",text:"‚úì Models unloaded successfully"},{type:"dim",text:`Unloaded: ${fe.join(", ")}`},{type:"dim",text:"(Models will reload on next generation)"}]):t(1,p=[...p,{type:"info",text:"‚ÑπÔ∏è No models were loaded"}])}else t(1,p=[...p,{type:"error",text:"‚ùå Failed to unload models"}]);ge()})):t(1,p=[...p,{type:"dim",text:"(Unload not available in demo mode)"}]);break;case"/version":t(1,p=[...p,{type:"header",text:`‚ö° Z-Explorer v${P}`},{type:"dim",text:"AI Image Generation Without the UI Tax"},{type:"info",text:"Z-Image-Turbo + Qwen3-4B"},{type:"divider"},{type:"dim",text:"GitHub: github.com/pyros-projects/z-Explorer"}]);break;case"/changelog":t(1,p=[...p,{type:"header",text:"üìã Changelog"},{type:"cyan",text:`v${P} - Desktop GUI Integration`},{type:"divider"},{type:"success",text:"‚ú® Added:"},{type:"dim",text:"‚Ä¢ Native desktop app via Tauri with bundled uv binary"},{type:"dim",text:"‚Ä¢ Three modes: GUI (default), CLI (--cli), Server (--server)"},{type:"dim",text:"‚Ä¢ Progress streaming via Server-Sent Events (SSE)"},{type:"dim",text:"‚Ä¢ Masonry gallery layout for generated images"},{type:"dim",text:"‚Ä¢ Prompt saved alongside images as .txt files"},{type:"dim",text:"‚Ä¢ Variable autocomplete in CLI-style input"},{type:"dim",text:"‚Ä¢ /changelog and /version commands"},{type:"divider"},{type:"info",text:"üîÑ Changed:"},{type:"dim",text:"‚Ä¢ Default mode is now GUI (previously CLI-only)"},{type:"dim",text:"‚Ä¢ Server port standardized to 8345"},{type:"divider"},{type:"dim",text:"Full changelog: github.com/pyros-projects/z-Explorer/blob/main/CHANGELOG.md"}]);break;case"/settings":d?(t(1,p=[...p,{type:"cyan",text:"‚öôÔ∏è Opening settings..."}]),d()):t(1,p=[...p,{type:"dim",text:"(Settings not available in this mode)"}]);break;case"/quit":case"/q":t(1,p=[...p,{type:"cyan",text:"üëã Goodbye! (Close the window to exit)"}]);break;default:t(1,p=[...p,{type:"error",text:`‚ùå Unknown command: ${K}`},{type:"dim",text:"Type /help for available commands"}])}ge()}function ge(){setTimeout(()=>{y&&t(9,y.scrollTop=y.scrollHeight,y)},10)}function Ce(O,K=!1){t(1,p=[...p,{type:K?"error":"output",text:O}]),ge()}const be={starting:"üöÄ",loading_vars:"üìã",substituting:"üîÑ",var_missing:"‚ö†Ô∏è",var_generating:"ü§ñ",var_saved:"üíæ",enhancing:"‚ú®",enhanced:"üí°",phase1_complete:"üìù",final_prompt:"üìú",llm_unloaded:"üßπ",loading_image_model:"üé®",generating_image:"üñºÔ∏è",diffusion_step:"‚ö°",generating_steps:"‚ö°",image_saved:"üíæ",complete:"‚úÖ",error:"‚ùå"},G=new Set(["diffusion_step","generating_steps"]);function Q(){console.log("üé¨ [FakeCLI] startGeneration() called"),t(2,T=p.length),t(1,p=[...p,{type:"progress-bar",percent:0,stage:"starting"}]),console.log("üìä [FakeCLI] Progress bar added at index:",T),ge()}function oe(O,K,Y){if(console.log(`üìà [FakeCLI] updateProgress(${O}%, ${K}, "${Y}")`),T>=0&&T<p.length?(t(1,p[T]={type:"progress-bar",percent:O,stage:K},p),t(1,p=[...p]),console.log(`üìä [FakeCLI] Progress bar updated: ${O}% - ${K}`)):console.warn("‚ö†Ô∏è [FakeCLI] Progress bar index invalid:",T),Y&&!G.has(K)){const B=be[K]||"‚ö°";K==="enhanced"?console.log("üí° [FakeCLI] Skipping enhanced prompt display (will show in final)"):K==="final_prompt"?(t(1,p=[...p,{type:"prompt-highlight",variant:"final",text:Y}]),console.log(`üìú [FakeCLI] Added final prompt: ${Y.substring(0,50)}...`)):(t(1,p=[...p,{type:"progress-msg",text:`${B} ${Y}`}]),console.log(`üí¨ [FakeCLI] Added progress message: ${B} ${Y}`))}else G.has(K)&&console.log(`üîá [FakeCLI] Silent stage, only updating bar: ${K}`);ge()}function te(O){console.log(`üèÅ [FakeCLI] completeGeneration(success=${O})`),T>=0&&T<p.length&&(t(1,p[T]={type:"progress-bar",percent:100,stage:O?"complete":"error"},p),t(1,p=[...p]),console.log("‚úÖ [FakeCLI] Progress bar set to complete")),t(2,T=-1),ge()}function ee(){te(!0)}const ae={small:"11px",medium:"13px",large:"15px"};function de(O){tt[O?"unshift":"push"](()=>{y=O,t(9,y)})}function q(O){tt[O?"unshift":"push"](()=>{w=O,t(8,w)})}function he(){g=this.value,t(4,g)}const Me=O=>se(O);return l.$$set=O=>{"isGenerating"in O&&t(0,i=O.isGenerating),"isTauriAvailable"in O&&t(22,c=O.isTauriAvailable),"getGpuInfo"in O&&t(23,u=O.getGpuInfo),"unloadModels"in O&&t(24,m=O.unloadModels),"listVariables"in O&&t(25,_=O.listVariables),"openSettings"in O&&t(26,d=O.openSettings)},l.$$.update=()=>{l.$$.dirty[0]&6&&t(14,n=(()=>{if(T>=0&&T<p.length){const O=p[T];if(O.type==="progress-bar")return O}return null})()),l.$$.dirty[0]&8&&t(13,s=ae[o.cli.fontSize]||"13px")},[i,p,T,o,g,b,F,k,w,y,z,D,L,s,n,M,ne,J,re,j,se,le,c,u,m,_,d,V,Ce,Q,oe,te,ee,de,q,he,Me]}class Es extends Be{constructor(e){super(),ze(this,e,Fs,ys,Ge,{isGenerating:0,isTauriAvailable:22,getGpuInfo:23,unloadModels:24,listVariables:25,openSettings:26,fetchVersion:27,addResult:28,startGeneration:29,updateProgress:30,completeGeneration:31,clearProgress:32},null,[-1,-1,-1])}get fetchVersion(){return this.$$.ctx[27]}get addResult(){return this.$$.ctx[28]}get startGeneration(){return this.$$.ctx[29]}get updateProgress(){return this.$$.ctx[30]}get completeGeneration(){return this.$$.ctx[31]}get clearProgress(){return this.$$.ctx[32]}}function Xt(l,e,t){const n=l.slice();return n[17]=e[t],n}function xt(l,e,t){const n=l.slice();return n[17]=e[t],n}function As(l){let e,t,n,s,o,i,c,u,m,_,d,h,g=ue(l[5]),p=[];for(let b=0;b<g.length;b+=1)p[b]=$t(Xt(l,g,b));return{c(){e=f("div"),t=f("h2"),t.textContent="Models Required",n=v(),s=f("p"),s.textContent="Z-Explorer needs to download AI models (~5-10 GB) to generate images locally.",o=v(),i=f("div");for(let b=0;b<p.length;b+=1)p[b].c();c=v(),u=f("button"),u.innerHTML='<span>Download Models</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-oswxo2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"></path></svg>',m=v(),_=f("p"),_.textContent="Models are cached locally for offline use",a(t,"class","svelte-oswxo2"),a(s,"class","info-text svelte-oswxo2"),a(i,"class","models-list svelte-oswxo2"),a(u,"class","primary-btn svelte-oswxo2"),a(_,"class","storage-hint svelte-oswxo2"),a(e,"class","ready-state svelte-oswxo2")},m(b,F){C(b,e,F),r(e,t),r(e,n),r(e,s),r(e,o),r(e,i);for(let k=0;k<p.length;k+=1)p[k]&&p[k].m(i,null);r(e,c),r(e,u),r(e,m),r(e,_),d||(h=Z(u,"click",l[9]),d=!0)},p(b,F){if(F&96){g=ue(b[5]);let k;for(k=0;k<g.length;k+=1){const w=Xt(b,g,k);p[k]?p[k].p(w,F):(p[k]=$t(w),p[k].c(),p[k].m(i,null))}for(;k<p.length;k+=1)p[k].d(1);p.length=g.length}},d(b){b&&S(e),ye(p,b),d=!1,h()}}}function Ts(l){let e,t,n,s,o,i,c,u=l[7]&&el(l),m=ue(l[5]),_=[];for(let d=0;d<m.length;d+=1)_[d]=ol(xt(l,m,d));return{c(){e=f("div"),t=f("h2"),t.textContent="Downloading Models",n=v(),u&&u.c(),s=v(),o=f("div");for(let d=0;d<_.length;d+=1)_[d].c();i=v(),c=f("p"),c.textContent="This may take several minutes depending on your connection",a(t,"class","svelte-oswxo2"),a(o,"class","models-list svelte-oswxo2"),a(c,"class","download-hint svelte-oswxo2"),a(e,"class","download-state svelte-oswxo2")},m(d,h){C(d,e,h),r(e,t),r(e,n),u&&u.m(e,null),r(e,s),r(e,o);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(o,null);r(e,i),r(e,c)},p(d,h){if(d[7]?u?u.p(d,h):(u=el(d),u.c(),u.m(e,s)):u&&(u.d(1),u=null),h&416){m=ue(d[5]);let g;for(g=0;g<m.length;g+=1){const p=xt(d,m,g);_[g]?_[g].p(p,h):(_[g]=ol(p),_[g].c(),_[g].m(o,null))}for(;g<_.length;g+=1)_[g].d(1);_.length=m.length}},d(d){d&&S(e),u&&u.d(),ye(_,d)}}}function Ls(l){let e,t,n,s,o,i,c=(l[4]||"An error occurred")+"",u,m,_,d,h;return{c(){e=f("div"),t=f("div"),t.textContent="!",n=v(),s=f("h2"),s.textContent="Download Failed",o=v(),i=f("p"),u=R(c),m=v(),_=f("button"),_.textContent="Retry Download",a(t,"class","error-icon svelte-oswxo2"),a(s,"class","svelte-oswxo2"),a(i,"class","error-message svelte-oswxo2"),a(_,"class","primary-btn svelte-oswxo2"),a(e,"class","error-state svelte-oswxo2")},m(g,p){C(g,e,p),r(e,t),r(e,n),r(e,s),r(e,o),r(e,i),r(i,u),r(e,m),r(e,_),d||(h=Z(_,"click",l[11]),d=!0)},p(g,p){p&16&&c!==(c=(g[4]||"An error occurred")+"")&&X(u,c)},d(g){g&&S(e),d=!1,h()}}}function Ms(l){let e,t,n,s,o,i,c,u,m,_;return{c(){e=f("div"),t=f("div"),t.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="svelte-oswxo2"><polyline points="20 6 9 17 4 12"></polyline></svg>',n=v(),s=f("h2"),s.textContent="Ready to Create",o=v(),i=f("p"),i.textContent="All models downloaded. Let's make some art.",c=v(),u=f("button"),u.innerHTML='<span>Start Creating</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-oswxo2"><path d="M5 12h14M12 5l7 7-7 7"></path></svg>',a(t,"class","success-icon svelte-oswxo2"),a(s,"class","svelte-oswxo2"),a(i,"class","svelte-oswxo2"),a(u,"class","primary-btn svelte-oswxo2"),a(e,"class","complete-state svelte-oswxo2")},m(d,h){C(d,e,h),r(e,t),r(e,n),r(e,s),r(e,o),r(e,i),r(e,c),r(e,u),m||(_=Z(u,"click",l[10]),m=!0)},p:$,d(d){d&&S(e),m=!1,_()}}}function Hs(l){let e;return{c(){e=f("div"),e.innerHTML='<div class="spinner svelte-oswxo2"></div> <p class="svelte-oswxo2">Initializing...</p>',a(e,"class","loading-state svelte-oswxo2")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function $t(l){let e,t,n=l[6][l[17].name]?"‚úì":"‚óã",s,o,i,c,u=l[17].repo_id+"",m,_;return{c(){e=f("div"),t=f("span"),s=R(n),o=v(),i=f("div"),c=f("span"),m=R(u),_=v(),a(t,"class","model-check svelte-oswxo2"),a(c,"class","model-label svelte-oswxo2"),a(i,"class","model-info svelte-oswxo2"),a(e,"class","model-item svelte-oswxo2"),ie(e,"downloaded",l[6][l[17].name])},m(d,h){C(d,e,h),r(e,t),r(t,s),r(e,o),r(e,i),r(i,c),r(c,m),r(e,_)},p(d,h){h&96&&n!==(n=d[6][d[17].name]?"‚úì":"‚óã")&&X(s,n),h&32&&u!==(u=d[17].repo_id+"")&&X(m,u),h&96&&ie(e,"downloaded",d[6][d[17].name])},d(d){d&&S(e)}}}function el(l){let e,t,n,s=l[7].model_name+"",o,i,c,u=l[7].status+"",m,_,d,h,g,p,b,F,k,w,y;function T(D,L){return D[7].progress_percent>0?Ps:Is}let A=T(l),E=A(l),P=l[7].bytes_total>0&&tl(l),H=l[7].speed_mbps>0&&ll(l),I=l[7].eta_seconds&&nl(l),z=l[7].current_file&&sl(l);return{c(){e=f("div"),t=f("div"),n=f("span"),o=R(s),i=v(),c=f("span"),m=R(u),_=v(),d=f("div"),h=f("div"),g=v(),p=f("div"),b=f("span"),E.c(),F=v(),P&&P.c(),k=v(),H&&H.c(),w=v(),I&&I.c(),y=v(),z&&z.c(),a(n,"class","model-name svelte-oswxo2"),a(c,"class","model-status svelte-oswxo2"),a(t,"class","model-header svelte-oswxo2"),a(h,"class","progress-bar svelte-oswxo2"),me(h,"width",(l[7].progress_percent>0?l[7].progress_percent:100)+"%"),ie(h,"indeterminate",l[7].progress_percent<1&&l[7].status==="downloading"),a(d,"class","progress-bar-container svelte-oswxo2"),a(b,"class","progress-percent svelte-oswxo2"),a(p,"class","progress-details svelte-oswxo2"),a(e,"class","current-model svelte-oswxo2")},m(D,L){C(D,e,L),r(e,t),r(t,n),r(n,o),r(t,i),r(t,c),r(c,m),r(e,_),r(e,d),r(d,h),r(e,g),r(e,p),r(p,b),E.m(b,null),r(p,F),P&&P.m(p,null),r(p,k),H&&H.m(p,null),r(p,w),I&&I.m(p,null),r(e,y),z&&z.m(e,null)},p(D,L){L&128&&s!==(s=D[7].model_name+"")&&X(o,s),L&128&&u!==(u=D[7].status+"")&&X(m,u),L&128&&me(h,"width",(D[7].progress_percent>0?D[7].progress_percent:100)+"%"),L&128&&ie(h,"indeterminate",D[7].progress_percent<1&&D[7].status==="downloading"),A===(A=T(D))&&E?E.p(D,L):(E.d(1),E=A(D),E&&(E.c(),E.m(b,null))),D[7].bytes_total>0?P?P.p(D,L):(P=tl(D),P.c(),P.m(p,k)):P&&(P.d(1),P=null),D[7].speed_mbps>0?H?H.p(D,L):(H=ll(D),H.c(),H.m(p,w)):H&&(H.d(1),H=null),D[7].eta_seconds?I?I.p(D,L):(I=nl(D),I.c(),I.m(p,null)):I&&(I.d(1),I=null),D[7].current_file?z?z.p(D,L):(z=sl(D),z.c(),z.m(e,null)):z&&(z.d(1),z=null)},d(D){D&&S(e),E.d(),P&&P.d(),H&&H.d(),I&&I.d(),z&&z.d()}}}function Is(l){let e;return{c(){e=R("Downloading...")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function Ps(l){let e=l[7].progress_percent.toFixed(1)+"",t,n;return{c(){t=R(e),n=R("%")},m(s,o){C(s,t,o),C(s,n,o)},p(s,o){o&128&&e!==(e=s[7].progress_percent.toFixed(1)+"")&&X(t,e)},d(s){s&&(S(t),S(n))}}}function tl(l){let e,t=nt(l[7].bytes_done)+"",n,s,o=nt(l[7].bytes_total)+"",i;return{c(){e=f("span"),n=R(t),s=R(" / "),i=R(o),a(e,"class","progress-size")},m(c,u){C(c,e,u),r(e,n),r(e,s),r(e,i)},p(c,u){u&128&&t!==(t=nt(c[7].bytes_done)+"")&&X(n,t),u&128&&o!==(o=nt(c[7].bytes_total)+"")&&X(i,o)},d(c){c&&S(e)}}}function ll(l){let e,t=l[7].speed_mbps.toFixed(1)+"",n,s;return{c(){e=f("span"),n=R(t),s=R(" MB/s"),a(e,"class","progress-speed")},m(o,i){C(o,e,i),r(e,n),r(e,s)},p(o,i){i&128&&t!==(t=o[7].speed_mbps.toFixed(1)+"")&&X(n,t)},d(o){o&&S(e)}}}function nl(l){let e,t,n=il(l[7].eta_seconds)+"",s;return{c(){e=f("span"),t=R("ETA: "),s=R(n),a(e,"class","progress-eta")},m(o,i){C(o,e,i),r(e,t),r(e,s)},p(o,i){i&128&&n!==(n=il(o[7].eta_seconds)+"")&&X(s,n)},d(o){o&&S(e)}}}function sl(l){let e,t=l[7].current_file+"",n;return{c(){e=f("div"),n=R(t),a(e,"class","current-file svelte-oswxo2")},m(s,o){C(s,e,o),r(e,n)},p(s,o){o&128&&t!==(t=s[7].current_file+"")&&X(n,t)},d(s){s&&S(e)}}}function Gs(l){let e;return{c(){e=R("‚óã")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function Os(l){let e;return{c(){e=R("‚óè")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function Rs(l){let e;return{c(){e=R("‚úì")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function ol(l){let e,t,n,s,o,i=l[17].name+"",c,u;function m(h,g){return g&288&&(n=null),n==null&&(n=!!h[8].includes(h[17].name)),n?Rs:h[7]?.model_name===h[17].name?Os:Gs}let _=m(l,-1),d=_(l);return{c(){e=f("div"),t=f("span"),d.c(),s=v(),o=f("span"),c=R(i),u=v(),a(t,"class","model-check svelte-oswxo2"),a(o,"class","model-label svelte-oswxo2"),a(e,"class","model-item svelte-oswxo2"),ie(e,"completed",l[8].includes(l[17].name)),ie(e,"active",l[7]?.model_name===l[17].name)},m(h,g){C(h,e,g),r(e,t),d.m(t,null),r(e,s),r(e,o),r(o,c),r(e,u)},p(h,g){_!==(_=m(h,g))&&(d.d(1),d=_(h),d&&(d.c(),d.m(t,null))),g&32&&i!==(i=h[17].name+"")&&X(c,i),g&288&&ie(e,"completed",h[8].includes(h[17].name)),g&160&&ie(e,"active",h[7]?.model_name===h[17].name)},d(h){h&&S(e),d.d()}}}function Ds(l){let e,t,n,s,o,i,c,u;function m(h,g){return h[0]?Hs:h[2]?Ms:h[3]?Ls:h[1]?Ts:As}let _=m(l),d=_(l);return{c(){e=f("div"),t=f("div"),n=f("div"),n.innerHTML='<img src="/assets/icon.jpg" alt="Z-Explorer" class="logo-img svelte-oswxo2"/> <h1 class="svelte-oswxo2">Z-Explorer</h1> <p class="subtitle svelte-oswxo2">Local AI Image Generation</p>',s=v(),d.c(),o=v(),i=f("div"),c=v(),u=f("div"),a(n,"class","header svelte-oswxo2"),a(t,"class","setup-card svelte-oswxo2"),a(i,"class","bg-glow svelte-oswxo2"),a(u,"class","bg-glow-2 svelte-oswxo2"),a(e,"class","setup-container svelte-oswxo2")},m(h,g){C(h,e,g),r(e,t),r(t,n),r(t,s),d.m(t,null),r(e,o),r(e,i),r(e,c),r(e,u)},p(h,[g]){_===(_=m(h))&&d?d.p(h,g):(d.d(1),d=_(h),d&&(d.c(),d.m(t,null)))},i:$,o:$,d(h){h&&S(e),d.d()}}}function nt(l){if(l===0)return"0 B";const e=1024,t=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,n)).toFixed(2))+" "+t[n]}function il(l){if(!l||l<=0)return"--:--";const e=Math.floor(l/60),t=Math.floor(l%60);return`${e}:${t.toString().padStart(2,"0")}`}function zs(l,e,t){let{apiBase:n=""}=e;const s=mt();let o=!0,i=!1,c=!1,u=!1,m="",_=[],d={},h=null,g=[],p=null,b=!1;async function F(){try{const T=await fetch(`${n}/api/setup/status`);if(T.ok){const A=await T.json();t(5,_=A.models_needed||[]),t(6,d=A.models_downloaded||{}),_.every(P=>d[P.name])&&_.length>0&&t(2,c=!0)}}catch(T){console.error("Failed to check setup status:",T)}finally{t(0,o=!1)}}function k(){i||(t(1,i=!0),t(3,u=!1),t(4,m=""),t(8,g=[]),b=!1,p=new EventSource(`${n}/api/setup/download`),p.onmessage=T=>{try{const A=JSON.parse(T.data);if(A.status==="all_complete"||A.status==="error"){b=!0,t(2,c=A.success),t(3,u=!A.success),!A.success&&A.message&&!m&&t(4,m=A.message),t(1,i=!1),p?.close();return}t(7,h=A),A.status==="complete"&&A.model_name&&(g.includes(A.model_name)||t(8,g=[...g,A.model_name])),A.status==="error"&&A.error&&(t(3,u=!0),t(4,m=A.error),t(1,i=!1),p?.close())}catch(A){console.error("Failed to parse download progress:",A)}},p.onerror=T=>{b||(console.error("Download SSE error:",T),t(3,u=!0),t(4,m="Connection to server lost"),t(1,i=!1)),p?.close()})}function w(){s("complete")}function y(){t(3,u=!1),t(4,m=""),k()}return pt(()=>{F()}),Wl(()=>{p?.close()}),l.$$set=T=>{"apiBase"in T&&t(12,n=T.apiBase)},[o,i,c,u,m,_,d,h,g,k,w,y,n]}class Bs extends Be{constructor(e){super(),ze(this,e,zs,Ds,Ge,{apiBase:12})}}function rl(l,e,t){const n=l.slice();return n[73]=e[t],n}function al(l,e,t){const n=l.slice();return n[73]=e[t],n}function cl(l,e,t){const n=l.slice();return n[73]=e[t],n}function ul(l,e,t){const n=l.slice();return n[73]=e[t],n}function fl(l,e,t){const n=l.slice();return n[70]=e[t],n}function dl(l,e,t){const n=l.slice();return n[73]=e[t],n}function pl(l){let e,t,n,s,o,i,c,u,m,_,d,h,g,p,b,F,k,w,y,T,A,E,P,H,I,z,D,L,M,V,U,ne,J,re,j,se,le,ve,x;function ge(ee,ae){if(ee[3]==="gallery")return Us;if(ee[3]==="cli")return Vs;if(ee[3]==="generation")return Ns;if(ee[3]==="models")return js}let Ce=ge(l),be=Ce&&Ce(l);function G(ee,ae){return ee[17]?Zs:Ws}let Q=G(l),oe=Q(l),te=l[5]&&Ol(l);return{c(){e=f("div"),t=f("div"),n=f("div"),s=f("h2"),s.textContent="Settings",o=v(),i=f("button"),i.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"></path></svg>',c=v(),u=f("div"),m=f("button"),_=R("Gallery"),h=v(),g=f("button"),p=R("CLI"),F=v(),k=f("button"),w=R("Generation"),T=v(),A=f("button"),E=R("Models"),H=v(),I=f("div"),be&&be.c(),z=v(),D=f("div"),L=f("button"),M=R("Reset to Defaults"),V=v(),U=f("div"),ne=f("button"),J=R("Cancel"),re=v(),j=f("button"),oe.c(),le=v(),te&&te.c(),a(s,"id","settings-title"),a(s,"class","svelte-bonvfl"),a(i,"class","close-btn svelte-bonvfl"),a(i,"aria-label","Close settings"),a(n,"class","settings-header svelte-bonvfl"),a(m,"role","tab"),a(m,"aria-selected",d=l[3]==="gallery"),a(m,"class","svelte-bonvfl"),ie(m,"active",l[3]==="gallery"),a(g,"role","tab"),a(g,"aria-selected",b=l[3]==="cli"),a(g,"class","svelte-bonvfl"),ie(g,"active",l[3]==="cli"),a(k,"role","tab"),a(k,"aria-selected",y=l[3]==="generation"),a(k,"class","svelte-bonvfl"),ie(k,"active",l[3]==="generation"),a(A,"role","tab"),a(A,"aria-selected",P=l[3]==="models"),a(A,"class","svelte-bonvfl"),ie(A,"active",l[3]==="models"),a(u,"class","tabs svelte-bonvfl"),a(u,"role","tablist"),a(I,"class","tab-content svelte-bonvfl"),a(L,"class","btn btn-secondary svelte-bonvfl"),L.disabled=l[17],a(ne,"class","btn btn-ghost svelte-bonvfl"),ne.disabled=l[17],a(j,"class","btn btn-primary svelte-bonvfl"),j.disabled=se=l[20]||l[17],a(U,"class","footer-right svelte-bonvfl"),a(D,"class","settings-footer svelte-bonvfl"),a(t,"class","settings-dialog svelte-bonvfl"),a(t,"data-testid","settings-content"),a(e,"class","settings-overlay svelte-bonvfl"),a(e,"role","dialog"),a(e,"aria-modal","true"),a(e,"aria-labelledby","settings-title"),a(e,"data-testid","settings-overlay")},m(ee,ae){C(ee,e,ae),r(e,t),r(t,n),r(n,s),r(n,o),r(n,i),r(t,c),r(t,u),r(u,m),r(m,_),r(u,h),r(u,g),r(g,p),r(u,F),r(u,k),r(k,w),r(u,T),r(u,A),r(A,E),r(t,H),r(t,I),be&&be.m(I,null),r(t,z),r(t,D),r(D,L),r(L,M),r(D,V),r(D,U),r(U,ne),r(ne,J),r(U,re),r(U,j),oe.m(j,null),r(t,le),te&&te.m(t,null),ve||(x=[Z(i,"click",function(){rt(l[1])&&l[1].apply(this,arguments)}),Z(m,"click",l[41]),Z(g,"click",l[42]),Z(k,"click",l[43]),Z(A,"click",l[44]),Z(L,"click",l[32]),Z(ne,"click",l[31]),Z(j,"click",l[30]),Z(t,"click",ql(l[40])),Z(e,"click",l[36]),Z(e,"keydown",l[35])],ve=!0)},p(ee,ae){l=ee,ae[0]&8&&d!==(d=l[3]==="gallery")&&a(m,"aria-selected",d),ae[0]&8&&ie(m,"active",l[3]==="gallery"),ae[0]&8&&b!==(b=l[3]==="cli")&&a(g,"aria-selected",b),ae[0]&8&&ie(g,"active",l[3]==="cli"),ae[0]&8&&y!==(y=l[3]==="generation")&&a(k,"aria-selected",y),ae[0]&8&&ie(k,"active",l[3]==="generation"),ae[0]&8&&P!==(P=l[3]==="models")&&a(A,"aria-selected",P),ae[0]&8&&ie(A,"active",l[3]==="models"),Ce===(Ce=ge(l))&&be?be.p(l,ae):(be&&be.d(1),be=Ce&&Ce(l),be&&(be.c(),be.m(I,null))),ae[0]&131072&&(L.disabled=l[17]),ae[0]&131072&&(ne.disabled=l[17]),Q!==(Q=G(l))&&(oe.d(1),oe=Q(l),oe&&(oe.c(),oe.m(j,null))),ae[0]&1179648&&se!==(se=l[20]||l[17])&&(j.disabled=se),l[5]?te?te.p(l,ae):(te=Ol(l),te.c(),te.m(t,null)):te&&(te.d(1),te=null)},d(ee){ee&&S(e),be&&be.d(),oe.d(),te&&te.d(),ve=!1,Ae(x)}}}function js(l){let e,t,n,s,o,i,c,u,m,_,d,h=st(l[6]),g,p=ot(l[6]),b,F,k,w,y,T,A,E,P,H,I=st(l[9]),z,D=ot(l[9]),L,M,V,U,ne=l[12]?"Testing...":"Test Connection",J,re,j,se=l[14]?"Reloading...":"Reload Models",le,ve,x,ge,Ce,be,G,Q,oe,te,ee=l[16]&&ml(),ae=ue(l[25]),de=[];for(let N=0;N<ae.length;N+=1)de[N]=gl(al(l,ae,N));let q=h&&hl(l),he=p&&_l(l),Me=ue(l[26]),O=[];for(let N=0;N<Me.length;N+=1)O[N]=vl(rl(l,Me,N));let K=I&&bl(l),Y=D&&kl(l),B=l[13]&&wl(l),fe=l[15]&&yl(l),ke=l[17]&&l[18]&&Cl(l),Fe=l[19]&&Tl(l);return{c(){e=f("div"),ee&&ee.c(),t=v(),n=f("div"),s=f("h3"),s.textContent="Image Model",o=v(),i=f("div"),c=f("div"),u=f("label"),u.textContent="Mode",m=v(),_=f("select");for(let N=0;N<de.length;N+=1)de[N].c();d=v(),q&&q.c(),g=v(),he&&he.c(),b=v(),F=f("div"),k=f("h3"),k.textContent="LLM Model",w=v(),y=f("div"),T=f("div"),A=f("label"),A.textContent="Mode",E=v(),P=f("select");for(let N=0;N<O.length;N+=1)O[N].c();H=v(),K&&K.c(),z=v(),Y&&Y.c(),L=v(),M=f("div"),V=f("div"),U=f("button"),J=R(ne),re=v(),j=f("button"),le=R(se),x=v(),B&&B.c(),ge=v(),fe&&fe.c(),Ce=v(),be=f("p"),be.textContent=`üí° Changes override your .env configuration for this session only.\r
                They are stored in localStorage and do NOT modify your .env file.`,G=v(),ke&&ke.c(),Q=v(),Fe&&Fe.c(),a(s,"class","svelte-bonvfl"),a(u,"for","image-mode"),a(u,"class","svelte-bonvfl"),a(_,"id","image-mode"),a(_,"data-testid","image-mode-select"),a(_,"class","svelte-bonvfl"),l[6]===void 0&&xe(()=>l[58].call(_)),a(c,"class","input-row svelte-bonvfl"),a(i,"class","model-config svelte-bonvfl"),a(n,"class","setting-group svelte-bonvfl"),a(k,"class","svelte-bonvfl"),a(A,"for","llm-mode"),a(A,"class","svelte-bonvfl"),a(P,"id","llm-mode"),a(P,"data-testid","llm-mode-select"),a(P,"class","svelte-bonvfl"),l[9]===void 0&&xe(()=>l[61].call(P)),a(T,"class","input-row svelte-bonvfl"),a(y,"class","model-config svelte-bonvfl"),a(F,"class","setting-group svelte-bonvfl"),a(U,"class","btn btn-secondary svelte-bonvfl"),U.disabled=l[12],a(j,"class","btn btn-primary svelte-bonvfl"),j.disabled=ve=l[14]||!l[13]?.valid,a(V,"class","action-buttons svelte-bonvfl"),a(be,"class","model-hint svelte-bonvfl"),a(M,"class","setting-group model-actions svelte-bonvfl"),a(e,"class","tab-panel svelte-bonvfl"),a(e,"role","tabpanel")},m(N,_e){C(N,e,_e),ee&&ee.m(e,null),r(e,t),r(e,n),r(n,s),r(n,o),r(n,i),r(i,c),r(c,u),r(c,m),r(c,_);for(let ce=0;ce<de.length;ce+=1)de[ce]&&de[ce].m(_,null);Qe(_,l[6],!0),r(i,d),q&&q.m(i,null),r(i,g),he&&he.m(i,null),r(e,b),r(e,F),r(F,k),r(F,w),r(F,y),r(y,T),r(T,A),r(T,E),r(T,P);for(let ce=0;ce<O.length;ce+=1)O[ce]&&O[ce].m(P,null);Qe(P,l[9],!0),r(y,H),K&&K.m(y,null),r(y,z),Y&&Y.m(y,null),r(e,L),r(e,M),r(M,V),r(V,U),r(U,J),r(V,re),r(V,j),r(j,le),r(M,x),B&&B.m(M,null),r(M,ge),fe&&fe.m(M,null),r(M,Ce),r(M,be),r(M,G),ke&&ke.m(M,null),r(M,Q),Fe&&Fe.m(M,null),oe||(te=[Z(_,"change",l[58]),Z(P,"change",l[61]),Z(U,"click",l[37]),Z(j,"click",l[38])],oe=!0)},p(N,_e){if(N[16]?ee||(ee=ml(),ee.c(),ee.m(e,t)):ee&&(ee.d(1),ee=null),_e[0]&33554432){ae=ue(N[25]);let ce;for(ce=0;ce<ae.length;ce+=1){const Ve=al(N,ae,ce);de[ce]?de[ce].p(Ve,_e):(de[ce]=gl(Ve),de[ce].c(),de[ce].m(_,null))}for(;ce<de.length;ce+=1)de[ce].d(1);de.length=ae.length}if(_e[0]&33554496&&Qe(_,N[6]),_e[0]&64&&(h=st(N[6])),h?q?q.p(N,_e):(q=hl(N),q.c(),q.m(i,g)):q&&(q.d(1),q=null),_e[0]&64&&(p=ot(N[6])),p?he?he.p(N,_e):(he=_l(N),he.c(),he.m(i,null)):he&&(he.d(1),he=null),_e[0]&67108864){Me=ue(N[26]);let ce;for(ce=0;ce<Me.length;ce+=1){const Ve=rl(N,Me,ce);O[ce]?O[ce].p(Ve,_e):(O[ce]=vl(Ve),O[ce].c(),O[ce].m(P,null))}for(;ce<O.length;ce+=1)O[ce].d(1);O.length=Me.length}_e[0]&67109376&&Qe(P,N[9]),_e[0]&512&&(I=st(N[9])),I?K?K.p(N,_e):(K=bl(N),K.c(),K.m(y,z)):K&&(K.d(1),K=null),_e[0]&512&&(D=ot(N[9])),D?Y?Y.p(N,_e):(Y=kl(N),Y.c(),Y.m(y,null)):Y&&(Y.d(1),Y=null),_e[0]&4096&&ne!==(ne=N[12]?"Testing...":"Test Connection")&&X(J,ne),_e[0]&4096&&(U.disabled=N[12]),_e[0]&16384&&se!==(se=N[14]?"Reloading...":"Reload Models")&&X(le,se),_e[0]&24576&&ve!==(ve=N[14]||!N[13]?.valid)&&(j.disabled=ve),N[13]?B?B.p(N,_e):(B=wl(N),B.c(),B.m(M,ge)):B&&(B.d(1),B=null),N[15]?fe?fe.p(N,_e):(fe=yl(N),fe.c(),fe.m(M,Ce)):fe&&(fe.d(1),fe=null),N[17]&&N[18]?ke?ke.p(N,_e):(ke=Cl(N),ke.c(),ke.m(M,Q)):ke&&(ke.d(1),ke=null),N[19]?Fe?Fe.p(N,_e):(Fe=Tl(N),Fe.c(),Fe.m(M,null)):Fe&&(Fe.d(1),Fe=null)},d(N){N&&S(e),ee&&ee.d(),ye(de,N),q&&q.d(),he&&he.d(),ye(O,N),K&&K.d(),Y&&Y.d(),B&&B.d(),fe&&fe.d(),ke&&ke.d(),Fe&&Fe.d(),oe=!1,Ae(te)}}}function Ns(l){let e,t,n,s,o,i,c,u,m,_,d,h,g,p,b,F,k,w,y,T,A,E,P,H,I,z,D,L,M,V;return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Default Dimensions",s=v(),o=f("div"),i=f("div"),c=f("label"),c.textContent="Default Width",u=v(),m=f("input"),_=v(),d=f("span"),d.textContent="√ó",h=v(),g=f("div"),p=f("label"),p.textContent="Default Height",b=v(),F=f("input"),k=v(),w=f("div"),y=f("div"),T=f("label"),T.textContent="Default Count",A=v(),E=f("input"),P=v(),H=f("div"),I=f("label"),z=f("input"),D=v(),L=f("span"),L.textContent="Auto-enhance prompts with LLM",a(n,"class","svelte-bonvfl"),a(c,"for","default-width"),a(c,"class","svelte-bonvfl"),a(m,"id","default-width"),a(m,"type","number"),a(m,"min","256"),a(m,"max","2048"),a(m,"step","64"),a(m,"class","svelte-bonvfl"),a(i,"class","input-group svelte-bonvfl"),a(d,"class","dimension-separator svelte-bonvfl"),a(p,"for","default-height"),a(p,"class","svelte-bonvfl"),a(F,"id","default-height"),a(F,"type","number"),a(F,"min","256"),a(F,"max","2048"),a(F,"step","64"),a(F,"class","svelte-bonvfl"),a(g,"class","input-group svelte-bonvfl"),a(o,"class","dimension-inputs svelte-bonvfl"),a(t,"class","setting-group svelte-bonvfl"),a(T,"for","default-count"),a(T,"class","svelte-bonvfl"),a(E,"id","default-count"),a(E,"type","number"),a(E,"min","1"),a(E,"max","10"),a(E,"class","svelte-bonvfl"),a(y,"class","input-group svelte-bonvfl"),a(w,"class","setting-group svelte-bonvfl"),a(z,"type","checkbox"),a(z,"class","svelte-bonvfl"),a(L,"class","svelte-bonvfl"),a(I,"class","checkbox-label svelte-bonvfl"),a(H,"class","setting-group svelte-bonvfl"),a(e,"class","tab-panel svelte-bonvfl"),a(e,"role","tabpanel")},m(U,ne){C(U,e,ne),r(e,t),r(t,n),r(t,s),r(t,o),r(o,i),r(i,c),r(i,u),r(i,m),we(m,l[4].generation.defaultWidth),r(o,_),r(o,d),r(o,h),r(o,g),r(g,p),r(g,b),r(g,F),we(F,l[4].generation.defaultHeight),r(e,k),r(e,w),r(w,y),r(y,T),r(y,A),r(y,E),we(E,l[4].generation.defaultCount),r(e,P),r(e,H),r(H,I),r(I,z),z.checked=l[4].generation.autoEnhance,r(I,D),r(I,L),M||(V=[Z(m,"input",l[54]),Z(F,"input",l[55]),Z(E,"input",l[56]),Z(z,"change",l[57])],M=!0)},p(U,ne){ne[0]&16&&Ke(m.value)!==U[4].generation.defaultWidth&&we(m,U[4].generation.defaultWidth),ne[0]&16&&Ke(F.value)!==U[4].generation.defaultHeight&&we(F,U[4].generation.defaultHeight),ne[0]&16&&Ke(E.value)!==U[4].generation.defaultCount&&we(E,U[4].generation.defaultCount),ne[0]&16&&(z.checked=U[4].generation.autoEnhance)},d(U){U&&S(e),M=!1,Ae(V)}}}function Vs(l){let e,t,n,s,o,i,c,u,m,_,d,h,g,p,b,F,k,w,y,T,A,E,P,H,I,z,D,L,M,V,U,ne,J=ue(l[24]),re=[];for(let le=0;le<J.length;le+=1)re[le]=Ll(ul(l,J,le));let j=ue(l[23]),se=[];for(let le=0;le<j.length;le+=1)se[le]=Ml(cl(l,j,le));return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Panel Height",s=v(),o=f("div");for(let le=0;le<re.length;le+=1)re[le].c();i=v(),c=f("div"),u=f("h3"),u.textContent="Font Size",m=v(),_=f("div");for(let le=0;le<se.length;le+=1)se[le].c();d=v(),h=f("div"),g=f("label"),p=f("input"),b=v(),F=f("span"),F.textContent="Show tips on startup",k=v(),w=f("div"),y=f("label"),T=f("input"),A=v(),E=f("span"),E.textContent="Show tutorial on startup",P=v(),H=f("div"),I=f("label"),z=f("input"),D=v(),L=f("span"),L.textContent="Show history by default",M=v(),V=f("p"),V.textContent="When disabled, only the input line and progress bar are visible. Toggle with the ‚ò∞ button.",a(n,"class","svelte-bonvfl"),a(o,"class","radio-group svelte-bonvfl"),a(t,"class","setting-group svelte-bonvfl"),a(u,"class","svelte-bonvfl"),a(_,"class","radio-group svelte-bonvfl"),a(c,"class","setting-group svelte-bonvfl"),a(p,"type","checkbox"),a(p,"class","svelte-bonvfl"),a(F,"class","svelte-bonvfl"),a(g,"class","checkbox-label svelte-bonvfl"),a(h,"class","setting-group svelte-bonvfl"),a(T,"type","checkbox"),a(T,"class","svelte-bonvfl"),a(E,"class","svelte-bonvfl"),a(y,"class","checkbox-label svelte-bonvfl"),a(w,"class","setting-group svelte-bonvfl"),a(z,"type","checkbox"),a(z,"class","svelte-bonvfl"),a(L,"class","svelte-bonvfl"),a(I,"class","checkbox-label svelte-bonvfl"),a(V,"class","setting-hint svelte-bonvfl"),a(H,"class","setting-group svelte-bonvfl"),a(e,"class","tab-panel svelte-bonvfl"),a(e,"role","tabpanel")},m(le,ve){C(le,e,ve),r(e,t),r(t,n),r(t,s),r(t,o);for(let x=0;x<re.length;x+=1)re[x]&&re[x].m(o,null);r(e,i),r(e,c),r(c,u),r(c,m),r(c,_);for(let x=0;x<se.length;x+=1)se[x]&&se[x].m(_,null);r(e,d),r(e,h),r(h,g),r(g,p),p.checked=l[4].cli.showTipsOnStart,r(g,b),r(g,F),r(e,k),r(e,w),r(w,y),r(y,T),T.checked=l[4].cli.showTutorialOnStart,r(y,A),r(y,E),r(e,P),r(e,H),r(H,I),r(I,z),z.checked=l[4].cli.showHistory,r(I,D),r(I,L),r(H,M),r(H,V),U||(ne=[Z(p,"change",l[51]),Z(T,"change",l[52]),Z(z,"change",l[53])],U=!0)},p(le,ve){if(ve[0]&16777232){J=ue(le[24]);let x;for(x=0;x<J.length;x+=1){const ge=ul(le,J,x);re[x]?re[x].p(ge,ve):(re[x]=Ll(ge),re[x].c(),re[x].m(o,null))}for(;x<re.length;x+=1)re[x].d(1);re.length=J.length}if(ve[0]&8388624){j=ue(le[23]);let x;for(x=0;x<j.length;x+=1){const ge=cl(le,j,x);se[x]?se[x].p(ge,ve):(se[x]=Ml(ge),se[x].c(),se[x].m(_,null))}for(;x<se.length;x+=1)se[x].d(1);se.length=j.length}ve[0]&16&&(p.checked=le[4].cli.showTipsOnStart),ve[0]&16&&(T.checked=le[4].cli.showTutorialOnStart),ve[0]&16&&(z.checked=le[4].cli.showHistory)},d(le){le&&S(e),ye(re,le),ye(se,le),U=!1,Ae(ne)}}}function Us(l){let e,t,n,s,o,i,c,u,m,_,d,h,g,p,b,F,k,w,y,T,A,E,P,H,I,z,D,L=ue(l[21]),M=[];for(let J=0;J<L.length;J+=1)M[J]=Hl(dl(l,L,J));let V=ue(l[22]),U=[];for(let J=0;J<V.length;J+=1)U[J]=Il(fl(l,V,J));let ne=l[4].gallery.thumbnailSize==="custom"&&Pl(l);return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Gallery Layout",s=v(),o=f("div");for(let J=0;J<M.length;J+=1)M[J].c();i=v(),c=f("div"),u=f("h3"),u.textContent="Thumbnail Size",m=v(),_=f("div");for(let J=0;J<U.length;J+=1)U[J].c();d=v(),ne&&ne.c(),h=v(),g=f("div"),p=f("label"),b=f("input"),F=v(),k=f("span"),k.textContent="Show prompt on hover",w=v(),y=f("div"),T=f("h3"),T.textContent="Sort Order",A=v(),E=f("select"),P=f("option"),P.textContent="Newest First",H=f("option"),H.textContent="Oldest First",I=f("option"),I.textContent="By Name",a(n,"class","svelte-bonvfl"),a(o,"class","layout-options svelte-bonvfl"),a(t,"class","setting-group svelte-bonvfl"),a(u,"class","svelte-bonvfl"),a(_,"class","radio-group svelte-bonvfl"),a(c,"class","setting-group svelte-bonvfl"),a(b,"type","checkbox"),a(b,"class","svelte-bonvfl"),a(k,"class","svelte-bonvfl"),a(p,"class","checkbox-label svelte-bonvfl"),a(g,"class","setting-group svelte-bonvfl"),a(T,"class","svelte-bonvfl"),P.__value="newest",we(P,P.__value),H.__value="oldest",we(H,H.__value),I.__value="name",we(I,I.__value),a(E,"class","svelte-bonvfl"),l[4].gallery.sortOrder===void 0&&xe(()=>l[48].call(E)),a(y,"class","setting-group svelte-bonvfl"),a(e,"class","tab-panel svelte-bonvfl"),a(e,"role","tabpanel")},m(J,re){C(J,e,re),r(e,t),r(t,n),r(t,s),r(t,o);for(let j=0;j<M.length;j+=1)M[j]&&M[j].m(o,null);r(e,i),r(e,c),r(c,u),r(c,m),r(c,_);for(let j=0;j<U.length;j+=1)U[j]&&U[j].m(_,null);r(c,d),ne&&ne.m(c,null),r(e,h),r(e,g),r(g,p),r(p,b),b.checked=l[4].gallery.showPromptOnHover,r(p,F),r(p,k),r(e,w),r(e,y),r(y,T),r(y,A),r(y,E),r(E,P),r(E,H),r(E,I),Qe(E,l[4].gallery.sortOrder,!0),z||(D=[Z(b,"change",l[47]),Z(E,"change",l[48])],z=!0)},p(J,re){if(re[0]&538968080){L=ue(J[21]);let j;for(j=0;j<L.length;j+=1){const se=dl(J,L,j);M[j]?M[j].p(se,re):(M[j]=Hl(se),M[j].c(),M[j].m(o,null))}for(;j<M.length;j+=1)M[j].d(1);M.length=L.length}if(re[0]&138412048){V=ue(J[22]);let j;for(j=0;j<V.length;j+=1){const se=fl(J,V,j);U[j]?U[j].p(se,re):(U[j]=Il(se),U[j].c(),U[j].m(_,null))}for(;j<U.length;j+=1)U[j].d(1);U.length=V.length}J[4].gallery.thumbnailSize==="custom"?ne?ne.p(J,re):(ne=Pl(J),ne.c(),ne.m(c,null)):ne&&(ne.d(1),ne=null),re[0]&16&&(b.checked=J[4].gallery.showPromptOnHover),re[0]&16&&Qe(E,J[4].gallery.sortOrder)},d(J){J&&S(e),ye(M,J),ye(U,J),ne&&ne.d(),z=!1,Ae(D)}}}function ml(l){let e;return{c(){e=f("div"),e.innerHTML='<span class="spinner svelte-bonvfl"></span> <span>Loading current configuration...</span>',a(e,"class","loading-config svelte-bonvfl")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function gl(l){let e,t=l[73].label+"",n;return{c(){e=f("option"),n=R(t),e.__value=l[73].value,we(e,e.__value)},m(s,o){C(s,e,o),r(e,n)},p:$,d(s){s&&S(e)}}}function hl(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Repository",n=v(),s=f("input"),a(t,"for","image-repo"),a(t,"class","svelte-bonvfl"),a(s,"id","image-repo"),a(s,"type","text"),a(s,"data-testid","image-repo-input"),a(s,"placeholder","e.g., Tongyi-MAI/Z-Image-Turbo"),a(s,"class","svelte-bonvfl"),a(e,"class","input-row svelte-bonvfl")},m(c,u){C(c,e,u),r(e,t),r(e,n),r(e,s),we(s,l[7]),o||(i=Z(s,"input",l[59]),o=!0)},p(c,u){u[0]&128&&s.value!==c[7]&&we(s,c[7])},d(c){c&&S(e),o=!1,i()}}}function _l(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Local Path",n=v(),s=f("input"),a(t,"for","image-path"),a(t,"class","svelte-bonvfl"),a(s,"id","image-path"),a(s,"type","text"),a(s,"data-testid","image-path-input"),a(s,"placeholder","/path/to/model"),a(s,"class","svelte-bonvfl"),a(e,"class","input-row svelte-bonvfl")},m(c,u){C(c,e,u),r(e,t),r(e,n),r(e,s),we(s,l[8]),o||(i=Z(s,"input",l[60]),o=!0)},p(c,u){u[0]&256&&s.value!==c[8]&&we(s,c[8])},d(c){c&&S(e),o=!1,i()}}}function vl(l){let e,t=l[73].label+"",n;return{c(){e=f("option"),n=R(t),e.__value=l[73].value,we(e,e.__value)},m(s,o){C(s,e,o),r(e,n)},p:$,d(s){s&&S(e)}}}function bl(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Repository",n=v(),s=f("input"),a(t,"for","llm-repo"),a(t,"class","svelte-bonvfl"),a(s,"id","llm-repo"),a(s,"type","text"),a(s,"data-testid","llm-repo-input"),a(s,"placeholder","e.g., unsloth/Qwen3-4B-Instruct-2507-bnb-4bit"),a(s,"class","svelte-bonvfl"),a(e,"class","input-row svelte-bonvfl")},m(c,u){C(c,e,u),r(e,t),r(e,n),r(e,s),we(s,l[10]),o||(i=Z(s,"input",l[62]),o=!0)},p(c,u){u[0]&1024&&s.value!==c[10]&&we(s,c[10])},d(c){c&&S(e),o=!1,i()}}}function kl(l){let e,t,n,s,o,i;return{c(){e=f("div"),t=f("label"),t.textContent="Local Path",n=v(),s=f("input"),a(t,"for","llm-path"),a(t,"class","svelte-bonvfl"),a(s,"id","llm-path"),a(s,"type","text"),a(s,"data-testid","llm-path-input"),a(s,"placeholder","/path/to/llm"),a(s,"class","svelte-bonvfl"),a(e,"class","input-row svelte-bonvfl")},m(c,u){C(c,e,u),r(e,t),r(e,n),r(e,s),we(s,l[11]),o||(i=Z(s,"input",l[63]),o=!0)},p(c,u){u[0]&2048&&s.value!==c[11]&&we(s,c[11])},d(c){c&&S(e),o=!1,i()}}}function wl(l){let e,t=l[13].valid?"‚úì":"‚úó",n,s,o=l[13].message+"",i;return{c(){e=f("div"),n=R(t),s=v(),i=R(o),a(e,"class","result-message svelte-bonvfl"),ie(e,"success",l[13].valid),ie(e,"error",!l[13].valid)},m(c,u){C(c,e,u),r(e,n),r(e,s),r(e,i)},p(c,u){u[0]&8192&&t!==(t=c[13].valid?"‚úì":"‚úó")&&X(n,t),u[0]&8192&&o!==(o=c[13].message+"")&&X(i,o),u[0]&8192&&ie(e,"success",c[13].valid),u[0]&8192&&ie(e,"error",!c[13].valid)},d(c){c&&S(e)}}}function yl(l){let e,t=l[15].status==="ok"?"‚úì Models reloaded!":`‚úó ${l[15].message}`,n,s,o=l[15].status==="ok"&&l[15].duration_ms&&Sl(l);return{c(){e=f("div"),n=R(t),s=v(),o&&o.c(),a(e,"class","result-message svelte-bonvfl"),ie(e,"success",l[15].status==="ok"),ie(e,"error",l[15].status!=="ok")},m(i,c){C(i,e,c),r(e,n),r(e,s),o&&o.m(e,null)},p(i,c){c[0]&32768&&t!==(t=i[15].status==="ok"?"‚úì Models reloaded!":`‚úó ${i[15].message}`)&&X(n,t),i[15].status==="ok"&&i[15].duration_ms?o?o.p(i,c):(o=Sl(i),o.c(),o.m(e,null)):o&&(o.d(1),o=null),c[0]&32768&&ie(e,"success",i[15].status==="ok"),c[0]&32768&&ie(e,"error",i[15].status!=="ok")},d(i){i&&S(e),o&&o.d()}}}function Sl(l){let e,t,n=l[15].duration_ms+"",s,o;return{c(){e=f("span"),t=R("("),s=R(n),o=R("ms)"),a(e,"class","duration svelte-bonvfl")},m(i,c){C(i,e,c),r(e,t),r(e,s),r(e,o)},p(i,c){c[0]&32768&&n!==(n=i[15].duration_ms+"")&&X(s,n)},d(i){i&&S(e)}}}function Cl(l){let e,t,n,s,o,i,c=l[18].model_name+"",u,m,_,d,h,g,p,b=l[18].progress_percent.toFixed(1)+"",F,k,w,y,T,A=l[18].speed_mbps&&Fl(l),E=l[18].eta_seconds&&El(l),P=l[18].current_file&&Al(l);return{c(){e=f("div"),t=f("div"),n=f("span"),n.textContent="‚¨áÔ∏è",s=v(),o=f("span"),i=R("Downloading "),u=R(c),m=v(),_=f("div"),d=f("div"),h=v(),g=f("div"),p=f("span"),F=R(b),k=R("%"),w=v(),A&&A.c(),y=v(),E&&E.c(),T=v(),P&&P.c(),a(n,"class","download-icon svelte-bonvfl"),a(o,"class","download-title svelte-bonvfl"),a(t,"class","download-header svelte-bonvfl"),a(d,"class","download-progress-fill svelte-bonvfl"),me(d,"width",l[18].progress_percent+"%"),a(_,"class","download-progress-bar svelte-bonvfl"),a(p,"class","download-percent svelte-bonvfl"),a(g,"class","download-stats svelte-bonvfl"),a(e,"class","download-progress-container svelte-bonvfl")},m(H,I){C(H,e,I),r(e,t),r(t,n),r(t,s),r(t,o),r(o,i),r(o,u),r(e,m),r(e,_),r(_,d),r(e,h),r(e,g),r(g,p),r(p,F),r(p,k),r(g,w),A&&A.m(g,null),r(g,y),E&&E.m(g,null),r(e,T),P&&P.m(e,null)},p(H,I){I[0]&262144&&c!==(c=H[18].model_name+"")&&X(u,c),I[0]&262144&&me(d,"width",H[18].progress_percent+"%"),I[0]&262144&&b!==(b=H[18].progress_percent.toFixed(1)+"")&&X(F,b),H[18].speed_mbps?A?A.p(H,I):(A=Fl(H),A.c(),A.m(g,y)):A&&(A.d(1),A=null),H[18].eta_seconds?E?E.p(H,I):(E=El(H),E.c(),E.m(g,null)):E&&(E.d(1),E=null),H[18].current_file?P?P.p(H,I):(P=Al(H),P.c(),P.m(e,null)):P&&(P.d(1),P=null)},d(H){H&&S(e),A&&A.d(),E&&E.d(),P&&P.d()}}}function Fl(l){let e,t=l[18].speed_mbps.toFixed(1)+"",n,s;return{c(){e=f("span"),n=R(t),s=R(" MB/s"),a(e,"class","download-speed svelte-bonvfl")},m(o,i){C(o,e,i),r(e,n),r(e,s)},p(o,i){i[0]&262144&&t!==(t=o[18].speed_mbps.toFixed(1)+"")&&X(n,t)},d(o){o&&S(e)}}}function El(l){let e,t,n=Math.ceil(l[18].eta_seconds)+"",s,o;return{c(){e=f("span"),t=R("~"),s=R(n),o=R("s remaining"),a(e,"class","download-eta svelte-bonvfl")},m(i,c){C(i,e,c),r(e,t),r(e,s),r(e,o)},p(i,c){c[0]&262144&&n!==(n=Math.ceil(i[18].eta_seconds)+"")&&X(s,n)},d(i){i&&S(e)}}}function Al(l){let e,t=l[18].current_file+"",n;return{c(){e=f("div"),n=R(t),a(e,"class","download-file svelte-bonvfl")},m(s,o){C(s,e,o),r(e,n)},p(s,o){o[0]&262144&&t!==(t=s[18].current_file+"")&&X(n,t)},d(s){s&&S(e)}}}function Tl(l){let e,t,n;return{c(){e=f("div"),t=R("‚úó Download failed: "),n=R(l[19]),a(e,"class","result-message error svelte-bonvfl")},m(s,o){C(s,e,o),r(e,t),r(e,n)},p(s,o){o[0]&524288&&X(n,s[19])},d(s){s&&S(e)}}}function Ll(l){let e,t,n,s,o,i,c,u;function m(){return l[49](l[73])}return{c(){e=f("label"),t=f("input"),s=v(),o=f("span"),o.textContent=`${l[73].label}`,i=v(),a(t,"type","radio"),a(t,"name","cliHeight"),t.value=l[73].value,t.checked=n=l[4].cli.height===l[73].value,a(t,"class","svelte-bonvfl"),a(o,"class","radio-text svelte-bonvfl"),a(e,"class","radio-label svelte-bonvfl")},m(_,d){C(_,e,d),r(e,t),r(e,s),r(e,o),r(e,i),c||(u=Z(t,"change",m),c=!0)},p(_,d){l=_,d[0]&16&&n!==(n=l[4].cli.height===l[73].value)&&(t.checked=n)},d(_){_&&S(e),c=!1,u()}}}function Ml(l){let e,t,n,s,o,i,c,u;function m(){return l[50](l[73])}return{c(){e=f("label"),t=f("input"),s=v(),o=f("span"),o.textContent=`${l[73].label}`,i=v(),a(t,"type","radio"),a(t,"name","fontSize"),t.value=l[73].value,t.checked=n=l[4].cli.fontSize===l[73].value,a(t,"class","svelte-bonvfl"),a(o,"class","radio-text svelte-bonvfl"),a(e,"class","radio-label svelte-bonvfl")},m(_,d){C(_,e,d),r(e,t),r(e,s),r(e,o),r(e,i),c||(u=Z(t,"change",m),c=!0)},p(_,d){l=_,d[0]&16&&n!==(n=l[4].cli.fontSize===l[73].value)&&(t.checked=n)},d(_){_&&S(e),c=!1,u()}}}function Hl(l){let e,t,n,s,o,i,c;function u(){return l[45](l[73])}return{c(){e=f("button"),t=f("span"),t.textContent=`${l[73].icon}`,n=v(),s=f("span"),s.textContent=`${l[73].label}`,o=v(),a(t,"class","layout-icon svelte-bonvfl"),a(s,"class","layout-label svelte-bonvfl"),a(e,"class","layout-option svelte-bonvfl"),a(e,"data-testid","layout-"+l[73].value),ie(e,"selected",l[4].gallery.layout===l[73].value)},m(m,_){C(m,e,_),r(e,t),r(e,n),r(e,s),r(e,o),i||(c=Z(e,"click",u),i=!0)},p(m,_){l=m,_[0]&2097168&&ie(e,"selected",l[4].gallery.layout===l[73].value)},d(m){m&&S(e),i=!1,c()}}}function qs(l){let e;return{c(){e=f("span"),e.textContent=`${l[70].height}px`,a(e,"class","radio-hint svelte-bonvfl")},m(t,n){C(t,e,n)},p:$,d(t){t&&S(e)}}}function Il(l){let e,t,n,s,o,i,c,u,m;function _(){return l[46](l[70])}let d=l[70].value!=="custom"&&qs(l);return{c(){e=f("label"),t=f("input"),s=v(),o=f("span"),o.textContent=`${l[70].label}`,i=v(),d&&d.c(),c=v(),a(t,"type","radio"),a(t,"name","thumbnailSize"),t.value=l[70].value,t.checked=n=l[4].gallery.thumbnailSize===l[70].value,a(t,"class","svelte-bonvfl"),a(o,"class","radio-text svelte-bonvfl"),a(e,"class","radio-label svelte-bonvfl")},m(h,g){C(h,e,g),r(e,t),r(e,s),r(e,o),r(e,i),d&&d.m(e,null),r(e,c),u||(m=Z(t,"change",_),u=!0)},p(h,g){l=h,g[0]&16&&n!==(n=l[4].gallery.thumbnailSize===l[70].value)&&(t.checked=n),l[70].value!=="custom"&&d.p(l,g)},d(h){h&&S(e),d&&d.d(),u=!1,m()}}}function Pl(l){let e,t,n,s,o,i,c,u,m=l[2]&&Gl(l);return{c(){e=f("div"),t=f("label"),t.textContent="Custom Height (px)",n=v(),s=f("input"),i=v(),m&&m.c(),a(t,"for","custom-thumbnail"),a(t,"class","svelte-bonvfl"),a(s,"id","custom-thumbnail"),a(s,"type","number"),a(s,"min","80"),a(s,"max","500"),s.value=o=l[4].gallery.thumbnailHeight,a(s,"data-testid","custom-thumbnail-input"),a(s,"class","svelte-bonvfl"),a(e,"class","custom-input-group svelte-bonvfl")},m(_,d){C(_,e,d),r(e,t),r(e,n),r(e,s),r(e,i),m&&m.m(e,null),c||(u=Z(s,"input",l[28]),c=!0)},p(_,d){d[0]&16&&o!==(o=_[4].gallery.thumbnailHeight)&&s.value!==o&&(s.value=o),_[2]?m?m.p(_,d):(m=Gl(_),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(_){_&&S(e),m&&m.d(),c=!1,u()}}}function Gl(l){let e,t;return{c(){e=f("span"),t=R(l[2]),a(e,"class","error-text svelte-bonvfl")},m(n,s){C(n,e,s),r(e,t)},p(n,s){s[0]&4&&X(t,n[2])},d(n){n&&S(e)}}}function Ws(l){let e;return{c(){e=R("Save")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function Zs(l){let e;return{c(){e=R("Downloading...")},m(t,n){C(t,e,n)},d(t){t&&S(e)}}}function Ol(l){let e,t,n,s,o,i,c,u,m,_,d,h;return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Reset Settings?",s=v(),o=f("p"),o.textContent="Are you sure you want to reset all settings to their default values? This cannot be undone.",i=v(),c=f("div"),u=f("button"),u.textContent="Cancel",m=v(),_=f("button"),_.textContent="Confirm",a(n,"class","svelte-bonvfl"),a(o,"class","svelte-bonvfl"),a(u,"class","btn btn-ghost svelte-bonvfl"),a(_,"class","btn btn-danger svelte-bonvfl"),a(c,"class","confirm-actions svelte-bonvfl"),a(t,"class","confirm-dialog svelte-bonvfl"),a(e,"class","confirm-overlay svelte-bonvfl")},m(g,p){C(g,e,p),r(e,t),r(t,n),r(t,s),r(t,o),r(t,i),r(t,c),r(c,u),r(c,m),r(c,_),d||(h=[Z(u,"click",l[34]),Z(_,"click",l[33])],d=!0)},p:$,d(g){g&&S(e),d=!1,Ae(h)}}}function Js(l){let e,t=l[0]&&pl(l);return{c(){t&&t.c(),e=at()},m(n,s){t&&t.m(n,s),C(n,e,s)},p(n,s){n[0]?t?t.p(n,s):(t=pl(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(n){n&&S(e),t&&t.d(n)}}}function st(l){return l==="hf_download"||l==="sdnq"}function ot(l){return l==="hf_local"||l==="components"||l==="gguf"}function Qs(l,e,t){let n,s;De(l,je,W=>t(39,s=W));let{open:o=!1}=e,{onClose:i}=e,c="gallery",u=structuredClone(qe),m="",_=!1;const d=[{value:"flex-row",label:"Flex Row",icon:"‚ïê"},{value:"masonry-vertical",label:"Masonry Vertical",icon:"‚ñì"},{value:"masonry-horizontal",label:"Masonry Horizontal",icon:"‚ñí"},{value:"grid-square",label:"Grid Square",icon:"‚ñ¶"},{value:"grid-auto",label:"Grid Auto",icon:"‚ñ§"}],h=[{value:"small",label:"Small",height:120},{value:"medium",label:"Medium",height:180},{value:"large",label:"Large",height:250},{value:"xlarge",label:"X-Large",height:350},{value:"custom",label:"Custom",height:0}],g=[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}],p=[{value:250,label:"Compact (250px)"},{value:350,label:"Small (350px)"},{value:420,label:"Medium (420px)"},{value:500,label:"Large (500px)"},{value:600,label:"Maximum (600px)"}],b=[{value:"hf_download",label:"HuggingFace Download"},{value:"hf_local",label:"Local HF Clone"},{value:"sdnq",label:"SDNQ Quantized"},{value:"components",label:"Components"}],F=[{value:"hf_download",label:"HuggingFace Download"},{value:"hf_local",label:"Local HF Clone"},{value:"gguf",label:"GGUF File"},{value:"z_image",label:"Z-Image Encoder"}];let k="hf_download",w="",y="",T="hf_download",A="",E="",P=!1,H=null,I=!1,z=null,D=!1,L=!1,M=null,V=null;async function U(){t(16,D=!0);try{const W=await fetch("/api/config");if(W.ok){const pe=await W.json();t(6,k=pe.image_mode||"hf_download"),t(9,T=pe.llm_mode||"hf_download"),pe.image_mode==="hf_download"||pe.image_mode==="sdnq"?(t(7,w=pe.image_model||""),t(8,y="")):(t(8,y=pe.image_model||""),t(7,w="")),pe.llm_mode==="hf_download"?(t(10,A=pe.llm_model||""),t(11,E="")):pe.llm_mode==="z_image"?(t(10,A=""),t(11,E="")):(t(11,E=pe.llm_model||""),t(10,A=""))}}catch(W){console.warn("Could not fetch server config:",W)}finally{t(16,D=!1)}}async function ne(){try{const W=await fetch("/api/settings/models/check-cache",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_mode:k,image_repo:w||null,llm_mode:T,llm_repo:A||null})});if(W.ok){const pe=await W.json();if(pe.needs_download)return{image_repo:pe.image_cached?void 0:pe.image_repo,llm_repo:pe.llm_cached?void 0:pe.llm_repo}}}catch(W){console.warn("Could not check model cache:",W)}return null}async function J(W){return t(17,L=!0),t(18,M=null),t(19,V=null),new Promise(pe=>{const Oe=new URLSearchParams;W.image_repo&&Oe.set("image_repo",W.image_repo),W.llm_repo&&Oe.set("llm_repo",W.llm_repo);const Le=new EventSource(`/api/settings/models/download?${Oe}`);Le.onmessage=un=>{try{const Te=JSON.parse(un.data);if(Te.status==="all_complete"){Le.close(),t(17,L=!1),t(18,M=null),pe(!0);return}if(Te.status==="error"&&Te.success===!1){Le.close(),t(17,L=!1),t(19,V=Te.message||"Download failed"),pe(!1);return}t(18,M={model_name:Te.model_name||"",status:Te.status||"",progress_percent:Te.progress_percent||0,current_file:Te.current_file,speed_mbps:Te.speed_mbps,eta_seconds:Te.eta_seconds,error:Te.error}),Te.error&&t(19,V=Te.error)}catch(Te){console.error("Error parsing download progress:",Te)}},Le.onerror=()=>{Le.close(),t(17,L=!1),t(19,V="Connection to server lost"),pe(!1)}})}function re(W){Xl(W)?t(2,m=""):t(2,m="Must be between 80 and 500 pixels")}function j(W){const pe=h.find(Le=>Le.value===W),Oe=W!=="custom"&&pe?pe.height:u.gallery.thumbnailHeight;W!=="custom"&&t(2,m=""),t(4,u={...u,gallery:{...u.gallery,thumbnailSize:W,thumbnailHeight:Oe}})}function se(W){const pe=W.target,Oe=parseInt(pe.value,10);re(Oe),t(4,u={...u,gallery:{...u.gallery,thumbnailHeight:Oe}})}function le(W){t(4,u={...u,gallery:{...u.gallery,layout:W}})}async function ve(){if(!(n||L)){if(c==="models"){const W=await ne();if(W&&(W.image_repo||W.llm_repo)){if(!await J(W))return;await x()}}Tn(u.gallery),$l(u.cli),Ln(u.generation),i()}}async function x(){try{await fetch("/api/settings/models",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_mode:k,image_repo:w||null,image_path:y||null,llm_mode:T,llm_repo:A||null,llm_path:E||null})}),await fetch("/api/models/reload",{method:"POST"}),t(4,u.models={imageMode:k,imageRepo:w,imagePath:y,llmMode:T,llmRepo:A,llmPath:E},u)}catch(W){console.error("Failed to apply model config:",W)}}function ge(){i()}function Ce(){t(5,_=!0)}function be(){Mn(),t(4,u=structuredClone(qe)),t(5,_=!1),t(2,m="")}function G(){t(5,_=!1)}function Q(W){W.key==="Escape"&&(_?G():i())}function oe(W){W.target===W.currentTarget&&i()}async function te(){t(12,P=!0),t(13,H=null),t(15,z=null);try{const pe=await(await fetch("/api/settings/models/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_type:"image",mode:k,repo:w||null,path:y||null})})).json();if(!pe.valid){t(13,H={valid:!1,message:`Image: ${pe.message}`});return}const Le=await(await fetch("/api/settings/models/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_type:"llm",mode:T,repo:A||null,path:E||null})})).json();if(!Le.valid){t(13,H={valid:!1,message:`LLM: ${Le.message}`});return}t(13,H={valid:!0,message:"Configuration valid!"})}catch(W){t(13,H={valid:!1,message:`Connection error: ${W}`})}finally{t(12,P=!1)}}async function ee(){t(14,I=!0),t(15,z=null);try{const pe=await(await fetch("/api/settings/models",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_mode:k,image_repo:w||null,image_path:y||null,llm_mode:T,llm_repo:A||null,llm_path:E||null})})).json();if(pe.status!=="ok"){t(15,z={status:"error",message:pe.message});return}const Le=await(await fetch("/api/models/reload",{method:"POST",headers:{"Content-Type":"application/json"}})).json();t(15,z=Le),Le.status==="ok"&&t(4,u.models={imageMode:k,imageRepo:w,imagePath:y,llmMode:T,llmRepo:A,llmPath:E},u)}catch(W){t(15,z={status:"error",message:`Error: ${W}`})}finally{t(14,I=!1)}}function ae(W){Zl.call(this,l,W)}const de=()=>t(3,c="gallery"),q=()=>t(3,c="cli"),he=()=>t(3,c="generation"),Me=()=>t(3,c="models"),O=W=>le(W.value),K=W=>j(W.value);function Y(){u.gallery.showPromptOnHover=this.checked,t(4,u),t(0,o),t(39,s)}function B(){u.gallery.sortOrder=ct(this),t(4,u),t(0,o),t(39,s)}const fe=W=>{t(4,u.cli.height=W.value,u)},ke=W=>{t(4,u.cli.fontSize=W.value,u)};function Fe(){u.cli.showTipsOnStart=this.checked,t(4,u),t(0,o),t(39,s)}function N(){u.cli.showTutorialOnStart=this.checked,t(4,u),t(0,o),t(39,s)}function _e(){u.cli.showHistory=this.checked,t(4,u),t(0,o),t(39,s)}function ce(){u.generation.defaultWidth=Ke(this.value),t(4,u),t(0,o),t(39,s)}function Ve(){u.generation.defaultHeight=Ke(this.value),t(4,u),t(0,o),t(39,s)}function tn(){u.generation.defaultCount=Ke(this.value),t(4,u),t(0,o),t(39,s)}function ln(){u.generation.autoEnhance=this.checked,t(4,u),t(0,o),t(39,s)}function nn(){k=ct(this),t(6,k),t(25,b)}function sn(){w=this.value,t(7,w)}function on(){y=this.value,t(8,y)}function rn(){T=ct(this),t(9,T),t(26,F)}function an(){A=this.value,t(10,A)}function cn(){E=this.value,t(11,E)}return l.$$set=W=>{"open"in W&&t(0,o=W.open),"onClose"in W&&t(1,i=W.onClose)},l.$$.update=()=>{l.$$.dirty[0]&1|l.$$.dirty[1]&256&&o&&(t(4,u=structuredClone(s)),t(3,c="gallery"),t(2,m=""),t(5,_=!1),t(13,H=null),t(15,z=null),t(17,L=!1),t(18,M=null),t(19,V=null),U()),l.$$.dirty[0]&4&&t(20,n=m!=="")},[o,i,m,c,u,_,k,w,y,T,A,E,P,H,I,z,D,L,M,V,n,d,h,g,p,b,F,j,se,le,ve,ge,Ce,be,G,Q,oe,te,ee,s,ae,de,q,he,Me,O,K,Y,B,fe,ke,Fe,N,_e,ce,Ve,tn,ln,nn,sn,on,rn,an,cn]}class Ks extends Be{constructor(e){super(),ze(this,e,Qs,Js,Ge,{open:0,onClose:1},null,[-1,-1,-1])}}function Ys(l){let e,t,n,s,o,i,c,u,m,_,d,h,g,p=l[8]&&Rl(l);s=new fs({props:{images:l[2],isGenerating:l[3],progress:l[4],onOpenSettings:l[15]}}),s.$on("select",l[24]);let b=l[5]&&Dl(l),F=l[13]&&Nl(l),k={isGenerating:l[3],isTauriAvailable:l[6]||l[7],getGpuInfo:l[21],unloadModels:l[22],listVariables:l[23],openSettings:l[15]};return m=new Es({props:k}),l[29](m),m.$on("generate",l[20]),m.$on("historyToggle",l[17]),h=new Ks({props:{open:l[11],onClose:l[16]}}),{c(){e=f("main"),p&&p.c(),t=v(),n=f("div"),Re(s.$$.fragment),o=v(),b&&b.c(),i=v(),F&&F.c(),c=v(),u=f("div"),Re(m.$$.fragment),d=v(),Re(h.$$.fragment),a(n,"class","gallery-container svelte-ab38a"),a(u,"class","cli-container svelte-ab38a"),a(u,"style",_=l[13]?`height: ${l[0]}px`:""),ie(u,"collapsed",!l[13]),a(e,"class","app svelte-ab38a"),ie(e,"resizing",l[1])},m(w,y){C(w,e,y),p&&p.m(e,null),r(e,t),r(e,n),Ie(s,n,null),r(n,o),b&&b.m(n,null),r(e,i),F&&F.m(e,null),r(e,c),r(e,u),Ie(m,u,null),r(e,d),Ie(h,e,null),g=!0},p(w,y){w[8]?p?p.p(w,y):(p=Rl(w),p.c(),p.m(e,t)):p&&(p.d(1),p=null);const T={};y[0]&4&&(T.images=w[2]),y[0]&8&&(T.isGenerating=w[3]),y[0]&16&&(T.progress=w[4]),s.$set(T),w[5]?b?b.p(w,y):(b=Dl(w),b.c(),b.m(n,null)):b&&(b.d(1),b=null),w[13]?F?F.p(w,y):(F=Nl(w),F.c(),F.m(e,c)):F&&(F.d(1),F=null);const A={};y[0]&8&&(A.isGenerating=w[3]),y[0]&192&&(A.isTauriAvailable=w[6]||w[7]),m.$set(A),(!g||y[0]&8193&&_!==(_=w[13]?`height: ${w[0]}px`:""))&&a(u,"style",_),(!g||y[0]&8192)&&ie(u,"collapsed",!w[13]);const E={};y[0]&2048&&(E.open=w[11]),h.$set(E),(!g||y[0]&2)&&ie(e,"resizing",w[1])},i(w){g||(Se(s.$$.fragment,w),Se(m.$$.fragment,w),Se(h.$$.fragment,w),g=!0)},o(w){Ee(s.$$.fragment,w),Ee(m.$$.fragment,w),Ee(h.$$.fragment,w),g=!1},d(w){w&&S(e),p&&p.d(),Pe(s),b&&b.d(),F&&F.d(),l[29](null),Pe(m),Pe(h)}}}function Xs(l){let e,t;return e=new Bs({props:{apiBase:l[14]}}),e.$on("complete",l[18]),{c(){Re(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p:$,i(n){t||(Se(e.$$.fragment,n),t=!0)},o(n){Ee(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function xs(l){let e;return{c(){e=f("div"),e.innerHTML='<div class="loading-spinner svelte-ab38a"></div> <p class="svelte-ab38a">Connecting to server...</p>',a(e,"class","loading-screen svelte-ab38a")},m(t,n){C(t,e,n)},p:$,i:$,o:$,d(t){t&&S(e)}}}function Rl(l){let e,t;return{c(){e=f("div"),t=R(l[8]),a(e,"class","status-bar svelte-ab38a")},m(n,s){C(n,e,s),r(e,t)},p(n,s){s[0]&256&&X(t,n[8])},d(n){n&&S(e)}}}function Dl(l){let e,t,n,s,o,i,c,u,m,_,d=l[3]&&zl(l),h=l[5].prompt&&jl(l);return{c(){e=f("div"),d&&d.c(),t=v(),n=f("div"),s=f("img"),i=v(),h&&h.c(),c=v(),u=f("button"),u.textContent="√ó",He(s.src,o=l[5].url)||a(s,"src",o),a(s,"alt","Preview"),a(s,"class","preview-image svelte-ab38a"),a(n,"class","preview-content svelte-ab38a"),a(u,"class","close-btn svelte-ab38a"),a(e,"class","preview-overlay svelte-ab38a"),a(e,"role","dialog"),a(e,"aria-modal","true")},m(g,p){C(g,e,p),d&&d.m(e,null),r(e,t),r(e,n),r(n,s),r(n,i),h&&h.m(n,null),r(e,c),r(e,u),m||(_=[Z(n,"click",ql(l[27])),Z(u,"click",l[25]),Z(e,"click",l[25]),Z(e,"keydown",l[28])],m=!0)},p(g,p){g[3]?d?d.p(g,p):(d=zl(g),d.c(),d.m(e,t)):d&&(d.d(1),d=null),p[0]&32&&!He(s.src,o=g[5].url)&&a(s,"src",o),g[5].prompt?h?h.p(g,p):(h=jl(g),h.c(),h.m(n,null)):h&&(h.d(1),h=null)},d(g){g&&S(e),d&&d.d(),h&&h.d(),m=!1,Ae(_)}}}function zl(l){let e,t,n,s,o,i=l[4]>0&&Bl(l);return{c(){e=f("div"),t=f("span"),n=v(),s=f("span"),s.textContent="Generating...",o=v(),i&&i.c(),a(t,"class","pulse svelte-ab38a"),a(e,"class","preview-generating svelte-ab38a")},m(c,u){C(c,e,u),r(e,t),r(e,n),r(e,s),r(e,o),i&&i.m(e,null)},p(c,u){c[4]>0?i?i.p(c,u):(i=Bl(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(c){c&&S(e),i&&i.d()}}}function Bl(l){let e,t;return{c(){e=f("div"),t=f("div"),a(t,"class","preview-progress-fill svelte-ab38a"),me(t,"width",l[4]+"%"),a(e,"class","preview-progress svelte-ab38a")},m(n,s){C(n,e,s),r(e,t)},p(n,s){s[0]&16&&me(t,"width",n[4]+"%")},d(n){n&&S(e)}}}function jl(l){let e,t,n,s,o=l[5].prompt+"",i;return{c(){e=f("div"),t=f("span"),t.textContent="üìú Prompt",n=v(),s=f("p"),i=R(o),a(t,"class","prompt-label svelte-ab38a"),a(s,"class","prompt-text svelte-ab38a"),a(e,"class","preview-prompt svelte-ab38a")},m(c,u){C(c,e,u),r(e,t),r(e,n),r(e,s),r(s,i)},p(c,u){u[0]&32&&o!==(o=c[5].prompt+"")&&X(i,o)},d(c){c&&S(e)}}}function Nl(l){let e,t,n;return{c(){e=f("div"),e.innerHTML='<div class="handle-line svelte-ab38a"></div>',a(e,"class","resize-handle svelte-ab38a")},m(s,o){C(s,e,o),t||(n=Z(e,"mousedown",l[19]),t=!0)},p:$,d(s){s&&S(e),t=!1,n()}}}function $s(l){let e,t,n,s;const o=[xs,Xs,Ys],i=[];function c(u,m){return u[10]?0:u[9]&&u[7]?1:2}return e=c(l),t=i[e]=o[e](l),{c(){t.c(),n=at()},m(u,m){i[e].m(u,m),C(u,n,m),s=!0},p(u,m){let _=e;e=c(u),e===_?i[e].p(u,m):(gt(),Ee(i[_],1,1,()=>{i[_]=null}),ht(),t=i[e],t?t.p(u,m):(t=i[e]=o[e](u),t.c()),Se(t,1),t.m(n.parentNode,n))},i(u){s||(Se(t),s=!0)},o(u){Ee(t),s=!1},d(u){u&&S(n),i[e].d(u)}}}let eo=150,to=600;function lo(){if(typeof window<"u"){const{protocol:l,hostname:e,port:t}=window.location;return t==="5173"?"":`${l}//${e}${t?":"+t:""}`}return"http://127.0.0.1:8345"}function no(l,e,t){let n;De(l,je,G=>t(26,n=G));const s=lo();let o=[],i=!1,c=0,u=null,m=!1,_=!1,d="",h=!1,g=!0,p=!1;function b(){t(11,p=!0)}function F(){t(11,p=!1)}let k=null,w,y=null,T=n.cli.height,A=!1,E=n.cli.showHistory;function P(G){t(13,E=G.detail.visible)}async function H(){try{const{invoke:G}=await Ne(async()=>{const{invoke:te}=await import("./core-CKq3Z5BB.js");return{invoke:te}},[]),Q=await Ne(()=>import("./core-CKq3Z5BB.js"),[]),{listen:oe}=await Ne(async()=>{const{listen:te}=await import("./event-DUeWsK_d.js");return{listen:te}},__vite__mapDeps([0,1]));return k=Q.convertFileSrc,await G("list_images"),t(6,m=!0),oe("generation-progress",te=>{const{message:ee,progress:ae,stage:de}=te.payload;if(ae!==null&&t(4,c=ae),w){const q=de==="error";w.addResult(ee,q)}if(de==="image_ready"&&ee.includes("Saved: ")){const q=ee.replace("üíæ Saved: ",""),he=U(q);t(5,u={url:he})}}),!0}catch{return t(6,m=!1),!1}}async function I(){try{return(await fetch(`${s}/api/health`,{signal:AbortSignal.timeout(2e3)})).ok}catch{return!1}}async function z(){try{const G=await fetch(`${s}/api/setup/status`);if(G.ok){const Q=await G.json();if(!Q.is_configured)return!0;const oe=Q.models_needed||[],te=Q.models_downloaded||{};return oe.some(ee=>!te[ee.name])}}catch(G){console.log("Could not check setup status:",G)}return!1}function D(){t(9,h=!1),x()}function L(G){t(1,A=!0),document.addEventListener("mousemove",M),document.addEventListener("mouseup",V),G.preventDefault()}function M(G){if(!A)return;const Q=document.querySelector(".app");if(!Q)return;const te=Q.getBoundingClientRect().bottom-G.clientY;t(0,T=Math.max(eo,Math.min(to,te)))}function V(){t(1,A=!1),document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",V),$l({height:T})}function U(G){if(!G)return console.warn("üîÑ [toDisplayUrl] Empty path received"),"";if(typeof k=="function"&&!G.startsWith("http"))try{return k(G)}catch(Q){console.warn("üîÑ [toDisplayUrl] Tauri convertFileSrc failed:",Q)}if(G.startsWith("http"))return G;if(G.startsWith("/output/"))return`${s}${G}`;if(G.includes("output")){const Q=G.split(/[/\\]/).pop();return`${s}/output/${Q}`}return G}async function ne(G,Q,oe){t(3,i=!0),t(4,c=0),w&&w.startGeneration();const te=new URLSearchParams({prompt:G,count:String(Q.count||1),width:String(Q.width||1024),height:String(Q.height||1024)});oe!==null&&te.set("seed",String(oe)),console.log("üé¨ [GENERATE] Starting generation..."),console.log("üìù [GENERATE] Prompt:",G),console.log("‚öôÔ∏è [GENERATE] Params:",Q),console.log("üé≤ [GENERATE] Seed:",oe);try{const ee=`${s}/api/generate/stream?${te}`;console.log("üîó [SSE] Connecting to:",ee),y=new EventSource(ee);let ae=0;y.onopen=()=>{console.log("‚úÖ [SSE] Connection opened")},y.onerror=de=>{console.error("‚ùå [SSE] Connection error:",de)},y.onmessage=de=>{ae++,console.log(`üì® [SSE] Event #${ae}:`,de.data);try{const q=JSON.parse(de.data);if(console.log("üì¶ [SSE] Parsed event:",{stage:q.stage,message:q.message,progress:q.progress,path:q.path,final_prompts:q.final_prompts}),q.progress!==void 0&&q.progress!==null&&(console.log(`üìä [PROGRESS] Updating to ${q.progress}%`),t(4,c=q.progress)),w&&q.stage&&q.stage!=="complete"&&q.stage!=="error"&&(console.log(`üîÑ [CLI] Updating progress: ${q.stage} (${q.progress}%)`),w.updateProgress(q.progress||0,q.stage,q.message||"")),q.stage==="image_saved"&&q.path)try{console.log("üñºÔ∏è [IMAGE] Raw path from event:",q.path);const he=U(q.path);console.log("üñºÔ∏è [IMAGE] Converted URL:",he);const Me=q.data?.prompt||void 0,O={url:he,prompt:Me};t(2,o=[O,...o]),console.log("üñºÔ∏è [IMAGE] Added to gallery, setting preview..."),t(5,u=O),console.log("üñºÔ∏è [IMAGE] Preview set to:",u)}catch(he){console.error("‚ùå [IMAGE] Error handling image_saved:",he)}if(q.stage==="substituting"&&console.log(`üîÄ [SUBSTITUTE] ${q.message}`),q.stage==="complete"){if(console.log("‚úÖ [COMPLETE] Generation finished!"),console.log("üìù [COMPLETE] Final prompts:",q.final_prompts),console.log("üñºÔ∏è [COMPLETE] Images:",q.images),t(3,i=!1),t(4,c=0),w&&(w.completeGeneration(!0),w.addResult(`‚úÖ ${q.message||"Generation complete!"}`),q.final_prompts&&q.final_prompts.length>0)){const he=q.final_prompts[0];he!==G&&w.addResult(`üìù Final prompt: ${he}`)}y?.close(),x()}q.stage==="error"&&(console.error("‚ùå [ERROR]",q.message),t(3,i=!1),t(4,c=0),w&&(w.completeGeneration(!1),w.addResult(q.message||"Generation failed",!0)),y?.close())}catch(q){console.error("‚ùå [SSE] Failed to parse event:",q,"Raw:",de.data)}},y.onerror=de=>{console.error("SSE error:",de),t(3,i=!1),t(4,c=0),w&&w.addResult("‚ùå Connection to server lost",!0),y?.close()}}catch(ee){console.error("Generation failed:",ee),t(8,d=`‚ùå Generation failed: ${ee}`),t(3,i=!1),t(4,c=0)}}async function J(G){const{prompt:Q,params:oe,seed:te}=G.detail;if(t(8,d=""),m){t(3,i=!0),t(4,c=0);try{const{invoke:ee}=await Ne(async()=>{const{invoke:de}=await import("./core-CKq3Z5BB.js");return{invoke:de}},[]),ae=await ee("generate_image",{prompt:Q,count:oe.count||1,width:oe.width||1024,height:oe.height||1024,seed:te||null});if(Array.isArray(ae)){const de=ae.map(q=>({url:U(q)}));t(2,o=[...de,...o])}}catch(ee){console.error("Generation failed:",ee),t(8,d=`‚ùå Generation failed: ${ee}`)}finally{t(3,i=!1),t(4,c=0)}}else _?await ne(Q,oe,te):(t(8,d="‚ö†Ô∏è No backend connected. Start with: z-explorer"),w&&w.addResult("‚ö†Ô∏è Server not running. Start with: z-explorer",!0))}async function re(){if(m)try{const{invoke:G}=await Ne(async()=>{const{invoke:Q}=await import("./core-CKq3Z5BB.js");return{invoke:Q}},[]);return await G("get_gpu_info")}catch(G){return console.error("Failed to get GPU info:",G),null}else if(_)try{const G=await fetch(`${s}/api/gpu`);if(G.ok)return await G.json()}catch(G){console.error("Failed to get GPU info:",G)}return null}async function j(){if(m)try{const{invoke:G}=await Ne(async()=>{const{invoke:Q}=await import("./core-CKq3Z5BB.js");return{invoke:Q}},[]);return await G("unload_models")}catch(G){return console.error("Failed to unload models:",G),null}else if(_)try{const G=await fetch(`${s}/api/unload`,{method:"POST"});if(G.ok)return await G.json()}catch(G){console.error("Failed to unload models:",G)}return null}async function se(){if(console.log("üìö [App] handleListVariables called, tauri:",m),m)try{const{invoke:G}=await Ne(async()=>{const{invoke:Q}=await import("./core-CKq3Z5BB.js");return{invoke:Q}},[]);return await G("list_variables")}catch(G){return console.error("Failed to list variables:",G),null}try{console.log("üìö [App] Fetching variables from:",`${s}/api/variables`);const G=await fetch(`${s}/api/variables`);if(G.ok){const Q=await G.json();return console.log("üìö [App] Variables loaded:",Q),Q}else console.warn("üìö [App] Variables fetch failed:",G.status)}catch(G){console.warn("üìö [App] Variables fetch error (server might not be running):",G)}return null}function le(G){console.log("üñºÔ∏è [handleImageSelect] Event detail:",G.detail),console.log("üñºÔ∏è [handleImageSelect] Prompt:",G.detail?.prompt),t(5,u=G.detail)}function ve(){t(5,u=null)}async function x(){try{const G=await fetch(`${s}/api/images`);if(G.ok){const Q=await G.json();Q.images&&t(2,o=Q.images.map(oe=>{let te;return oe.url?te=oe.url.startsWith("http")?oe.url:`${s}${oe.url}`:te=`${s}/output/${oe.name}`,{url:te,prompt:oe.prompt||void 0}}))}}catch(G){console.log("Could not load images:",G)}}pt(async()=>{if(xl(),await H()){t(8,d="üñ•Ô∏è Running in native Tauri mode"),t(10,g=!1);try{const{invoke:Q}=await Ne(async()=>{const{invoke:te}=await import("./core-CKq3Z5BB.js");return{invoke:te}},[]),oe=await Q("list_images");t(2,o=oe.map(te=>({url:U(te)})))}catch(Q){console.log("Failed to load images:",Q)}}else if(t(7,_=await I()),_){if(t(9,h=await z()),t(10,g=!1),!h){const Q=s||window.location.origin;t(8,d=`‚úÖ Connected to Z-Explorer server (${Q})`),await x(),w&&await w.fetchVersion(s)}}else t(10,g=!1),t(8,d="üé® Offline mode - Start server with: z-explorer")}),Wl(()=>{y?.close()});function ge(G){Zl.call(this,l,G)}const Ce=G=>G.key==="Escape"&&ve();function be(G){tt[G?"unshift":"push"](()=>{w=G,t(12,w)})}return l.$$.update=()=>{l.$$.dirty[0]&67108867&&!A&&n.cli.height!==T&&t(0,T=n.cli.height)},[T,A,o,i,c,u,m,_,d,h,g,p,w,E,s,b,F,P,D,L,J,re,j,se,le,ve,n,ge,Ce,be]}class so extends Be{constructor(e){super(),ze(this,e,no,$s,Ge,{},null,[-1,-1])}}new so({target:document.getElementById("app")});
